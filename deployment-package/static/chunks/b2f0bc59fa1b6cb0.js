(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39184,(e,t,n)=>{"use strict";var r=e.r(7788),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useState,i=r.useEffect,l=r.useLayoutEffect,s=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),a=r[0].inst,u=r[1];return l(function(){a.value=n,a.getSnapshot=t,c(a)&&u({inst:a})},[e,n,t]),i(function(){return c(a)&&u({inst:a}),e(function(){c(a)&&u({inst:a})})},[e]),s(n),n};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},31052,(e,t,n)=>{"use strict";t.exports=e.r(39184)},54005,(e,t,n)=>{"use strict";var r=e.r(7788),a=e.r(31052),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useSyncExternalStore,l=r.useRef,s=r.useEffect,c=r.useMemo,u=r.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var d=l(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;var f=i(e,(d=c(function(){function e(e){if(!s){if(s=!0,i=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return l=t}return l=e}if(t=l,o(i,e))return t;var n=r(e);return void 0!==a&&a(t,n)?(i=e,t):(i=e,l=n)}var i,l,s=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,a]))[0],d[1]);return s(function(){h.hasValue=!0,h.value=f},[f]),u(f),f}},38577,(e,t,n)=>{"use strict";t.exports=e.r(54005)},25532,e=>{"use strict";e.s(["default",()=>o3],25532);var t,n,r,a,o,i,l,s,c=e.i(47901),u=e.i(7788),d=e.i(63491);function h(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)""!==(r=h(e[n]))&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}e.i(54827);var f=e.i(38577);let m={get url(){return`file://${e.P("botchat-pro/node_modules/zustand/esm/vanilla.mjs")}`}},g=e=>{let t,n=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,o={setState:r,getState:a,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{(m.env?m.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,o);return o},{useDebugValue:p}=u.default,{useSyncExternalStoreWithSelector:y}=f.default,x=e=>e;function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x,n=arguments.length>2?arguments[2]:void 0,r=y(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return p(r),r}let b=(e,t)=>{let n=(e=>e?g(e):g)(e),r=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return v(n,e,r)};return Object.assign(r,n),r};function w(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var N={value:()=>{}};function S(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw Error("illegal type: "+e);r[e]=[]}return new E(r)}function E(e){this._=e}function _(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=N,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}function j(){}function k(e){return null==e?j:function(){return this.querySelector(e)}}function M(){return[]}function C(e){return null==e?M:function(){return this.querySelectorAll(e)}}function A(e){return function(){return this.matches(e)}}function z(e){return function(t){return t.matches(e)}}E.prototype=S.prototype={constructor:E,on:function(e,t){var n,r=this._,a=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:t}}),o=-1,i=a.length;if(arguments.length<2){for(;++o<i;)if((n=(e=a[o]).type)&&(n=function(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}(r[n],e.name)))return n;return}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++o<i;)if(n=(e=a[o]).type)r[n]=_(r[n],e.name,t);else if(null==t)for(n in r)r[n]=_(r[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new E(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=Array(n),o=0;o<n;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(r=this._[e],o=0,n=r.length;o<n;++o)r[o].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var r=this._[e],a=0,o=r.length;a<o;++a)r[a].value.apply(t,n)}};var B=Array.prototype.find;function I(){return this.firstElementChild}var R=Array.prototype.filter;function P(){return Array.from(this.children)}function T(e){return Array(e.length)}function D(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function O(e,t,n,r,a,o){for(var i,l=0,s=t.length,c=o.length;l<c;++l)(i=t[l])?(i.__data__=o[l],r[l]=i):n[l]=new D(e,o[l]);for(;l<s;++l)(i=t[l])&&(a[l]=i)}function L(e,t,n,r,a,o,i){var l,s,c,u=new Map,d=t.length,h=o.length,f=Array(d);for(l=0;l<d;++l)(s=t[l])&&(f[l]=c=i.call(s,s.__data__,l,t)+"",u.has(c)?a[l]=s:u.set(c,s));for(l=0;l<h;++l)c=i.call(e,o[l],l,o)+"",(s=u.get(c))?(r[l]=s,s.__data__=o[l],u.delete(c)):n[l]=new D(e,o[l]);for(l=0;l<d;++l)(s=t[l])&&u.get(f[l])===s&&(a[l]=s)}function V(e){return e.__data__}function H(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}D.prototype={constructor:D,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var F="http://www.w3.org/1999/xhtml";let q={svg:"http://www.w3.org/2000/svg",xhtml:F,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function X(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),q.hasOwnProperty(t)?{space:q[t],local:e}:e}function K(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function W(e,t){return e.style.getPropertyValue(t)||K(e).getComputedStyle(e,null).getPropertyValue(t)}function Y(e){return e.trim().split(/^|\s+/)}function Z(e){return e.classList||new U(e)}function U(e){this._node=e,this._names=Y(e.getAttribute("class")||"")}function G(e,t){for(var n=Z(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function $(e,t){for(var n=Z(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Q(){this.textContent=""}function J(){this.innerHTML=""}function ee(){this.nextSibling&&this.parentNode.appendChild(this)}function et(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function en(e){var t=X(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===F&&t.documentElement.namespaceURI===F?t.createElement(e):t.createElementNS(n,e)}})(t)}function er(){return null}function ea(){var e=this.parentNode;e&&e.removeChild(this)}function eo(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ei(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function el(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,o=t.length;r<o;++r)(n=t[r],e.type&&n.type!==e.type||n.name!==e.name)?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function es(e,t,n){return function(){var r,a=this.__on,o=function(e){t.call(this,e,this.__data__)};if(a){for(var i=0,l=a.length;i<l;++i)if((r=a[i]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=t;return}}this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},a?a.push(r):this.__on=[r]}}function ec(e,t,n){var r=K(e),a=r.CustomEvent;"function"==typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}U.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var eu=[null];function ed(e,t){this._groups=e,this._parents=t}function eh(){return new ed([[document.documentElement]],eu)}function ef(e){return"string"==typeof e?new ed([[document.querySelector(e)]],[document.documentElement]):new ed([[e]],eu)}ed.prototype=eh.prototype={constructor:ed,select:function(e){"function"!=typeof e&&(e=k(e));for(var t=this._groups,n=t.length,r=Array(n),a=0;a<n;++a)for(var o,i,l=t[a],s=l.length,c=r[a]=Array(s),u=0;u<s;++u)(o=l[u])&&(i=e.call(o,o.__data__,u,l))&&("__data__"in o&&(i.__data__=o.__data__),c[u]=i);return new ed(r,this._parents)},selectAll:function(e){if("function"==typeof e){var t;t=e,e=function(){var e;return e=t.apply(this,arguments),null==e?[]:Array.isArray(e)?e:Array.from(e)}}else e=C(e);for(var n=this._groups,r=n.length,a=[],o=[],i=0;i<r;++i)for(var l,s=n[i],c=s.length,u=0;u<c;++u)(l=s[u])&&(a.push(e.call(l,l.__data__,u,s)),o.push(l));return new ed(a,o)},selectChild:function(e){var t;return this.select(null==e?I:(t="function"==typeof e?e:z(e),function(){return B.call(this.children,t)}))},selectChildren:function(e){var t;return this.selectAll(null==e?P:(t="function"==typeof e?e:z(e),function(){return R.call(this.children,t)}))},filter:function(e){"function"!=typeof e&&(e=A(e));for(var t=this._groups,n=t.length,r=Array(n),a=0;a<n;++a)for(var o,i=t[a],l=i.length,s=r[a]=[],c=0;c<l;++c)(o=i[c])&&e.call(o,o.__data__,c,i)&&s.push(o);return new ed(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,V);var n=t?L:O,r=this._parents,a=this._groups;"function"!=typeof e&&(x=e,e=function(){return x});for(var o=a.length,i=Array(o),l=Array(o),s=Array(o),c=0;c<o;++c){var u=r[c],d=a[c],h=d.length,f="object"==typeof(y=e.call(u,u&&u.__data__,c,r))&&"length"in y?y:Array.from(y),m=f.length,g=l[c]=Array(m),p=i[c]=Array(m);n(u,d,g,p,s[c]=Array(h),f,t);for(var y,x,v,b,w=0,N=0;w<m;++w)if(v=g[w]){for(w>=N&&(N=w+1);!(b=p[N])&&++N<m;);v._next=b||null}}return(i=new ed(i,r))._enter=l,i._exit=s,i},enter:function(){return new ed(this._enter||this._groups.map(T),this._parents)},exit:function(){return new ed(this._exit||this._groups.map(T),this._parents)},join:function(e,t,n){var r=this.enter(),a=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(a=t(a))&&(a=a.selection()),null==n?o.remove():n(o),r&&a?r.merge(a).order():a},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,o=r.length,i=Math.min(a,o),l=Array(a),s=0;s<i;++s)for(var c,u=n[s],d=r[s],h=u.length,f=l[s]=Array(h),m=0;m<h;++m)(c=u[m]||d[m])&&(f[m]=c);for(;s<a;++s)l[s]=n[s];return new ed(l,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],o=a.length-1,i=a[o];--o>=0;)(r=a[o])&&(i&&4^r.compareDocumentPosition(i)&&i.parentNode.insertBefore(r,i),i=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=H);for(var n=this._groups,r=n.length,a=Array(r),o=0;o<r;++o){for(var i,l=n[o],s=l.length,c=a[o]=Array(s),u=0;u<s;++u)(i=l[u])&&(c[u]=i);c.sort(t)}return new ed(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null},size:function(){let e=0;for(let t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,o=t[n],i=0,l=o.length;i<l;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this},attr:function(e,t){var n=X(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):W(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=Y(e+"");if(arguments.length<2){for(var r=Z(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?G:$)(this,e)}}:t?function(e){return function(){G(this,e)}}:function(e){return function(){$(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?Q:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?J:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(ee)},lower:function(){return this.each(et)},append:function(e){var t="function"==typeof e?e:en(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:en(e),r=null==t?er:"function"==typeof t?t:k(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(ea)},clone:function(e){return this.select(e?ei:eo)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,o=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}),i=o.length;if(arguments.length<2){var l=this.node().__on;if(l){for(var s,c=0,u=l.length;c<u;++c)for(r=0,s=l[c];r<i;++r)if((a=o[r]).type===s.type&&a.name===s.name)return s.value}return}for(r=0,l=t?es:el;r<i;++r)this.each(l(o[r],t,n));return this},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return ec(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return ec(this,e,t)}})(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,a=e[t],o=0,i=a.length;o<i;++o)(r=a[o])&&(yield r)}};let em={passive:!1},eg={capture:!0,passive:!1};function ep(e){e.stopImmediatePropagation()}function ey(e){e.preventDefault(),e.stopImmediatePropagation()}function ex(e){var t=e.document.documentElement,n=ef(e).on("dragstart.drag",ey,eg);"onselectstart"in t?n.on("selectstart.drag",ey,eg):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ev(e,t){var n=e.document.documentElement,r=ef(e).on("dragstart.drag",null);t&&(r.on("click.drag",ey,eg),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function eb(e){return((e=Math.exp(e))+1/e)/2}let ew=function e(t,n,r){function a(e,a){var o,i,l=e[0],s=e[1],c=e[2],u=a[0],d=a[1],h=a[2],f=u-l,m=d-s,g=f*f+m*m;if(g<1e-12)i=Math.log(h/c)/t,o=function(e){return[l+e*f,s+e*m,c*Math.exp(t*e*i)]};else{var p=Math.sqrt(g),y=(h*h-c*c+r*g)/(2*c*n*p),x=(h*h-c*c-r*g)/(2*h*n*p),v=Math.log(Math.sqrt(y*y+1)-y);i=(Math.log(Math.sqrt(x*x+1)-x)-v)/t,o=function(e){var r,a,o=e*i,u=eb(v),d=c/(n*p)*(u*(((r=Math.exp(2*(r=t*o+v)))-1)/(r+1))-((a=Math.exp(a=v))-1/a)/2);return[l+d*f,s+d*m,c*u/eb(t*o+v)]}}return o.duration=1e3*i*t/Math.SQRT2,o}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function eN(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}var eS,eE,e_=0,ej=0,ek=0,eM=0,eC=0,eA=0,ez="object"==typeof performance&&performance.now?performance:Date,eB="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function eI(){return eC||(eB(eR),eC=ez.now()+eA)}function eR(){eC=0}function eP(){this._call=this._time=this._next=null}function eT(e,t,n){var r=new eP;return r.restart(e,t,n),r}function eD(){eC=(eM=ez.now())+eA,e_=ej=0;try{eI(),++e_;for(var e,t=eS;t;)(e=eC-t._time)>=0&&t._call.call(void 0,e),t=t._next;--e_}finally{e_=0,function(){for(var e,t,n=eS,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:eS=t);eE=e,eL(r)}(),eC=0}}function eO(){var e=ez.now(),t=e-eM;t>1e3&&(eA-=t,eM=e)}function eL(e){!e_&&(ej&&(ej=clearTimeout(ej)),e-eC>24?(e<1/0&&(ej=setTimeout(eD,e-ez.now()-eA)),ek&&(ek=clearInterval(ek))):(ek||(eM=ez.now(),ek=setInterval(eO,1e3)),e_=1,eB(eD)))}function eV(e,t,n){var r=new eP;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}eP.prototype=eT.prototype={constructor:eP,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?eI():+n)+(null==t?0:+t),this._next||eE===this||(eE?eE._next=this:eS=this,eE=this),this._call=e,this._time=n,eL()},stop:function(){this._call&&(this._call=null,this._time=1/0,eL())}};var eH=S("start","end","cancel","interrupt"),eF=[];function eq(e,t,n,r,a,o){var i=e.__transition;if(i){if(n in i)return}else e.__transition={};!function(e,t,n){var r,a=e.__transition;function o(s){var c,u,d,h;if(1!==n.state)return l();for(c in a)if((h=a[c]).name===n.name){if(3===h.state)return eV(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete a[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete a[c])}if(eV(function(){3===n.state&&(n.state=4,n.timer.restart(i,n.delay,n.time),i(s))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(c=0,n.state=3,r=Array(d=n.tween.length),u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function i(t){for(var a=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,i=r.length;++o<i;)r[o].call(e,a);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete a[t],a)return;delete e.__transition}a[t]=n,n.timer=eT(function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:r,group:a,on:eH,tween:eF,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function eX(e,t){var n=eW(e,t);if(n.state>0)throw Error("too late; already scheduled");return n}function eK(e,t){var n=eW(e,t);if(n.state>3)throw Error("too late; already running");return n}function eW(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error("transition not found");return n}function eY(e,t){var n,r,a,o=e.__transition,i=!0;if(o){for(a in t=null==t?null:t+"",o){if((n=o[a]).name!==t){i=!1;continue}r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[a]}i&&delete e.__transition}}function eZ(e,t){return e*=1,t*=1,function(n){return e*(1-n)+t*n}}var eU=180/Math.PI,eG={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function e$(e,t,n,r,a,o){var i,l,s;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,s/=l),e*r<t*n&&(e=-e,t=-t,s=-s,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*eU,skewX:Math.atan(s)*eU,scaleX:i,scaleY:l}}function eQ(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(o,i){var l,s,c,u,d=[],h=[];return o=e(o),i=e(i),!function(e,r,a,o,i,l){if(e!==a||r!==o){var s=i.push("translate(",null,t,null,n);l.push({i:s-4,x:eZ(e,a)},{i:s-2,x:eZ(r,o)})}else(a||o)&&i.push("translate("+a+t+o+n)}(o.translateX,o.translateY,i.translateX,i.translateY,d,h),l=o.rotate,s=i.rotate,l!==s?(l-s>180?s+=360:s-l>180&&(l+=360),h.push({i:d.push(a(d)+"rotate(",null,r)-2,x:eZ(l,s)})):s&&d.push(a(d)+"rotate("+s+r),c=o.skewX,u=i.skewX,c!==u?h.push({i:d.push(a(d)+"skewX(",null,r)-2,x:eZ(c,u)}):u&&d.push(a(d)+"skewX("+u+r),!function(e,t,n,r,o,i){if(e!==n||t!==r){var l=o.push(a(o)+"scale(",null,",",null,")");i.push({i:l-4,x:eZ(e,n)},{i:l-2,x:eZ(t,r)})}else(1!==n||1!==r)&&o.push(a(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,i.scaleX,i.scaleY,d,h),o=i=null,function(e){for(var t,n=-1,r=h.length;++n<r;)d[(t=h[n]).i]=t.x(e);return d.join("")}}}var eJ=eQ(function(e){let t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?eG:e$(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),e0=eQ(function(e){return null==e?eG:(t||(t=document.createElementNS("http://www.w3.org/2000/svg","g")),t.setAttribute("transform",e),e=t.transform.baseVal.consolidate())?e$((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):eG},", ",")",")");function e1(e,t,n){var r=e._id;return e.each(function(){var e=eK(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return eW(e,r).value[t]}}function e2(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function e3(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function e5(){}var e4="\\s*([+-]?\\d+)\\s*",e6="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",e7="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",e8=/^#([0-9a-f]{3,8})$/,e9=new RegExp("^rgb\\(".concat(e4,",").concat(e4,",").concat(e4,"\\)$")),te=new RegExp("^rgb\\(".concat(e7,",").concat(e7,",").concat(e7,"\\)$")),tt=new RegExp("^rgba\\(".concat(e4,",").concat(e4,",").concat(e4,",").concat(e6,"\\)$")),tn=new RegExp("^rgba\\(".concat(e7,",").concat(e7,",").concat(e7,",").concat(e6,"\\)$")),tr=new RegExp("^hsl\\(".concat(e6,",").concat(e7,",").concat(e7,"\\)$")),ta=new RegExp("^hsla\\(".concat(e6,",").concat(e7,",").concat(e7,",").concat(e6,"\\)$")),to={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function ti(){return this.rgb().formatHex()}function tl(){return this.rgb().formatRgb()}function ts(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=e8.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?tc(t):3===n?new th(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?tu(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?tu(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=e9.exec(e))?new th(t[1],t[2],t[3],1):(t=te.exec(e))?new th(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=tt.exec(e))?tu(t[1],t[2],t[3],t[4]):(t=tn.exec(e))?tu(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=tr.exec(e))?tx(t[1],t[2]/100,t[3]/100,1):(t=ta.exec(e))?tx(t[1],t[2]/100,t[3]/100,t[4]):to.hasOwnProperty(e)?tc(to[e]):"transparent"===e?new th(NaN,NaN,NaN,0):null}function tc(e){return new th(e>>16&255,e>>8&255,255&e,1)}function tu(e,t,n,r){return r<=0&&(e=t=n=NaN),new th(e,t,n,r)}function td(e,t,n,r){var a;return 1==arguments.length?((a=e)instanceof e5||(a=ts(a)),a)?new th((a=a.rgb()).r,a.g,a.b,a.opacity):new th:new th(e,t,n,null==r?1:r)}function th(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function tf(){return"#".concat(ty(this.r)).concat(ty(this.g)).concat(ty(this.b))}function tm(){let e=tg(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(tp(this.r),", ").concat(tp(this.g),", ").concat(tp(this.b)).concat(1===e?")":", ".concat(e,")"))}function tg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function tp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ty(e){return((e=tp(e))<16?"0":"")+e.toString(16)}function tx(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new tb(e,t,n,r)}function tv(e){if(e instanceof tb)return new tb(e.h,e.s,e.l,e.opacity);if(e instanceof e5||(e=ts(e)),!e)return new tb;if(e instanceof tb)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,l=o-a,s=(o+a)/2;return l?(i=t===o?(n-r)/l+(n<r)*6:n===o?(r-t)/l+2:(t-n)/l+4,l/=s<.5?o+a:2-o-a,i*=60):l=s>0&&s<1?0:i,new tb(i,l,s,e.opacity)}function tb(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function tw(e){return(e=(e||0)%360)<0?e+360:e}function tN(e){return Math.max(0,Math.min(1,e||0))}function tS(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function tE(e,t,n,r,a){var o=e*e,i=o*e;return((1-3*e+3*o-i)*t+(4-6*o+3*i)*n+(1+3*e+3*o-3*i)*r+i*a)/6}e2(e5,ts,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ti,formatHex:ti,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return tv(this).formatHsl()},formatRgb:tl,toString:tl}),e2(th,td,e3(e5,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new th(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new th(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new th(tp(this.r),tp(this.g),tp(this.b),tg(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tf,formatHex:tf,formatHex8:function(){return"#".concat(ty(this.r)).concat(ty(this.g)).concat(ty(this.b)).concat(ty((isNaN(this.opacity)?1:this.opacity)*255))},formatRgb:tm,toString:tm})),e2(tb,function(e,t,n,r){return 1==arguments.length?tv(e):new tb(e,t,n,null==r?1:r)},e3(e5,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new tb(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new tb(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new th(tS(e>=240?e-240:e+120,a,r),tS(e,a,r),tS(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new tb(tw(this.h),tN(this.s),tN(this.l),tg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=tg(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(tw(this.h),", ").concat(100*tN(this.s),"%, ").concat(100*tN(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));let t_=e=>()=>e;function tj(e,t){var n=t-e;return n?function(t){return e+t*n}:t_(isNaN(e)?t:e)}let tk=function e(t){var n,r=1==(n=+t)?tj:function(e,t){var r,a,o;return t-e?(r=e,a=t,r=Math.pow(r,o=n),a=Math.pow(a,o)-r,o=1/o,function(e){return Math.pow(r+e*a,o)}):t_(isNaN(e)?t:e)};function a(e,t){var n=r((e=td(e)).r,(t=td(t)).r),a=r(e.g,t.g),o=r(e.b,t.b),i=tj(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=a(t),e.b=o(t),e.opacity=i(t),e+""}}return a.gamma=e,a}(1);function tM(e){return function(t){var n,r,a=t.length,o=Array(a),i=Array(a),l=Array(a);for(n=0;n<a;++n)r=td(t[n]),o[n]=r.r||0,i[n]=r.g||0,l[n]=r.b||0;return o=e(o),i=e(i),l=e(l),r.opacity=1,function(e){return r.r=o(e),r.g=i(e),r.b=l(e),r+""}}}tM(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],o=e[r+1],i=r>0?e[r-1]:2*a-o,l=r<t-1?e[r+2]:2*o-a;return tE((n-r/t)*t,i,a,o,l)}}),tM(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],o=e[r%t],i=e[(r+1)%t],l=e[(r+2)%t];return tE((n-r/t)*t,a,o,i,l)}});var tC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tA=RegExp(tC.source,"g");function tz(e,t){var n;return("number"==typeof t?eZ:t instanceof ts?tk:(n=ts(t))?(t=n,tk):function(e,t){var n,r,a,o,i,l=tC.lastIndex=tA.lastIndex=0,s=-1,c=[],u=[];for(e+="",t+="";(a=tC.exec(e))&&(o=tA.exec(t));)(i=o.index)>l&&(i=t.slice(l,i),c[s]?c[s]+=i:c[++s]=i),(a=a[0])===(o=o[0])?c[s]?c[s]+=o:c[++s]=o:(c[++s]=null,u.push({i:s,x:eZ(a,o)})),l=tA.lastIndex;return l<t.length&&(i=t.slice(l),c[s]?c[s]+=i:c[++s]=i),c.length<2?u[0]?(n=u[0].x,function(e){return n(e)+""}):(r=t,function(){return r}):(t=u.length,function(e){for(var n,r=0;r<t;++r)c[(n=u[r]).i]=n.x(e);return c.join("")})})(e,t)}var tB=eh.prototype.constructor;function tI(e){return function(){this.style.removeProperty(e)}}var tR=0;function tP(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}var tT=eh.prototype;tP.prototype=(function(e){return eh().transition(e)}).prototype={constructor:tP,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=k(e));for(var r=this._groups,a=r.length,o=Array(a),i=0;i<a;++i)for(var l,s,c=r[i],u=c.length,d=o[i]=Array(u),h=0;h<u;++h)(l=c[h])&&(s=e.call(l,l.__data__,h,c))&&("__data__"in l&&(s.__data__=l.__data__),d[h]=s,eq(d[h],t,n,h,d,eW(l,n)));return new tP(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=C(e));for(var r=this._groups,a=r.length,o=[],i=[],l=0;l<a;++l)for(var s,c=r[l],u=c.length,d=0;d<u;++d)if(s=c[d]){for(var h,f=e.call(s,s.__data__,d,c),m=eW(s,n),g=0,p=f.length;g<p;++g)(h=f[g])&&eq(h,t,n,g,f,m);o.push(f),i.push(s)}return new tP(o,i,t,n)},selectChild:tT.selectChild,selectChildren:tT.selectChildren,filter:function(e){"function"!=typeof e&&(e=A(e));for(var t=this._groups,n=t.length,r=Array(n),a=0;a<n;++a)for(var o,i=t[a],l=i.length,s=r[a]=[],c=0;c<l;++c)(o=i[c])&&e.call(o,o.__data__,c,i)&&s.push(o);return new tP(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,a=n.length,o=Math.min(r,a),i=Array(r),l=0;l<o;++l)for(var s,c=t[l],u=n[l],d=c.length,h=i[l]=Array(d),f=0;f<d;++f)(s=c[f]||u[f])&&(h[f]=s);for(;l<r;++l)i[l]=t[l];return new tP(i,this._parents,this._name,this._id)},selection:function(){return new tB(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=++tR,r=this._groups,a=r.length,o=0;o<a;++o)for(var i,l=r[o],s=l.length,c=0;c<s;++c)if(i=l[c]){var u=eW(i,t);eq(i,e,n,c,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new tP(r,this._parents,e,n)},call:tT.call,nodes:tT.nodes,node:tT.node,size:tT.size,empty:tT.empty,each:tT.each,on:function(e,t){var n,r,a,o,i,l,s=this._id;return arguments.length<2?eW(this.node(),s).on.on(e):this.each((n=s,r=e,a=t,l=(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})?eX:eK,function(){var e=l(this,n),t=e.on;t!==o&&(i=(o=t).copy()).on(r,a),e.on=i}))},attr:function(e,t){var n=X(e),r="transform"===n?e0:tz;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var r,a,o;return function(){var i,l,s=n(this);return null==s?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local))===(l=s+"")?null:i===r&&l===a?o:(a=l,o=t(r=i,s))}}:function(e,t,n){var r,a,o;return function(){var i,l,s=n(this);return null==s?void this.removeAttribute(e):(i=this.getAttribute(e))===(l=s+"")?null:i===r&&l===a?o:(a=l,o=t(r=i,s))}})(n,r,e1(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var r,a,o=n+"";return function(){var i=this.getAttributeNS(e.space,e.local);return i===o?null:i===r?a:a=t(r=i,n)}}:function(e,t,n){var r,a,o=n+"";return function(){var i=this.getAttribute(e);return i===o?null:i===r?a:a=t(r=i,n)}})(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw Error();var r=X(e);return this.tween(n,(r.local?function(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t){this.setAttributeNS(e.space,e.local,a.call(this,t))}),n}return a._value=t,a}:function(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t){this.setAttribute(e,a.call(this,t))}),n}return a._value=t,a})(r,t))},style:function(e,t,n){var r,a,o,i,l,s,c,u,d,h,f,m,g,p,y,x,v,b,w,N,S,E="transform"==(e+="")?eJ:tz;return null==t?this.styleTween(e,(r=e,function(){var e=W(this,r),t=(this.style.removeProperty(r),W(this,r));return e===t?null:e===a&&t===o?i:i=E(a=e,o=t)})).on("end.style."+e,tI(e)):"function"==typeof t?this.styleTween(e,(l=e,s=e1(this,"style."+e,t),function(){var e=W(this,l),t=s(this),n=t+"";return null==t&&(this.style.removeProperty(l),n=t=W(this,l)),e===n?null:e===c&&n===u?d:(u=n,d=E(c=e,t))})).each((h=this._id,v="end."+(x="style."+(f=e)),function(){var e=eK(this,h),t=e.on,n=null==e.value[x]?y||(y=tI(f)):void 0;(t!==m||p!==n)&&(g=(m=t).copy()).on(v,p=n),e.on=g})):this.styleTween(e,(b=e,S=t+"",function(){var e=W(this,b);return e===S?null:e===w?N:N=E(w=e,t)}),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw Error();return this.tween(r,function(e,t,n){var r,a;function o(){var o=t.apply(this,arguments);return o!==a&&(r=(a=o)&&function(t){this.style.setProperty(e,o.call(this,t),n)}),r}return o._value=t,o}(e,t,null==n?"":n))},text:function(e){var t,n;return this.tween("text","function"==typeof e?(t=e1(this,"text",e),function(){var e=t(this);this.textContent=null==e?"":e}):(n=null==e?"":e+"",function(){this.textContent=n}))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw Error();return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){this.textContent=r.call(this,e)}),t}return r._value=e,r}(e))},remove:function(){var e;return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,a=eW(this.node(),n).tween,o=0,i=a.length;o<i;++o)if((r=a[o]).name===e)return r.value;return null}return this.each((null==t?function(e,t){var n,r;return function(){var a=eK(this,e),o=a.tween;if(o!==n){r=n=o;for(var i=0,l=r.length;i<l;++i)if(r[i].name===t){(r=r.slice()).splice(i,1);break}}a.tween=r}}:function(e,t,n){var r,a;if("function"!=typeof n)throw Error();return function(){var o=eK(this,e),i=o.tween;if(i!==r){a=(r=i).slice();for(var l={name:t,value:n},s=0,c=a.length;s<c;++s)if(a[s].name===t){a[s]=l;break}s===c&&a.push(l)}o.tween=a}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){eX(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){eX(this,e).delay=t}})(t,e)):eW(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){eK(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){eK(this,e).duration=t}})(t,e)):eW(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw Error();return function(){eK(this,e).ease=t}}(t,e)):eW(this.node(),t).ease},easeVarying:function(e){var t;if("function"!=typeof e)throw Error();return this.each((t=this._id,function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw Error();eK(this,t).ease=n}))},end:function(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(o,i){var l={value:i},s={value:function(){0==--a&&o()}};n.each(function(){var n=eK(this,r),a=n.on;a!==e&&((t=(e=a).copy())._.cancel.push(l),t._.interrupt.push(l),t._.end.push(s)),n.on=t}),0===a&&o()})},[Symbol.iterator]:tT[Symbol.iterator]};var tD={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};eh.prototype.interrupt=function(e){return this.each(function(){eY(this,e)})},eh.prototype.transition=function(e){var t,n;e instanceof tP?(t=e._id,e=e._name):(t=++tR,(n=tD).time=eI(),e=null==e?null:e+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i,l=r[o],s=l.length,c=0;c<s;++c)(i=l[c])&&eq(i,e,t,c,l,n||function(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error("transition ".concat(t," not found"));return n}(i,t));return new tP(r,this._parents,e,t)};let tO=e=>()=>e;function tL(e,t){let{sourceEvent:n,target:r,transform:a,dispatch:o}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:o}})}function tV(e,t,n){this.k=e,this.x=t,this.y=n}tV.prototype={constructor:tV,scale:function(e){return 1===e?this:new tV(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new tV(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tH=new tV(1,0,0);function tF(e){e.stopImmediatePropagation()}function tq(e){e.preventDefault(),e.stopImmediatePropagation()}function tX(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function tK(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function tW(){return this.__zoom||tH}function tY(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tZ(){return navigator.maxTouchPoints||"ontouchstart"in this}function tU(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function tG(){var e,t,n,r=tX,a=tK,o=tU,i=tY,l=tZ,s=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=ew,h=S("start","zoom","end"),f=0,m=10;function g(e){e.property("__zoom",tW).on("wheel.zoom",N,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",_).filter(l).on("touchstart.zoom",j).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(e,t){return(t=Math.max(s[0],Math.min(s[1],t)))===e.k?e:new tV(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,a=t[1]-n[1]*e.k;return r===e.x&&a===e.y?e:new tV(e.k,r,a)}function x(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function v(e,t,n,r){e.on("start.zoom",function(){b(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(r).end()}).tween("zoom",function(){var e=arguments,o=b(this,e).event(r),i=a.apply(this,e),l=null==n?x(i):"function"==typeof n?n.apply(this,e):n,s=Math.max(i[1][0]-i[0][0],i[1][1]-i[0][1]),c=this.__zoom,u="function"==typeof t?t.apply(this,e):t,h=d(c.invert(l).concat(s/c.k),u.invert(l).concat(s/u.k));return function(e){if(1===e)e=u;else{var t=h(e),n=s/t[2];e=new tV(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}})}function b(e,t,n){return!n&&e.__zooming||new w(e,t)}function w(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=a.apply(e,t),this.taps=0}function N(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var l=b(this,n).event(e),u=this.__zoom,d=Math.max(s[0],Math.min(s[1],u.k*Math.pow(2,i.apply(this,arguments)))),h=eN(e);if(l.wheel)(l.mouse[0][0]!==h[0]||l.mouse[0][1]!==h[1])&&(l.mouse[1]=u.invert(l.mouse[0]=h)),clearTimeout(l.wheel);else{if(u.k===d)return;l.mouse=[h,u.invert(h)],eY(this),l.start()}tq(e),l.wheel=setTimeout(function(){l.wheel=null,l.end()},150),l.zoom("mouse",o(y(p(u,d),l.mouse[0],l.mouse[1]),l.extent,c))}}function E(e){for(var t=arguments.length,a=Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];if(!n&&r.apply(this,arguments)){var l=e.currentTarget,s=b(this,a,!0).event(e),u=ef(e.view).on("mousemove.zoom",function(e){if(tq(e),!s.moved){var t=e.clientX-h,n=e.clientY-m;s.moved=t*t+n*n>f}s.event(e).zoom("mouse",o(y(s.that.__zoom,s.mouse[0]=eN(e,l),s.mouse[1]),s.extent,c))},!0).on("mouseup.zoom",function(e){u.on("mousemove.zoom mouseup.zoom",null),ev(e.view,s.moved),tq(e),s.event(e).end()},!0),d=eN(e,l),h=e.clientX,m=e.clientY;ex(e.view),tF(e),s.mouse=[d,this.__zoom.invert(d)],eY(this),s.start()}}function _(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(r.apply(this,arguments)){var l=this.__zoom,s=eN(e.changedTouches?e.changedTouches[0]:e,this),d=l.invert(s),h=l.k*(e.shiftKey?.5:2),f=o(y(p(l,h),s,d),a.apply(this,n),c);tq(e),u>0?ef(this).transition().duration(u).call(v,f,s,e):ef(this).call(g.transform,f,s,e)}}function j(n){for(var a=arguments.length,o=Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];if(r.apply(this,arguments)){var l,s,c,u,d=n.touches,h=d.length,f=b(this,o,n.changedTouches.length===h).event(n);for(tF(n),s=0;s<h;++s)u=[u=eN(c=d[s],this),this.__zoom.invert(u),c.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,l=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),l&&(f.taps<2&&(t=u[0],e=setTimeout(function(){e=null},500)),eY(this),f.start())}}function k(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.__zooming){var a,i,l,s,u=b(this,n).event(e),d=e.changedTouches,h=d.length;for(tq(e),a=0;a<h;++a)l=eN(i=d[a],this),u.touch0&&u.touch0[2]===i.identifier?u.touch0[0]=l:u.touch1&&u.touch1[2]===i.identifier&&(u.touch1[0]=l);if(i=u.that.__zoom,u.touch1){var f=u.touch0[0],m=u.touch0[1],g=u.touch1[0],x=u.touch1[1],v=(v=g[0]-f[0])*v+(v=g[1]-f[1])*v,w=(w=x[0]-m[0])*w+(w=x[1]-m[1])*w;i=p(i,Math.sqrt(v/w)),l=[(f[0]+g[0])/2,(f[1]+g[1])/2],s=[(m[0]+x[0])/2,(m[1]+x[1])/2]}else{if(!u.touch0)return;l=u.touch0[0],s=u.touch0[1]}u.zoom("touch",o(y(i,l,s),u.extent,c))}}function M(e){for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];if(this.__zooming){var i,l,s=b(this,a).event(e),c=e.changedTouches,u=c.length;for(tF(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),i=0;i<u;++i)l=c[i],s.touch0&&s.touch0[2]===l.identifier?delete s.touch0:s.touch1&&s.touch1[2]===l.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(l=eN(l,this),Math.hypot(t[0]-l[0],t[1]-l[1])<m)){var d=ef(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return g.transform=function(e,t,n,r){var a=e.selection?e.selection():e;a.property("__zoom",tW),e!==a?v(e,t,n,r):a.interrupt().each(function(){b(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},g.scaleBy=function(e,t,n,r){g.scaleTo(e,function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n},n,r)},g.scaleTo=function(e,t,n,r){g.transform(e,function(){var e=a.apply(this,arguments),r=this.__zoom,i=null==n?x(e):"function"==typeof n?n.apply(this,arguments):n,l=r.invert(i),s="function"==typeof t?t.apply(this,arguments):t;return o(y(p(r,s),i,l),e,c)},n,r)},g.translateBy=function(e,t,n,r){g.transform(e,function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),a.apply(this,arguments),c)},null,r)},g.translateTo=function(e,t,n,r,i){g.transform(e,function(){var e=a.apply(this,arguments),i=this.__zoom,l=null==r?x(e):"function"==typeof r?r.apply(this,arguments):r;return o(tH.translate(l[0],l[1]).scale(i.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},r,i)},w.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=ef(this.that).datum();h.call(e,this.that,new tL(e,{sourceEvent:this.sourceEvent,target:g,type:e,transform:this.that.__zoom,dispatch:h}),t)}},g.wheelDelta=function(e){return arguments.length?(i="function"==typeof e?e:tO(+e),g):i},g.filter=function(e){return arguments.length?(r="function"==typeof e?e:tO(!!e),g):r},g.touchable=function(e){return arguments.length?(l="function"==typeof e?e:tO(!!e),g):l},g.extent=function(e){return arguments.length?(a="function"==typeof e?e:tO([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):a},g.scaleExtent=function(e){return arguments.length?(s[0]=+e[0],s[1]=+e[1],g):[s[0],s[1]]},g.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(e){return arguments.length?(o=e,g):o},g.duration=function(e){return arguments.length?(u=+e,g):u},g.interpolate=function(e){return arguments.length?(d=e,g):d},g.on=function(){var e=h.on.apply(h,arguments);return e===h?g:e},g.clickDistance=function(e){return arguments.length?(f=(e*=1)*e,g):Math.sqrt(f)},g.tapDistance=function(e){return arguments.length?(m=+e,g):m},g}tV.prototype;let t$=e=>()=>e;function tQ(e,t){let{sourceEvent:n,subject:r,target:a,identifier:o,active:i,x:l,y:s,dx:c,dy:u,dispatch:d}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}function tJ(e){return!e.ctrlKey&&!e.button}function t0(){return this.parentNode}function t1(e,t){return null==t?{x:e.x,y:e.y}:t}function t2(){return navigator.maxTouchPoints||"ontouchstart"in this}tQ.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e},e.i(60665);let t3=(0,u.createContext)(null),t5=t3.Provider,t4={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error003:e=>'Node type "'.concat(e,'" not found. Using fallback type "default".'),error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error009:e=>'Marker type "'.concat(e,"\" doesn't exist."),error008:(e,t)=>"Couldn't create edge for ".concat(!e?"source":"target",' handle id: "').concat(!e?t.sourceHandle:t.targetHandle,'", edge id: ').concat(t.id,"."),error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>'Edge type "'.concat(e,'" not found. Using fallback type "default".'),error012:e=>'Node with id "'.concat(e,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.')},t6=t4.error001();function t7(e,t){let n=(0,u.useContext)(t3);if(null===n)throw Error(t6);return v(n,e,t)}let t8=()=>{let e=(0,u.useContext)(t3);if(null===e)throw Error(t6);return(0,u.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},t9=e=>e.userSelectionActive?"none":"all";function ne(e){let{position:t,children:n,className:r,style:a,...o}=e,i=t7(t9),l="".concat(t).split("-");return u.default.createElement("div",{className:h(["react-flow__panel",r,...l]),style:{...a,pointerEvents:i},...o},n)}function nt(e){let{proOptions:t,position:n="bottom-right"}=e;return(null==t?void 0:t.hideAttribution)?null:u.default.createElement(ne,{position:n,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},u.default.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var nn=(0,u.memo)(e=>{let{x:t,y:n,label:r,labelStyle:a={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:l=[2,4],labelBgBorderRadius:s=2,children:c,className:d,...f}=e,m=(0,u.useRef)(null),[g,p]=(0,u.useState)({x:0,y:0,width:0,height:0}),y=h(["react-flow__edge-textwrapper",d]);return((0,u.useEffect)(()=>{if(m.current){let e=m.current.getBBox();p({x:e.x,y:e.y,width:e.width,height:e.height})}},[r]),void 0!==r&&r)?u.default.createElement("g",{transform:"translate(".concat(t-g.width/2," ").concat(n-g.height/2,")"),className:y,visibility:g.width?"visible":"hidden",...f},o&&u.default.createElement("rect",{width:g.width+2*l[0],x:-l[0],y:-l[1],height:g.height+2*l[1],className:"react-flow__edge-textbg",style:i,rx:s,ry:s}),u.default.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:m,style:a},r),c):null});let nr=e=>({width:e.offsetWidth,height:e.offsetHeight}),na=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)},no=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=arguments.length>1?arguments[1]:void 0;return{x:na(e.x,t[0][0],t[1][0]),y:na(e.y,t[0][1],t[1][1])}},ni=(e,t,n)=>e<t?na(Math.abs(e-t),1,50)/50:e>n?-na(Math.abs(e-n),1,50)/50:0,nl=(e,t)=>[20*ni(e.x,35,t.width-35),20*ni(e.y,35,t.height-35)],ns=e=>{var t,n;return(null==(t=e.getRootNode)?void 0:t.call(e))||(null==(n=window)?void 0:n.document)},nc=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),nu=e=>{let{x:t,y:n,width:r,height:a}=e;return{x:t,y:n,x2:t+r,y2:n+a}},nd=e=>{let{x:t,y:n,x2:r,y2:a}=e;return{x:t,y:n,width:r-t,height:a-n}},nh=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),nf=(e,t)=>Math.ceil(Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x))*Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y))),nm=e=>!isNaN(e)&&isFinite(e),ng=Symbol.for("internals"),np=["Enter"," ","Escape"],ny=(e,t)=>{};function nx(e){var t,n;let r="nativeEvent"in e?e.nativeEvent:e,a=(null==(n=r.composedPath)||null==(t=n.call(r))?void 0:t[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(null==a?void 0:a.nodeName)||(null==a?void 0:a.hasAttribute("contenteditable"))||!!(null==a?void 0:a.closest(".nokey"))}let nv=(e,t)=>{var n,r,a,o;let i="clientX"in e,l=i?e.clientX:null==(n=e.touches)?void 0:n[0].clientX,s=i?e.clientY:null==(r=e.touches)?void 0:r[0].clientY;return{x:l-(null!=(a=null==t?void 0:t.left)?a:0),y:s-(null!=(o=null==t?void 0:t.top)?o:0)}},nb=()=>{var e,t;return"undefined"!=typeof navigator&&(null==(t=navigator)||null==(e=t.userAgent)?void 0:e.indexOf("Mac"))>=0},nw=e=>{let{id:t,path:n,labelX:r,labelY:a,label:o,labelStyle:i,labelShowBg:l,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:m,interactionWidth:g=20}=e;return u.default.createElement(u.default.Fragment,null,u.default.createElement("path",{id:t,style:h,d:n,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:m}),g&&u.default.createElement("path",{d:n,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),o&&nm(r)&&nm(a)?u.default.createElement(nn,{x:r,y:a,label:o,labelStyle:i,labelShowBg:l,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:d}):null)};function nN(e,t,n){return void 0===n?n:r=>{let a=t().edges.find(t=>t.id===e);a&&n(r,{...a})}}function nS(e){let{sourceX:t,sourceY:n,targetX:r,targetY:a}=e,o=Math.abs(r-t)/2,i=Math.abs(a-n)/2;return[r<t?r+o:r-o,a<n?a+i:a-i,o,i]}function nE(e){let{sourceX:t,sourceY:n,targetX:r,targetY:a,sourceControlX:o,sourceControlY:i,targetControlX:l,targetControlY:s}=e,c=.125*t+.375*o+.375*l+.125*r,u=.125*n+.375*i+.375*s+.125*a,d=Math.abs(c-t),h=Math.abs(u-n);return[c,u,d,h]}function n_(e){let{pos:t,x1:n,y1:r,x2:a,y2:o}=e;return t===l.Left||t===l.Right?[.5*(n+a),r]:[n,.5*(r+o)]}function nj(e){let{sourceX:t,sourceY:n,sourcePosition:r=l.Bottom,targetX:a,targetY:o,targetPosition:i=l.Top}=e,[s,c]=n_({pos:r,x1:t,y1:n,x2:a,y2:o}),[u,d]=n_({pos:i,x1:a,y1:o,x2:t,y2:n}),[h,f,m,g]=nE({sourceX:t,sourceY:n,targetX:a,targetY:o,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:d});return["M".concat(t,",").concat(n," C").concat(s,",").concat(c," ").concat(u,",").concat(d," ").concat(a,",").concat(o),h,f,m,g]}nw.displayName="BaseEdge",function(e){e.Strict="strict",e.Loose="loose"}(n||(n={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(r||(r={})),function(e){e.Partial="partial",e.Full="full"}(a||(a={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(o||(o={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(i||(i={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(l||(l={}));let nk=(0,u.memo)(e=>{let{sourceX:t,sourceY:n,targetX:r,targetY:a,sourcePosition:o=l.Bottom,targetPosition:i=l.Top,label:s,labelStyle:c,labelShowBg:d,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:m,style:g,markerEnd:p,markerStart:y,interactionWidth:x}=e,[v,b,w]=nj({sourceX:t,sourceY:n,sourcePosition:o,targetX:r,targetY:a,targetPosition:i});return u.default.createElement(nw,{path:v,labelX:b,labelY:w,label:s,labelStyle:c,labelShowBg:d,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:m,style:g,markerEnd:p,markerStart:y,interactionWidth:x})});nk.displayName="SimpleBezierEdge";let nM={[l.Left]:{x:-1,y:0},[l.Right]:{x:1,y:0},[l.Top]:{x:0,y:-1},[l.Bottom]:{x:0,y:1}},nC=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function nA(e){let{sourceX:t,sourceY:n,sourcePosition:r=l.Bottom,targetX:a,targetY:o,targetPosition:i=l.Top,borderRadius:s=5,centerX:c,centerY:u,offset:d=20}=e,[h,f,m,g,p]=function(e){let t,n,{source:r,sourcePosition:a=l.Bottom,target:o,targetPosition:i=l.Top,center:s,offset:c}=e,u=nM[a],d=nM[i],h={x:r.x+u.x*c,y:r.y+u.y*c},f={x:o.x+d.x*c,y:o.y+d.y*c},m=(e=>{let{source:t,sourcePosition:n=l.Bottom,target:r}=e;return n===l.Left||n===l.Right?t.x<r.x?{x:1,y:0}:{x:-1,y:0}:t.y<r.y?{x:0,y:1}:{x:0,y:-1}})({source:h,sourcePosition:a,target:f}),g=0!==m.x?"x":"y",p=m[g],y=[],x={x:0,y:0},v={x:0,y:0},[b,w,N,S]=nS({sourceX:r.x,sourceY:r.y,targetX:o.x,targetY:o.y});if(u[g]*d[g]==-1){var E,_;t=null!=(E=s.x)?E:b,n=null!=(_=s.y)?_:w;let e=[{x:t,y:h.y},{x:t,y:f.y}],r=[{x:h.x,y:n},{x:f.x,y:n}];y=u[g]===p?"x"===g?e:r:"x"===g?r:e}else{let e=[{x:h.x,y:f.y}],l=[{x:f.x,y:h.y}];if(y="x"===g?u.x===p?l:e:u.y===p?e:l,a===i){let e=Math.abs(r[g]-o[g]);if(e<=c){let t=Math.min(c-1,c-e);u[g]===p?x[g]=(h[g]>r[g]?-1:1)*t:v[g]=(f[g]>o[g]?-1:1)*t}}if(a!==i){let t="x"===g?"y":"x",n=u[g]===d[t],r=h[t]>f[t],a=h[t]<f[t];(1===u[g]&&(!n&&r||n&&a)||1!==u[g]&&(!n&&a||n&&r))&&(y="x"===g?e:l)}let s={x:h.x+x.x,y:h.y+x.y},m={x:f.x+v.x,y:f.y+v.y};Math.max(Math.abs(s.x-y[0].x),Math.abs(m.x-y[0].x))>=Math.max(Math.abs(s.y-y[0].y),Math.abs(m.y-y[0].y))?(t=(s.x+m.x)/2,n=y[0].y):(t=y[0].x,n=(s.y+m.y)/2)}return[[r,{x:h.x+x.x,y:h.y+x.y},...y,{x:f.x+v.x,y:f.y+v.y},o],t,n,N,S]}({source:{x:t,y:n},sourcePosition:r,target:{x:a,y:o},targetPosition:i,center:{x:c,y:u},offset:d});return[h.reduce((e,t,n)=>e+(n>0&&n<h.length-1?function(e,t,n,r){let a=Math.min(nC(e,t)/2,nC(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return"L".concat(o," ").concat(i);if(e.y===i){let t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return"L ".concat(o+a*t,",").concat(i,"Q ").concat(o,",").concat(i," ").concat(o,",").concat(i+a*r)}let l=e.x<n.x?1:-1,s=e.y<n.y?-1:1;return"L ".concat(o,",").concat(i+a*s,"Q ").concat(o,",").concat(i," ").concat(o+a*l,",").concat(i)}(h[n-1],t,h[n+1],s):"".concat(0===n?"M":"L").concat(t.x," ").concat(t.y)),""),f,m,g,p]}let nz=(0,u.memo)(e=>{let{sourceX:t,sourceY:n,targetX:r,targetY:a,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,sourcePosition:m=l.Bottom,targetPosition:g=l.Top,markerEnd:p,markerStart:y,pathOptions:x,interactionWidth:v}=e,[b,w,N]=nA({sourceX:t,sourceY:n,sourcePosition:m,targetX:r,targetY:a,targetPosition:g,borderRadius:null==x?void 0:x.borderRadius,offset:null==x?void 0:x.offset});return u.default.createElement(nw,{path:b,labelX:w,labelY:N,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:p,markerStart:y,interactionWidth:v})});nz.displayName="SmoothStepEdge";let nB=(0,u.memo)(e=>{var t;return u.default.createElement(nz,{...e,pathOptions:(0,u.useMemo)(()=>{var t;return{borderRadius:0,offset:null==(t=e.pathOptions)?void 0:t.offset}},[null==(t=e.pathOptions)?void 0:t.offset])})});nB.displayName="StepEdge";let nI=(0,u.memo)(e=>{let{sourceX:t,sourceY:n,targetX:r,targetY:a,label:o,labelStyle:i,labelShowBg:l,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:m,interactionWidth:g}=e,[p,y,x]=function(e){let{sourceX:t,sourceY:n,targetX:r,targetY:a}=e,[o,i,l,s]=nS({sourceX:t,sourceY:n,targetX:r,targetY:a});return["M ".concat(t,",").concat(n,"L ").concat(r,",").concat(a),o,i,l,s]}({sourceX:t,sourceY:n,targetX:r,targetY:a});return u.default.createElement(nw,{path:p,labelX:y,labelY:x,label:o,labelStyle:i,labelShowBg:l,labelBgStyle:s,labelBgPadding:c,labelBgBorderRadius:d,style:h,markerEnd:f,markerStart:m,interactionWidth:g})});function nR(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function nP(e){let{pos:t,x1:n,y1:r,x2:a,y2:o,c:i}=e;switch(t){case l.Left:return[n-nR(n-a,i),r];case l.Right:return[n+nR(a-n,i),r];case l.Top:return[n,r-nR(r-o,i)];case l.Bottom:return[n,r+nR(o-r,i)]}}function nT(e){let{sourceX:t,sourceY:n,sourcePosition:r=l.Bottom,targetX:a,targetY:o,targetPosition:i=l.Top,curvature:s=.25}=e,[c,u]=nP({pos:r,x1:t,y1:n,x2:a,y2:o,c:s}),[d,h]=nP({pos:i,x1:a,y1:o,x2:t,y2:n,c:s}),[f,m,g,p]=nE({sourceX:t,sourceY:n,targetX:a,targetY:o,sourceControlX:c,sourceControlY:u,targetControlX:d,targetControlY:h});return["M".concat(t,",").concat(n," C").concat(c,",").concat(u," ").concat(d,",").concat(h," ").concat(a,",").concat(o),f,m,g,p]}nI.displayName="StraightEdge";let nD=(0,u.memo)(e=>{let{sourceX:t,sourceY:n,targetX:r,targetY:a,sourcePosition:o=l.Bottom,targetPosition:i=l.Top,label:s,labelStyle:c,labelShowBg:d,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:m,style:g,markerEnd:p,markerStart:y,pathOptions:x,interactionWidth:v}=e,[b,w,N]=nT({sourceX:t,sourceY:n,sourcePosition:o,targetX:r,targetY:a,targetPosition:i,curvature:null==x?void 0:x.curvature});return u.default.createElement(nw,{path:b,labelX:w,labelY:N,label:s,labelStyle:c,labelShowBg:d,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:m,style:g,markerEnd:p,markerStart:y,interactionWidth:v})});nD.displayName="BezierEdge";let nO=(0,u.createContext)(null),nL=nO.Provider;nO.Consumer;let nV=(e,t)=>void 0===e?"":"string"==typeof e?e:"".concat(t?"".concat(t,"__"):"").concat(Object.keys(e).sort().map(t=>"".concat(t,"=").concat(e[t])).join("&")),nH=(e,t)=>{let n;return e.source&&e.target?((e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)))(n=(e=>"id"in e&&"source"in e&&"target"in e)(e)?{...e}:{...e,id:(e=>{let{source:t,sourceHandle:n,target:r,targetHandle:a}=e;return"reactflow__edge-".concat(t).concat(n||"","-").concat(r).concat(a||"")})(e)},t)?t:t.concat(n):(ny("006",t4.error006()),t)},nF=(e,t,n,r)=>{let{x:a,y:o}=e,[i,l,s]=t,[c,u]=r,d={x:(a-i)/s,y:(o-l)/s};return n?{x:c*Math.round(d.x/c),y:u*Math.round(d.y/u)}:d},nq=(e,t)=>{let{x:n,y:r}=e,[a,o,i]=t;return{x:n*i+a,y:r*i+o}},nX=function(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};let a=(null!=(t=e.width)?t:0)*r[0],o=(null!=(n=e.height)?n:0)*r[1],i={x:e.position.x-a,y:e.position.y-o};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-a,y:e.positionAbsolute.y-o}:i}},nK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0];return 0===e.length?{x:0,y:0,width:0,height:0}:nd(e.reduce((e,n)=>{let{x:r,y:a}=nX(n,t).positionAbsolute;return nc(e,nu({x:r,y:a,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0}))},nW=function(e,t){let[n,r,a]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0,0],s={x:(t.x-n)/a,y:(t.y-r)/a,width:t.width/a,height:t.height/a},c=[];return e.forEach(e=>{let{width:t,height:n,selectable:r=!0,hidden:a=!1}=e;if(i&&!r||a)return!1;let{positionAbsolute:u}=nX(e,l),d=nf(s,{x:u.x,y:u.y,width:t||0,height:n||0}),h=void 0===t||void 0===n||null===t||null===n,f=(t||0)*(n||0);(h||o&&d>0||d>=f||e.dragging)&&c.push(e)}),c},nY=(e,t)=>{let n=e.map(e=>e.id);return t.filter(e=>n.includes(e.source)||n.includes(e.target))},nZ=function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.1,i=na(Math.min(t/(e.width*(1+o)),n/(e.height*(1+o))),r,a),l=e.x+e.width/2;return{x:t/2-l*i,y:n/2-(e.y+e.height/2)*i,zoom:i}},nU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.transition().duration(t)};function nG(e,t,n,r){return(t[n]||[]).reduce((t,a)=>{if("".concat(e.id,"-").concat(a.id,"-").concat(n)!==r){var o,i,l,s;t.push({id:a.id||null,type:n,nodeId:e.id,x:(null!=(l=null==(o=e.positionAbsolute)?void 0:o.x)?l:0)+a.x+a.width/2,y:(null!=(s=null==(i=e.positionAbsolute)?void 0:i.y)?s:0)+a.y+a.height/2})}return t},[])}let n$={source:null,target:null,sourceHandle:null,targetHandle:null},nQ=()=>({handleDomNode:null,isValid:!1,connection:n$,endHandle:null});function nJ(e,t,r,a,o,i,l){let s="target"===o,c=l.querySelector('.react-flow__handle[data-id="'.concat(null==e?void 0:e.nodeId,"-").concat(null==e?void 0:e.id,"-").concat(null==e?void 0:e.type,'"]')),u={...nQ(),handleDomNode:c};if(c){let e=n0(void 0,c),o=c.getAttribute("data-nodeid"),l=c.getAttribute("data-handleid"),d=c.classList.contains("connectable"),h=c.classList.contains("connectableend"),f={source:s?o:r,sourceHandle:s?l:a,target:s?r:o,targetHandle:s?a:l};u.connection=f,d&&h&&(t===n.Strict?s&&"source"===e||!s&&"target"===e:o!==r||l!==a)&&(u.endHandle={nodeId:o,handleId:l,type:e},u.isValid=i(f))}return u}function n0(e,t){return e?e:(null==t?void 0:t.classList.contains("target"))?"target":(null==t?void 0:t.classList.contains("source"))?"source":null}function n1(e){null==e||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function n2(e){let t,n,{event:r,handleId:a,nodeId:o,onConnect:i,isTarget:l,getState:s,setState:c,isValidConnection:u,edgeUpdaterType:d,onReconnectEnd:h}=e,f=ns(r.target),{connectionMode:m,domNode:g,autoPanOnConnect:p,connectionRadius:y,onConnectStart:x,panBy:v,getNodes:b,cancelConnection:w}=s(),N=0,{x:S,y:E}=nv(r),_=n0(d,null==f?void 0:f.elementFromPoint(S,E)),j=null==g?void 0:g.getBoundingClientRect();if(!j||!_)return;let k=nv(r,j),M=!1,C=null,A=!1,z=null,B=function(e){let{nodes:t,nodeId:n,handleId:r,handleType:a}=e;return t.reduce((e,t)=>{if(t[ng]){let{handleBounds:o}=t[ng],i=[],l=[];o&&(i=nG(t,o,"source","".concat(n,"-").concat(r,"-").concat(a)),l=nG(t,o,"target","".concat(n,"-").concat(r,"-").concat(a))),e.push(...i,...l)}return e},[])}({nodes:b(),nodeId:o,handleId:a,handleType:_}),I=()=>{if(!p)return;let[e,t]=nl(k,j);v({x:e,y:t}),N=requestAnimationFrame(I)};function R(e){var r,i;let d,{transform:h}=s();k=nv(e,j);let{handle:g,validHandleResult:p}=function(e,t,n,r,a,o){let{x:i,y:l}=nv(e),s=t.elementsFromPoint(i,l).find(e=>e.classList.contains("react-flow__handle"));if(s){let e=s.getAttribute("data-nodeid");if(e){let t=n0(void 0,s),r=s.getAttribute("data-handleid"),i=o({nodeId:e,id:r,type:t});if(i){let o=a.find(n=>n.nodeId===e&&n.type===t&&n.id===r);return{handle:{id:r,type:t,nodeId:e,x:(null==o?void 0:o.x)||n.x,y:(null==o?void 0:o.y)||n.y},validHandleResult:i}}}}let c=[],u=1/0;if(a.forEach(e=>{let t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=r){let n=o(e);t<=u&&(t<u?c=[{handle:e,validHandleResult:n}]:t===u&&c.push({handle:e,validHandleResult:n}),u=t)}}),!c.length)return{handle:null,validHandleResult:nQ()};if(1===c.length)return c[0];let d=c.some(e=>{let{validHandleResult:t}=e;return t.isValid}),h=c.some(e=>{let{handle:t}=e;return"target"===t.type});return c.find(e=>{let{handle:t,validHandleResult:n}=e;return h?"target"===t.type:!d||n.isValid})||c[0]}(e,f,nF(k,h,!1,[1,1]),y,B,e=>nJ(e,m,o,a,l?"target":"source",u,f));if(t=g,M||(I(),M=!0),z=p.handleDomNode,C=p.connection,A=p.isValid,c({connectionPosition:t&&A?nq({x:t.x,y:t.y},h):k,connectionStatus:(r=!!t,d=null,(i=A)?d="valid":r&&!i&&(d="invalid"),d),connectionEndHandle:p.endHandle}),!t&&!A&&!z)return n1(n);C.source!==C.target&&z&&(n1(n),n=z,z.classList.add("connecting","react-flow__handle-connecting"),z.classList.toggle("valid",A),z.classList.toggle("react-flow__handle-valid",A))}function P(e){var r,a;(t||z)&&C&&A&&(null==i||i(C)),null==(r=(a=s()).onConnectEnd)||r.call(a,e),d&&(null==h||h(e)),n1(n),w(),cancelAnimationFrame(N),M=!1,A=!1,C=null,z=null,f.removeEventListener("mousemove",R),f.removeEventListener("mouseup",P),f.removeEventListener("touchmove",R),f.removeEventListener("touchend",P)}c({connectionPosition:k,connectionStatus:null,connectionNodeId:o,connectionHandleId:a,connectionHandleType:_,connectionStartHandle:{nodeId:o,handleId:a,type:_},connectionEndHandle:null}),null==x||x(r,{nodeId:o,handleId:a,handleType:_}),f.addEventListener("mousemove",R),f.addEventListener("mouseup",P),f.addEventListener("touchmove",R),f.addEventListener("touchend",P)}let n3=()=>!0,n5=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),n4=(0,u.forwardRef)((e,t)=>{let{type:n="source",position:r=l.Top,isValidConnection:a,isConnectable:o=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:c,onConnect:d,children:f,className:m,onMouseDown:g,onTouchStart:p,...y}=e,x=c||null,v="target"===n,b=t8(),N=(0,u.useContext)(nO),{connectOnClick:S,noPanClassName:E}=t7(n5,w),{connecting:_,clickConnecting:j}=t7(((e,t,n)=>r=>{let{connectionStartHandle:a,connectionEndHandle:o,connectionClickStartHandle:i}=r;return{connecting:(null==a?void 0:a.nodeId)===e&&(null==a?void 0:a.handleId)===t&&(null==a?void 0:a.type)===n||(null==o?void 0:o.nodeId)===e&&(null==o?void 0:o.handleId)===t&&(null==o?void 0:o.type)===n,clickConnecting:(null==i?void 0:i.nodeId)===e&&(null==i?void 0:i.handleId)===t&&(null==i?void 0:i.type)===n}})(N,x,n),w);if(!N){var k,M;null==(k=(M=b.getState()).onError)||k.call(M,"010",t4.error010())}let C=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=b.getState(),a={...t,...e};if(r){let{edges:e,setEdges:t}=b.getState();t(nH(a,e))}null==n||n(a),null==d||d(a)},A=e=>{if(!N)return;let t="clientX"in e;i&&(t&&0===e.button||!t)&&n2({event:e,handleId:x,nodeId:N,onConnect:C,isTarget:v,getState:b.getState,setState:b.setState,isValidConnection:a||b.getState().isValidConnection||n3}),t?null==g||g(e):null==p||p(e)};return u.default.createElement("div",{"data-handleid":x,"data-nodeid":N,"data-handlepos":r,"data-id":"".concat(N,"-").concat(x,"-").concat(n),className:h(["react-flow__handle","react-flow__handle-".concat(r),"nodrag",E,m,{source:!v,target:v,connectable:o,connectablestart:i,connectableend:s,connecting:j,connectionindicator:o&&(i&&!_||s&&_)}]),onMouseDown:A,onTouchStart:A,onClick:S?e=>{let{onClickConnectStart:t,onClickConnectEnd:r,connectionClickStartHandle:o,connectionMode:l,isValidConnection:s}=b.getState();if(!N||!o&&!i)return;if(!o){null==t||t(e,{nodeId:N,handleId:x,handleType:n}),b.setState({connectionClickStartHandle:{nodeId:N,type:n,handleId:x}});return}let c=ns(e.target),u=a||s||n3,{connection:d,isValid:h}=nJ({nodeId:N,id:x,type:n},l,o.nodeId,o.handleId||null,o.type,u,c);h&&C(d),null==r||r(e),b.setState({connectionClickStartHandle:null})}:void 0,ref:t,...y},f)});n4.displayName="Handle";var n6=(0,u.memo)(n4);let n7=e=>{let{data:t,isConnectable:n,targetPosition:r=l.Top,sourcePosition:a=l.Bottom}=e;return u.default.createElement(u.default.Fragment,null,u.default.createElement(n6,{type:"target",position:r,isConnectable:n}),null==t?void 0:t.label,u.default.createElement(n6,{type:"source",position:a,isConnectable:n}))};n7.displayName="DefaultNode";var n8=(0,u.memo)(n7);let n9=e=>{let{data:t,isConnectable:n,sourcePosition:r=l.Bottom}=e;return u.default.createElement(u.default.Fragment,null,null==t?void 0:t.label,u.default.createElement(n6,{type:"source",position:r,isConnectable:n}))};n9.displayName="InputNode";var re=(0,u.memo)(n9);let rt=e=>{let{data:t,isConnectable:n,targetPosition:r=l.Top}=e;return u.default.createElement(u.default.Fragment,null,u.default.createElement(n6,{type:"target",position:r,isConnectable:n}),null==t?void 0:t.label)};rt.displayName="OutputNode";var rn=(0,u.memo)(rt);let rr=()=>null;rr.displayName="GroupNode";let ra=e=>({selectedNodes:e.getNodes().filter(e=>e.selected),selectedEdges:e.edges.filter(e=>e.selected).map(e=>({...e}))}),ro=e=>e.id;function ri(e,t){return w(e.selectedNodes.map(ro),t.selectedNodes.map(ro))&&w(e.selectedEdges.map(ro),t.selectedEdges.map(ro))}let rl=(0,u.memo)(e=>{let{onSelectionChange:t}=e,n=t8(),{selectedNodes:r,selectedEdges:a}=t7(ra,ri);return(0,u.useEffect)(()=>{let e={nodes:r,edges:a};null==t||t(e),n.getState().onSelectionChange.forEach(t=>t(e))},[r,a,t]),null});rl.displayName="SelectionListener";let rs=e=>!!e.onSelectionChange;function rc(e){let{onSelectionChange:t}=e,n=t7(rs);return t||n?u.default.createElement(rl,{onSelectionChange:t}):null}let ru=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function rd(e,t){(0,u.useEffect)(()=>{void 0!==e&&t(e)},[e])}function rh(e,t,n){(0,u.useEffect)(()=>{void 0!==t&&n({[e]:t})},[t])}let rf=e=>{let{nodes:t,edges:n,defaultNodes:r,defaultEdges:a,onConnect:o,onConnectStart:i,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:h,nodesFocusable:f,edgesFocusable:m,edgesUpdatable:g,elevateNodesOnSelect:p,minZoom:y,maxZoom:x,nodeExtent:v,onNodesChange:b,onEdgesChange:N,elementsSelectable:S,connectionMode:E,snapGrid:_,snapToGrid:j,translateExtent:k,connectOnClick:M,defaultEdgeOptions:C,fitView:A,fitViewOptions:z,onNodesDelete:B,onEdgesDelete:I,onNodeDrag:R,onNodeDragStart:P,onNodeDragStop:T,onSelectionDrag:D,onSelectionDragStart:O,onSelectionDragStop:L,noPanClassName:V,nodeOrigin:H,rfId:F,autoPanOnConnect:q,autoPanOnNodeDrag:X,onError:K,connectionRadius:W,isValidConnection:Y,nodeDragThreshold:Z}=e,{setNodes:U,setEdges:G,setDefaultNodesAndEdges:$,setMinZoom:Q,setMaxZoom:J,setTranslateExtent:ee,setNodeExtent:et,reset:en}=t7(ru,w),er=t8();return(0,u.useEffect)(()=>($(r,null==a?void 0:a.map(e=>({...e,...C}))),()=>{en()}),[]),rh("defaultEdgeOptions",C,er.setState),rh("connectionMode",E,er.setState),rh("onConnect",o,er.setState),rh("onConnectStart",i,er.setState),rh("onConnectEnd",l,er.setState),rh("onClickConnectStart",s,er.setState),rh("onClickConnectEnd",c,er.setState),rh("nodesDraggable",d,er.setState),rh("nodesConnectable",h,er.setState),rh("nodesFocusable",f,er.setState),rh("edgesFocusable",m,er.setState),rh("edgesUpdatable",g,er.setState),rh("elementsSelectable",S,er.setState),rh("elevateNodesOnSelect",p,er.setState),rh("snapToGrid",j,er.setState),rh("snapGrid",_,er.setState),rh("onNodesChange",b,er.setState),rh("onEdgesChange",N,er.setState),rh("connectOnClick",M,er.setState),rh("fitViewOnInit",A,er.setState),rh("fitViewOnInitOptions",z,er.setState),rh("onNodesDelete",B,er.setState),rh("onEdgesDelete",I,er.setState),rh("onNodeDrag",R,er.setState),rh("onNodeDragStart",P,er.setState),rh("onNodeDragStop",T,er.setState),rh("onSelectionDrag",D,er.setState),rh("onSelectionDragStart",O,er.setState),rh("onSelectionDragStop",L,er.setState),rh("noPanClassName",V,er.setState),rh("nodeOrigin",H,er.setState),rh("rfId",F,er.setState),rh("autoPanOnConnect",q,er.setState),rh("autoPanOnNodeDrag",X,er.setState),rh("onError",K,er.setState),rh("connectionRadius",W,er.setState),rh("isValidConnection",Y,er.setState),rh("nodeDragThreshold",Z,er.setState),rd(t,U),rd(n,G),rd(y,Q),rd(x,J),rd(k,ee),rd(v,et),null},rm={display:"none"},rg={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},rp="react-flow__node-desc",ry="react-flow__edge-desc",rx=e=>e.ariaLiveMessage;function rv(e){let{rfId:t}=e,n=t7(rx);return u.default.createElement("div",{id:"".concat("react-flow__aria-live","-").concat(t),"aria-live":"assertive","aria-atomic":"true",style:rg},n)}function rb(e){let{rfId:t,disableKeyboardA11y:n}=e;return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{id:"".concat(rp,"-").concat(t),style:rm},"Press enter or space to select a node.",!n&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),u.default.createElement("div",{id:"".concat(ry,"-").concat(t),style:rm},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!n&&u.default.createElement(rv,{rfId:t}))}var rw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{actInsideInputWithModifier:!0},[n,r]=(0,u.useState)(!1),a=(0,u.useRef)(!1),o=(0,u.useRef)(new Set([])),[i,l]=(0,u.useMemo)(()=>{if(null!==e){let t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.split("+")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,u.useEffect)(()=>{let n="undefined"!=typeof document?document:null,s=(null==t?void 0:t.target)||n;if(null!==e){let e=e=>{if(a.current=e.ctrlKey||e.metaKey||e.shiftKey,(!a.current||a.current&&!t.actInsideInputWithModifier)&&nx(e))return!1;let n=rS(e.code,l);o.current.add(e[n]),rN(i,o.current,!1)&&(e.preventDefault(),r(!0))},n=e=>{if((!a.current||a.current&&!t.actInsideInputWithModifier)&&nx(e))return!1;let n=rS(e.code,l);rN(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(e[n]),"Meta"===e.key&&o.current.clear(),a.current=!1},c=()=>{o.current.clear(),r(!1)};return null==s||s.addEventListener("keydown",e),null==s||s.addEventListener("keyup",n),window.addEventListener("blur",c),()=>{null==s||s.removeEventListener("keydown",e),null==s||s.removeEventListener("keyup",n),window.removeEventListener("blur",c)}}},[e,r]),n};function rN(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function rS(e,t){return t.includes(e)?"code":"key"}function rE(e,t,n){e.forEach(r=>{let a=r.parentNode||r.parentId;if(a&&!e.has(a))throw Error("Parent node ".concat(a," not found"));if(a||(null==n?void 0:n[r.id])){var o,i;let{x:a,y:l,z:s}=function e(t,n,r,a){var o,i,l,s,c,u,d,h;let f=t.parentNode||t.parentId;if(!f)return r;let m=n.get(f),g=nX(m,a);return e(m,n,{x:(null!=(l=r.x)?l:0)+g.x,y:(null!=(s=r.y)?s:0)+g.y,z:(null!=(c=null==(o=m[ng])?void 0:o.z)?c:0)>(null!=(u=r.z)?u:0)?null!=(d=null==(i=m[ng])?void 0:i.z)?d:0:null!=(h=r.z)?h:0},a)}(r,e,{...r.position,z:null!=(i=null==(o=r[ng])?void 0:o.z)?i:0},t);r.positionAbsolute={x:a,y:l},r[ng].z=s,(null==n?void 0:n[r.id])&&(r[ng].isParent=!0)}})}function r_(e,t,n,r){let a=new Map,o={},i=1e3*!!r;return e.forEach(e=>{var n;let r=(nm(e.zIndex)?e.zIndex:0)+(e.selected?i:0),l=t.get(e.id),s={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},c=e.parentNode||e.parentId;c&&(o[c]=!0),Object.defineProperty(s,ng,{enumerable:!1,value:{handleBounds:(null==l?void 0:l.type)&&(null==l?void 0:l.type)!==e.type||null==l||null==(n=l[ng])?void 0:n.handleBounds,z:r}}),a.set(e.id,s)}),rE(a,n,o),a}function rj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{getNodes:n,width:r,height:a,minZoom:o,maxZoom:i,d3Zoom:l,d3Selection:s,fitViewOnInitDone:c,fitViewOnInit:u,nodeOrigin:d}=e(),h=t.initial&&!c&&u;if(l&&s&&(h||!t.initial)){let e=n().filter(e=>{var n;let r=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return(null==(n=t.nodes)?void 0:n.length)?r&&t.nodes.some(t=>t.id===e.id):r}),c=e.every(e=>e.width&&e.height);if(e.length>0&&c){var f,m,g;let{x:n,y:c,zoom:u}=nZ(nK(e,d),r,a,null!=(f=t.minZoom)?f:o,null!=(m=t.maxZoom)?m:i,null!=(g=t.padding)?g:.1),h=tH.translate(n,c).scale(u);return"number"==typeof t.duration&&t.duration>0?l.transform(nU(s,t.duration),h):l.transform(s,h),!0}}return!1}function rk(e){let{changedNodes:t,changedEdges:n,get:r,set:a}=e,{nodeInternals:o,edges:i,onNodesChange:l,onEdgesChange:s,hasDefaultNodes:c,hasDefaultEdges:u}=r();(null==t?void 0:t.length)&&(c&&a({nodeInternals:(t.forEach(e=>{let t=o.get(e.id);t&&o.set(t.id,{...t,[ng]:t[ng],selected:e.selected})}),new Map(o))}),null==l||l(t)),(null==n?void 0:n.length)&&(u&&a({edges:i.map(e=>{let t=n.find(t=>t.id===e.id);return t&&(e.selected=t.selected),e})}),null==s||s(n))}let rM=()=>{},rC={zoomIn:rM,zoomOut:rM,zoomTo:rM,getZoom:()=>1,setViewport:rM,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:rM,fitBounds:rM,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},rA=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection});function rz(){let e=(()=>{let e=t8(),{d3Zoom:t,d3Selection:n}=t7(rA,w);return(0,u.useMemo)(()=>n&&t?{zoomIn:e=>t.scaleBy(nU(n,null==e?void 0:e.duration),1.2),zoomOut:e=>t.scaleBy(nU(n,null==e?void 0:e.duration),1/1.2),zoomTo:(e,r)=>t.scaleTo(nU(n,null==r?void 0:r.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(r,a)=>{var o,i,l;let[s,c,u]=e.getState().transform,d=tH.translate(null!=(o=r.x)?o:s,null!=(i=r.y)?i:c).scale(null!=(l=r.zoom)?l:u);t.transform(nU(n,null==a?void 0:a.duration),d)},getViewport:()=>{let[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>rj(e.getState,t),setCenter:(r,a,o)=>{let{width:i,height:l,maxZoom:s}=e.getState(),c=void 0!==(null==o?void 0:o.zoom)?o.zoom:s,u=i/2-r*c,d=l/2-a*c,h=tH.translate(u,d).scale(c);t.transform(nU(n,null==o?void 0:o.duration),h)},fitBounds:(r,a)=>{var o;let{width:i,height:l,minZoom:s,maxZoom:c}=e.getState(),{x:u,y:d,zoom:h}=nZ(r,i,l,s,c,null!=(o=null==a?void 0:a.padding)?o:.1),f=tH.translate(u,d).scale(h);t.transform(nU(n,null==a?void 0:a.duration),f)},project:t=>{let{transform:n,snapToGrid:r,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),nF(t,n,r,a)},screenToFlowPosition:t=>{let{transform:n,snapToGrid:r,snapGrid:a,domNode:o}=e.getState();if(!o)return t;let{x:i,y:l}=o.getBoundingClientRect();return nF({x:t.x-i,y:t.y-l},n,r,a)},flowToScreenPosition:t=>{let{transform:n,domNode:r}=e.getState();if(!r)return t;let{x:a,y:o}=r.getBoundingClientRect(),i=nq(t,n);return{x:i.x+a,y:i.y+o}},viewportInitialized:!0}:rC,[t,n])})(),t=t8(),n=(0,u.useCallback)(()=>t.getState().getNodes().map(e=>({...e})),[]),r=(0,u.useCallback)(e=>t.getState().nodeInternals.get(e),[]),a=(0,u.useCallback)(()=>{let{edges:e=[]}=t.getState();return e.map(e=>({...e}))},[]),o=(0,u.useCallback)(e=>{let{edges:n=[]}=t.getState();return n.find(t=>t.id===e)},[]),i=(0,u.useCallback)(e=>{let{getNodes:n,setNodes:r,hasDefaultNodes:a,onNodesChange:o}=t.getState(),i=n(),l="function"==typeof e?e(i):e;a?r(l):o&&o(0===l.length?i.map(e=>({type:"remove",id:e.id})):l.map(e=>({item:e,type:"reset"})))},[]),l=(0,u.useCallback)(e=>{let{edges:n=[],setEdges:r,hasDefaultEdges:a,onEdgesChange:o}=t.getState(),i="function"==typeof e?e(n):e;a?r(i):o&&o(0===i.length?n.map(e=>({type:"remove",id:e.id})):i.map(e=>({item:e,type:"reset"})))},[]),s=(0,u.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{getNodes:r,setNodes:a,hasDefaultNodes:o,onNodesChange:i}=t.getState();o?a([...r(),...n]):i&&i(n.map(e=>({item:e,type:"add"})))},[]),c=(0,u.useCallback)(e=>{let n=Array.isArray(e)?e:[e],{edges:r=[],setEdges:a,hasDefaultEdges:o,onEdgesChange:i}=t.getState();o?a([...r,...n]):i&&i(n.map(e=>({item:e,type:"add"})))},[]),d=(0,u.useCallback)(()=>{let{getNodes:e,edges:n=[],transform:r}=t.getState(),[a,o,i]=r;return{nodes:e().map(e=>({...e})),edges:n.map(e=>({...e})),viewport:{x:a,y:o,zoom:i}}},[]),h=(0,u.useCallback)(e=>{let{nodes:n,edges:r}=e,{nodeInternals:a,getNodes:o,edges:i,hasDefaultNodes:l,hasDefaultEdges:s,onNodesDelete:c,onEdgesDelete:u,onNodesChange:d,onEdgesChange:h}=t.getState(),f=(n||[]).map(e=>e.id),m=(r||[]).map(e=>e.id),g=o().reduce((e,t)=>{let n=t.parentNode||t.parentId,r=!f.includes(t.id)&&n&&e.find(e=>e.id===n);return("boolean"!=typeof t.deletable||t.deletable)&&(f.includes(t.id)||r)&&e.push(t),e},[]),p=i.filter(e=>"boolean"!=typeof e.deletable||e.deletable),y=p.filter(e=>m.includes(e.id));if(g||y){let e=[...y,...nY(g,p)],n=e.reduce((e,t)=>(e.includes(t.id)||e.push(t.id),e),[]);(s||l)&&(s&&t.setState({edges:i.filter(e=>!n.includes(e.id))}),l&&(g.forEach(e=>{a.delete(e.id)}),t.setState({nodeInternals:new Map(a)}))),n.length>0&&(null==u||u(e),h&&h(n.map(e=>({id:e,type:"remove"})))),g.length>0&&(null==c||c(g),d&&d(g.map(e=>({id:e.id,type:"remove"}))))}},[]),f=(0,u.useCallback)(e=>{let n=nm(e.width)&&nm(e.height)&&nm(e.x)&&nm(e.y),r=n?null:t.getState().nodeInternals.get(e.id);return n||r?[n?e:nh(r),r,n]:[null,null,n]},[]),m=(0,u.useCallback)(function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2?arguments[2]:void 0,[a,o,i]=f(e);return a?(r||t.getState().getNodes()).filter(e=>{if(!i&&(e.id===o.id||!e.positionAbsolute))return!1;let t=nf(nh(e),a);return n&&t>0||t>=a.width*a.height}):[]},[]),g=(0,u.useCallback)(function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[r]=f(e);if(!r)return!1;let a=nf(r,t);return n&&a>0||a>=r.width*r.height},[]);return(0,u.useMemo)(()=>({...e,getNodes:n,getNode:r,getEdges:a,getEdge:o,setNodes:i,setEdges:l,addNodes:s,addEdges:c,toObject:d,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:g}),[e,n,r,a,o,i,l,s,c,d,h,m,g])}let rB={actInsideInputWithModifier:!1},rI={position:"absolute",width:"100%",height:"100%",top:0,left:0},rR=e=>({x:e.x,y:e.y,zoom:e.k}),rP=(e,t)=>e.target.closest(".".concat(t)),rT=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),rD=e=>{let t=e.ctrlKey&&nb()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},rO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),rL=e=>{let{onMove:t,onMoveStart:n,onMoveEnd:a,onPaneContextMenu:o,zoomOnScroll:i=!0,zoomOnPinch:l=!0,panOnScroll:s=!1,panOnScrollSpeed:c=.5,panOnScrollMode:d=r.Free,zoomOnDoubleClick:h=!0,elementsSelectable:f,panOnDrag:m=!0,defaultViewport:g,translateExtent:p,minZoom:y,maxZoom:x,zoomActivationKeyCode:v,preventScrolling:b=!0,children:N,noWheelClassName:S,noPanClassName:E}=e,_=(0,u.useRef)(),j=t8(),k=(0,u.useRef)(!1),M=(0,u.useRef)(!1),C=(0,u.useRef)(null),A=(0,u.useRef)({x:0,y:0,zoom:0}),{d3Zoom:z,d3Selection:B,d3ZoomHandler:I,userSelectionActive:R}=t7(rO,w),P=rw(v),T=(0,u.useRef)(0),D=(0,u.useRef)(!1),O=(0,u.useRef)();return!function(e){let t=t8();(0,u.useEffect)(()=>{let n,r=()=>{if(!e.current)return;let n=nr(e.current);if(0===n.height||0===n.width){var r,a;null==(r=(a=t.getState()).onError)||r.call(a,"004",t4.error004())}t.setState({width:n.width||500,height:n.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r())).observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}(C),(0,u.useEffect)(()=>{if(C.current){let e=C.current.getBoundingClientRect(),t=tG().scaleExtent([y,x]).translateExtent(p),n=ef(C.current).call(t),r=tH.translate(g.x,g.y).scale(na(g.zoom,y,x)),a=[[0,0],[e.width,e.height]],o=t.constrain()(r,a,p);t.transform(n,o),t.wheelDelta(rD),j.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[o.x,o.y,o.k],domNode:C.current.closest(".react-flow")})}},[]),(0,u.useEffect)(()=>{B&&z&&(!s||P||R?void 0!==I&&B.on("wheel.zoom",function(e,t){if(!b&&"wheel"===e.type&&!e.ctrlKey||rP(e,S))return null;e.preventDefault(),I.call(this,e,t)},{passive:!1}):B.on("wheel.zoom",e=>{if(rP(e,S))return!1;e.preventDefault(),e.stopImmediatePropagation();let o=B.property("__zoom").k||1;if(e.ctrlKey&&l){let t=eN(e),n=o*Math.pow(2,rD(e));z.scaleTo(B,n,t,e);return}let i=1===e.deltaMode?20:1,s=d===r.Vertical?0:e.deltaX*i,u=d===r.Horizontal?0:e.deltaY*i;!nb()&&e.shiftKey&&d!==r.Vertical&&(s=e.deltaY*i,u=0),z.translateBy(B,-(s/o)*c,-(u/o)*c,{internal:!0});let h=rR(B.property("__zoom")),{onViewportChangeStart:f,onViewportChange:m,onViewportChangeEnd:g}=j.getState();clearTimeout(O.current),D.current||(D.current=!0,null==n||n(e,h),null==f||f(h)),D.current&&(null==t||t(e,h),null==m||m(h),O.current=setTimeout(()=>{null==a||a(e,h),null==g||g(h),D.current=!1},150))},{passive:!1}))},[R,s,d,B,z,I,P,l,b,S,n,t,a]),(0,u.useEffect)(()=>{z&&z.on("start",e=>{var t,r;if(!e.sourceEvent||e.sourceEvent.internal)return null;T.current=null==(t=e.sourceEvent)?void 0:t.button;let{onViewportChangeStart:a}=j.getState(),o=rR(e.transform);k.current=!0,A.current=o,(null==(r=e.sourceEvent)?void 0:r.type)==="mousedown"&&j.setState({paneDragging:!0}),null==a||a(o),null==n||n(e.sourceEvent,o)})},[z,n]),(0,u.useEffect)(()=>{z&&(R&&!k.current?z.on("zoom",null):R||z.on("zoom",e=>{var n,r;let{onViewportChange:a}=j.getState();if(j.setState({transform:[e.transform.x,e.transform.y,e.transform.k]}),M.current=!!(o&&rT(m,null!=(r=T.current)?r:0)),(t||a)&&!(null==(n=e.sourceEvent)?void 0:n.internal)){let n=rR(e.transform);null==a||a(n),null==t||t(e.sourceEvent,n)}}))},[R,z,t,m,o]),(0,u.useEffect)(()=>{z&&z.on("end",e=>{var t;if(!e.sourceEvent||e.sourceEvent.internal)return null;let{onViewportChangeEnd:n}=j.getState();if(k.current=!1,j.setState({paneDragging:!1}),o&&rT(m,null!=(t=T.current)?t:0)&&!M.current&&o(e.sourceEvent),M.current=!1,(a||n)&&((e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k)(A.current,e.transform)){let t=rR(e.transform);A.current=t,clearTimeout(_.current),_.current=setTimeout(()=>{null==n||n(t),null==a||a(e.sourceEvent,t)},150*!!s)}})},[z,s,m,a,o]),(0,u.useEffect)(()=>{z&&z.filter(e=>{let t=P||i,n=l&&e.ctrlKey;if((!0===m||Array.isArray(m)&&m.includes(1))&&1===e.button&&"mousedown"===e.type&&(rP(e,"react-flow__node")||rP(e,"react-flow__edge")))return!0;if(!m&&!t&&!s&&!h&&!l||R||!h&&"dblclick"===e.type||rP(e,S)&&"wheel"===e.type||rP(e,E)&&("wheel"!==e.type||s&&"wheel"===e.type&&!P)||!l&&e.ctrlKey&&"wheel"===e.type||!t&&!s&&!n&&"wheel"===e.type||!m&&("mousedown"===e.type||"touchstart"===e.type)||Array.isArray(m)&&!m.includes(e.button)&&"mousedown"===e.type)return!1;let r=Array.isArray(m)&&m.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&r})},[R,z,i,l,s,h,m,f,P]),u.default.createElement("div",{className:"react-flow__renderer",ref:C,style:rI},N)},rV=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function rH(){let{userSelectionActive:e,userSelectionRect:t}=t7(rV,w);return e&&t?u.default.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}}):null}function rF(e,t){let n=t.parentNode||t.parentId,r=e.find(e=>e.id===n);if(r){let e=t.position.x+t.width-r.width,n=t.position.y+t.height-r.height;if(e>0||n>0||t.position.x<0||t.position.y<0){var a,o;if(r.style={...r.style},r.style.width=null!=(a=r.style.width)?a:r.width,r.style.height=null!=(o=r.style.height)?o:r.height,e>0&&(r.style.width+=e),n>0&&(r.style.height+=n),t.position.x<0){let e=Math.abs(t.position.x);r.position.x=r.position.x-e,r.style.width+=e,t.position.x=0}if(t.position.y<0){let e=Math.abs(t.position.y);r.position.y=r.position.y-e,r.style.height+=e,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function rq(e,t){if(e.some(e=>"reset"===e.type))return e.filter(e=>"reset"===e.type).map(e=>e.item);let n=e.filter(e=>"add"===e.type).map(e=>e.item);return t.reduce((t,n)=>{let r=e.filter(e=>e.id===n.id);if(0===r.length)return t.push(n),t;let a={...n};for(let e of r)if(e)switch(e.type){case"select":a.selected=e.selected;break;case"position":void 0!==e.position&&(a.position=e.position),void 0!==e.positionAbsolute&&(a.positionAbsolute=e.positionAbsolute),void 0!==e.dragging&&(a.dragging=e.dragging),a.expandParent&&rF(t,a);break;case"dimensions":void 0!==e.dimensions&&(a.width=e.dimensions.width,a.height=e.dimensions.height),void 0!==e.updateStyle&&(a.style={...a.style||{},...e.dimensions}),"boolean"==typeof e.resizing&&(a.resizing=e.resizing),a.expandParent&&rF(t,a);break;case"remove":return t}return t.push(a),t},n)}function rX(e,t){return rq(e,t)}let rK=(e,t)=>({id:e,type:"select",selected:t});function rW(e,t){return e.reduce((e,n)=>{let r=t.includes(n.id);return!n.selected&&r?(n.selected=!0,e.push(rK(n.id,!0))):n.selected&&!r&&(n.selected=!1,e.push(rK(n.id,!1))),e},[])}let rY=(e,t)=>n=>{n.target===t.current&&(null==e||e(n))},rZ=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),rU=(0,u.memo)(e=>{let{isSelecting:t,selectionMode:n=a.Full,panOnDrag:r,onSelectionStart:o,onSelectionEnd:i,onPaneClick:l,onPaneContextMenu:s,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:m,children:g}=e,p=(0,u.useRef)(null),y=t8(),x=(0,u.useRef)(0),v=(0,u.useRef)(0),b=(0,u.useRef)(),{userSelectionActive:N,elementsSelectable:S,dragging:E}=t7(rZ,w),_=()=>{y.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,v.current=0},j=e=>{null==l||l(e),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},k=S&&(t||N);return u.default.createElement("div",{className:h(["react-flow__pane",{dragging:E,selection:t}]),onClick:k?void 0:rY(j,p),onContextMenu:rY(e=>{if(Array.isArray(r)&&(null==r?void 0:r.includes(2)))return void e.preventDefault();null==s||s(e)},p),onWheel:rY(c?e=>c(e):void 0,p),onMouseEnter:k?void 0:d,onMouseDown:k?e=>{let{resetSelectedElements:n,domNode:r}=y.getState();if(b.current=null==r?void 0:r.getBoundingClientRect(),!S||!t||0!==e.button||e.target!==p.current||!b.current)return;let{x:a,y:i}=nv(e,b.current);n(),y.setState({userSelectionRect:{width:0,height:0,startX:a,startY:i,x:a,y:i}}),null==o||o(e)}:void 0,onMouseMove:k?e=>{var r,o;let{userSelectionRect:i,nodeInternals:l,edges:s,transform:c,onNodesChange:u,onEdgesChange:d,nodeOrigin:h,getNodes:f}=y.getState();if(!t||!b.current||!i)return;y.setState({userSelectionActive:!0,nodesSelectionActive:!1});let m=nv(e,b.current),g=null!=(r=i.startX)?r:0,p=null!=(o=i.startY)?o:0,w={...i,x:m.x<g?m.x:g,y:m.y<p?m.y:p,width:Math.abs(m.x-g),height:Math.abs(m.y-p)},N=f(),S=nW(l,w,c,n===a.Partial,!0,h),E=nY(S,s).map(e=>e.id),_=S.map(e=>e.id);if(x.current!==_.length){x.current=_.length;let e=rW(N,_);e.length&&(null==u||u(e))}if(v.current!==E.length){v.current=E.length;let e=rW(s,E);e.length&&(null==d||d(e))}y.setState({userSelectionRect:w})}:f,onMouseUp:k?e=>{if(0!==e.button)return;let{userSelectionRect:t}=y.getState();!N&&t&&e.target===p.current&&(null==j||j(e)),y.setState({nodesSelectionActive:x.current>0}),_(),null==i||i(e)}:void 0,onMouseLeave:k?e=>{N&&(y.setState({nodesSelectionActive:x.current>0}),null==i||i(e)),_()}:m,ref:p,style:rI},g,u.default.createElement(rH,null))});function rG(e,t,n){let r=e;do{if(null==r?void 0:r.matches(t))return!0;if(r===n.current)break;r=r.parentElement}while(r)return!1}function r$(e,t,n,r){var a;let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],i=arguments.length>5?arguments[5]:void 0,l=(a=e.extent||r)&&"parent"!==a?[a[0],[a[1][0]-(e.width||0),a[1][1]-(e.height||0)]]:a,s=l,c=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&c&&"parent"!==e.extent){let{x:t,y:r}=nX(n.get(c),o).positionAbsolute;s=[[e.extent[0][0]+t,e.extent[0][1]+r],[e.extent[1][0]+t,e.extent[1][1]+r]]}}else if(c&&e.width&&e.height){let t=n.get(c),{x:r,y:a}=nX(t,o).positionAbsolute;s=t&&nm(r)&&nm(a)&&nm(t.width)&&nm(t.height)?[[r+e.width*o[0],a+e.height*o[1]],[r+t.width-e.width+e.width*o[0],a+t.height-e.height+e.height*o[1]]]:s}else null==i||i("005",t4.error005()),s=l;let u={x:0,y:0};c&&(u=nX(n.get(c),o).positionAbsolute);let d=s&&"parent"!==s?no(t,s):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function rQ(e){let{nodeId:t,dragItems:n,nodeInternals:r}=e,a=n.map(e=>({...r.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute}));return[t?a.find(e=>e.id===t):a[0],a]}rU.displayName="Pane";let rJ=(e,t,n,r)=>{let a=t.querySelectorAll(e);if(!a||!a.length)return null;let o=Array.from(a),i=t.getBoundingClientRect(),l={x:i.width*r[0],y:i.height*r[1]};return o.map(e=>{let t=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-i.left-l.x)/n,y:(t.top-i.top-l.y)/n,...nr(e)}})};function r0(e,t,n){return void 0===n?n:r=>{let a=t().nodeInternals.get(e);a&&n(r,{...a})}}function r1(e){let{id:t,store:n,unselect:r=!1,nodeRef:a}=e,{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:l,nodeInternals:s,onError:c}=n.getState(),u=s.get(t);if(!u){null==c||c("012",t4.error012(t));return}n.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&l)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var e;return null==a||null==(e=a.current)?void 0:e.blur()})):o([t])}function r2(e){return(t,n,r)=>null==e?void 0:e(t,r)}function r3(e){let{nodeRef:t,disabled:n=!1,noDragClassName:r,handleSelector:a,nodeId:o,isSelectable:i,selectNodesOnDrag:l}=e,s=t8(),[c,d]=(0,u.useState)(!1),h=(0,u.useRef)([]),f=(0,u.useRef)({x:null,y:null}),m=(0,u.useRef)(0),g=(0,u.useRef)(null),p=(0,u.useRef)({x:0,y:0}),y=(0,u.useRef)(null),x=(0,u.useRef)(!1),v=(0,u.useRef)(!1),b=(0,u.useRef)(!1),w=function(){let e=t8();return(0,u.useCallback)(t=>{let{sourceEvent:n}=t,{transform:r,snapGrid:a,snapToGrid:o}=e.getState(),i=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,s={x:(i-r[0])/r[2],y:(l-r[1])/r[2]};return{xSnapped:o?a[0]*Math.round(s.x/a[0]):s.x,ySnapped:o?a[1]*Math.round(s.y/a[1]):s.y,...s}},[])}();return(0,u.useEffect)(()=>{if(null==t?void 0:t.current){let e=ef(t.current),c=e=>{let{x:t,y:n}=e,{nodeInternals:r,onNodeDrag:a,onSelectionDrag:i,updateNodePositions:l,nodeExtent:c,snapGrid:u,snapToGrid:m,nodeOrigin:g,onError:p}=s.getState();f.current={x:t,y:n};let x=!1,v={x:0,y:0,x2:0,y2:0};if(h.current.length>1&&c&&(v=nu(nK(h.current,g))),h.current=h.current.map(e=>{let a={x:t-e.distance.x,y:n-e.distance.y};m&&(a.x=u[0]*Math.round(a.x/u[0]),a.y=u[1]*Math.round(a.y/u[1]));let o=[[c[0][0],c[0][1]],[c[1][0],c[1][1]]];if(h.current.length>1&&c&&!e.extent){var i,l;o[0][0]=e.positionAbsolute.x-v.x+c[0][0],o[1][0]=e.positionAbsolute.x+(null!=(i=e.width)?i:0)-v.x2+c[1][0],o[0][1]=e.positionAbsolute.y-v.y+c[0][1],o[1][1]=e.positionAbsolute.y+(null!=(l=e.height)?l:0)-v.y2+c[1][1]}let s=r$(e,a,r,o,g,p);return x=x||e.position.x!==s.position.x||e.position.y!==s.position.y,e.position=s.position,e.positionAbsolute=s.positionAbsolute,e}),!x)return;l(h.current,!0,!0),d(!0);let b=o?a:r2(i);if(b&&y.current){let[e,t]=rQ({nodeId:o,dragItems:h.current,nodeInternals:r});b(y.current,e,t)}},u=()=>{if(!g.current)return;let[e,t]=nl(p.current,g.current);if(0!==e||0!==t){var n,r;let{transform:a,panBy:o}=s.getState();f.current.x=(null!=(n=f.current.x)?n:0)-e/a[2],f.current.y=(null!=(r=f.current.y)?r:0)-t/a[2],o({x:e,y:t})&&c(f.current)}m.current=requestAnimationFrame(u)},N=e=>{var n;let{nodeInternals:r,multiSelectionActive:a,nodesDraggable:c,unselectNodesAndEdges:u,onNodeDragStart:d,onSelectionDragStart:m}=s.getState();v.current=!0;let g=o?d:r2(m);(!l||!i)&&!a&&o&&((null==(n=r.get(o))?void 0:n.selected)||u()),o&&i&&l&&r1({id:o,store:s,nodeRef:t});let p=w(e);if(f.current=p,h.current=Array.from(r.values()).filter(e=>(e.selected||e.id===o)&&(!e.parentNode||e.parentId||!function e(t,n){let r=t.parentNode||t.parentId;if(!r)return!1;let a=n.get(r);return!!a&&(!!a.selected||e(a,n))}(e,r))&&(e.draggable||c&&void 0===e.draggable)).map(e=>{var t,n,r,a;return{id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:p.x-(null!=(r=null==(t=e.positionAbsolute)?void 0:t.x)?r:0),y:p.y-(null!=(a=null==(n=e.positionAbsolute)?void 0:n.y)?a:0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent}}),g&&h.current){let[t,n]=rQ({nodeId:o,dragItems:h.current,nodeInternals:r});g(e.sourceEvent,t,n)}};if(n)e.on(".drag",null);else{let n=(function(){var e,t,n,r,a=tJ,o=t0,i=t1,l=t2,s={},c=S("start","drag","end"),u=0,d=0;function h(e){e.on("mousedown.drag",f).filter(l).on("touchstart.drag",p).on("touchmove.drag",y,em).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(i,l){if(!r&&a.call(this,i,l)){var s=v(this,o.call(this,i,l),i,l,"mouse");s&&(ef(i.view).on("mousemove.drag",m,eg).on("mouseup.drag",g,eg),ex(i.view),ep(i),n=!1,e=i.clientX,t=i.clientY,s("start",i))}}function m(r){if(ey(r),!n){var a=r.clientX-e,o=r.clientY-t;n=a*a+o*o>d}s.mouse("drag",r)}function g(e){ef(e.view).on("mousemove.drag mouseup.drag",null),ev(e.view,n),ey(e),s.mouse("end",e)}function p(e,t){if(a.call(this,e,t)){var n,r,i=e.changedTouches,l=o.call(this,e,t),s=i.length;for(n=0;n<s;++n)(r=v(this,l,e,t,i[n].identifier,i[n]))&&(ep(e),r("start",e,i[n]))}}function y(e){var t,n,r=e.changedTouches,a=r.length;for(t=0;t<a;++t)(n=s[r[t].identifier])&&(ey(e),n("drag",e,r[t]))}function x(e){var t,n,a=e.changedTouches,o=a.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),t=0;t<o;++t)(n=s[a[t].identifier])&&(ep(e),n("end",e,a[t]))}function v(e,t,n,r,a,o){var l,d,f,m=c.copy(),g=eN(o||n,t);if(null!=(f=i.call(e,new tQ("beforestart",{sourceEvent:n,target:h,identifier:a,active:u,x:g[0],y:g[1],dx:0,dy:0,dispatch:m}),r)))return l=f.x-g[0]||0,d=f.y-g[1]||0,function n(o,i,c){var p,y=g;switch(o){case"start":s[a]=n,p=u++;break;case"end":delete s[a],--u;case"drag":g=eN(c||i,t),p=u}m.call(o,e,new tQ(o,{sourceEvent:i,subject:f,target:h,identifier:a,active:p,x:g[0]+l,y:g[1]+d,dx:g[0]-y[0],dy:g[1]-y[1],dispatch:m}),r)}}return h.filter=function(e){return arguments.length?(a="function"==typeof e?e:t$(!!e),h):a},h.container=function(e){return arguments.length?(o="function"==typeof e?e:t$(e),h):o},h.subject=function(e){return arguments.length?(i="function"==typeof e?e:t$(e),h):i},h.touchable=function(e){return arguments.length?(l="function"==typeof e?e:t$(!!e),h):l},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(d=(e*=1)*e,h):Math.sqrt(d)},h})().on("start",e=>{let{domNode:t,nodeDragThreshold:n}=s.getState();0===n&&N(e),b.current=!1,f.current=w(e),g.current=(null==t?void 0:t.getBoundingClientRect())||null,p.current=nv(e.sourceEvent,g.current)}).on("drag",e=>{let t=w(e),{autoPanOnNodeDrag:n,nodeDragThreshold:r}=s.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(b.current=!0),!b.current){if(!x.current&&v.current&&n&&(x.current=!0,u()),!v.current){var a,o,i,l;let n=t.xSnapped-(null!=(i=null==f||null==(a=f.current)?void 0:a.x)?i:0),s=t.ySnapped-(null!=(l=null==f||null==(o=f.current)?void 0:o.y)?l:0);Math.sqrt(n*n+s*s)>r&&N(e)}(f.current.x!==t.xSnapped||f.current.y!==t.ySnapped)&&h.current&&v.current&&(y.current=e.sourceEvent,p.current=nv(e.sourceEvent,g.current),c(t))}}).on("end",e=>{if(v.current&&!b.current&&(d(!1),x.current=!1,v.current=!1,cancelAnimationFrame(m.current),h.current)){let{updateNodePositions:t,nodeInternals:n,onNodeDragStop:r,onSelectionDragStop:a}=s.getState(),i=o?r:r2(a);if(t(h.current,!1,!1),i){let[t,r]=rQ({nodeId:o,dragItems:h.current,nodeInternals:n});i(e.sourceEvent,t,r)}}}).filter(e=>{let n=e.target;return!e.button&&(!r||!rG(n,".".concat(r),t))&&(!a||rG(n,a,t))});return e.call(n),()=>{e.on(".drag",null)}}}},[t,n,r,a,i,s,o,l,w]),c}function r5(){let e=t8();return(0,u.useCallback)(t=>{let{nodeInternals:n,nodeExtent:r,updateNodePositions:a,getNodes:o,snapToGrid:i,snapGrid:l,onError:s,nodesDraggable:c}=e.getState(),u=o().filter(e=>e.selected&&(e.draggable||c&&void 0===e.draggable)),d=i?l[0]:5,h=i?l[1]:5,f=t.isShiftPressed?4:1,m=t.x*d*f,g=t.y*h*f;a(u.map(e=>{if(e.positionAbsolute){let t={x:e.positionAbsolute.x+m,y:e.positionAbsolute.y+g};i&&(t.x=l[0]*Math.round(t.x/l[0]),t.y=l[1]*Math.round(t.y/l[1]));let{positionAbsolute:a,position:o}=r$(e,t,n,r,void 0,s);e.position=o,e.positionAbsolute=a}return e}),!0,!1)},[])}let r4={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var r6=e=>{let t=t=>{let{id:n,type:r,data:a,xPos:o,yPos:i,xPosOrigin:l,yPosOrigin:s,selected:c,onClick:d,onMouseEnter:f,onMouseMove:m,onMouseLeave:g,onContextMenu:p,onDoubleClick:y,style:x,className:v,isDraggable:b,isSelectable:w,isConnectable:N,isFocusable:S,selectNodesOnDrag:E,sourcePosition:_,targetPosition:j,hidden:k,resizeObserver:M,dragHandle:C,zIndex:A,isParent:z,noDragClassName:B,noPanClassName:I,initialized:R,disableKeyboardA11y:P,ariaLabel:T,rfId:D,hasHandleBounds:O}=t,L=t8(),V=(0,u.useRef)(null),H=(0,u.useRef)(null),F=(0,u.useRef)(_),q=(0,u.useRef)(j),X=(0,u.useRef)(r),K=w||b||d||f||m||g,W=r5(),Y=r0(n,L.getState,f),Z=r0(n,L.getState,m),U=r0(n,L.getState,g),G=r0(n,L.getState,p),$=r0(n,L.getState,y);(0,u.useEffect)(()=>()=>{H.current&&(null==M||M.unobserve(H.current),H.current=null)},[]),(0,u.useEffect)(()=>{if(V.current&&!k){let e=V.current;R&&O&&H.current===e||(H.current&&(null==M||M.unobserve(H.current)),null==M||M.observe(e),H.current=e)}},[k,R,O]),(0,u.useEffect)(()=>{let e=X.current!==r,t=F.current!==_,a=q.current!==j;V.current&&(e||t||a)&&(e&&(X.current=r),t&&(F.current=_),a&&(q.current=j),L.getState().updateNodeDimensions([{id:n,nodeElement:V.current,forceUpdate:!0}]))},[n,r,_,j]);let Q=r3({nodeRef:V,disabled:k||!b,noDragClassName:B,handleSelector:C,nodeId:n,isSelectable:w,selectNodesOnDrag:E});return k?null:u.default.createElement("div",{className:h(["react-flow__node","react-flow__node-".concat(r),{[I]:b},v,{selected:c,selectable:w,parent:z,dragging:Q}]),ref:V,style:{zIndex:A,transform:"translate(".concat(l,"px,").concat(s,"px)"),pointerEvents:K?"all":"none",visibility:R?"visible":"hidden",...x},"data-id":n,"data-testid":"rf__node-".concat(n),onMouseEnter:Y,onMouseMove:Z,onMouseLeave:U,onContextMenu:G,onClick:e=>{let{nodeDragThreshold:t}=L.getState();if(w&&(!E||!b||t>0)&&r1({id:n,store:L,nodeRef:V}),d){let t=L.getState().nodeInternals.get(n);t&&d(e,{...t})}},onDoubleClick:$,onKeyDown:S?e=>{!nx(e)&&!P&&(np.includes(e.key)&&w?r1({id:n,store:L,unselect:"Escape"===e.key,nodeRef:V}):b&&c&&Object.prototype.hasOwnProperty.call(r4,e.key)&&(L.setState({ariaLiveMessage:"Moved selected node ".concat(e.key.replace("Arrow","").toLowerCase(),". New position, x: ").concat(~~o,", y: ").concat(~~i)}),W({x:r4[e.key].x,y:r4[e.key].y,isShiftPressed:e.shiftKey})))}:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":P?void 0:"".concat(rp,"-").concat(D),"aria-label":T},u.default.createElement(nL,{value:n},u.default.createElement(e,{id:n,data:a,type:r,xPos:o,yPos:i,selected:c,isConnectable:N,sourcePosition:_,targetPosition:j,dragging:Q,dragHandle:C,zIndex:A})))};return t.displayName="NodeWrapper",(0,u.memo)(t)};let r7=e=>({...nK(e.getNodes().filter(e=>e.selected),e.nodeOrigin),transformString:"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")"),userSelectionActive:e.userSelectionActive});var r8=(0,u.memo)(function(e){let{onSelectionContextMenu:t,noPanClassName:n,disableKeyboardA11y:r}=e,a=t8(),{width:o,height:i,x:l,y:s,transformString:c,userSelectionActive:d}=t7(r7,w),f=r5(),m=(0,u.useRef)(null);if((0,u.useEffect)(()=>{if(!r){var e;null==(e=m.current)||e.focus({preventScroll:!0})}},[r]),r3({nodeRef:m}),d||!o||!i)return null;let g=t?e=>{t(e,a.getState().getNodes().filter(e=>e.selected))}:void 0;return u.default.createElement("div",{className:h(["react-flow__nodesselection","react-flow__container",n]),style:{transform:c}},u.default.createElement("div",{ref:m,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:r?void 0:-1,onKeyDown:r?void 0:e=>{Object.prototype.hasOwnProperty.call(r4,e.key)&&f({x:r4[e.key].x,y:r4[e.key].y,isShiftPressed:e.shiftKey})},style:{width:o,height:i,top:s,left:l}}))});let r9=e=>e.nodesSelectionActive,ae=e=>{let{children:t,onPaneClick:n,onPaneMouseEnter:r,onPaneMouseMove:a,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:l,deleteKeyCode:s,onMove:c,onMoveStart:d,onMoveEnd:h,selectionKeyCode:f,selectionOnDrag:m,selectionMode:g,onSelectionStart:p,onSelectionEnd:y,multiSelectionKeyCode:x,panActivationKeyCode:v,zoomActivationKeyCode:b,elementsSelectable:w,zoomOnScroll:N,zoomOnPinch:S,panOnScroll:E,panOnScrollSpeed:_,panOnScrollMode:j,zoomOnDoubleClick:k,panOnDrag:M,defaultViewport:C,translateExtent:A,minZoom:z,maxZoom:B,preventScrolling:I,onSelectionContextMenu:R,noWheelClassName:P,noPanClassName:T,disableKeyboardA11y:D}=e,O=t7(r9),L=rw(f),V=rw(v),H=V||M,F=V||E,q=L||m&&!0!==H;return(e=>{let{deleteKeyCode:t,multiSelectionKeyCode:n}=e,r=t8(),{deleteElements:a}=rz(),o=rw(t,rB),i=rw(n);(0,u.useEffect)(()=>{if(o){let{edges:e,getNodes:t}=r.getState();a({nodes:t().filter(e=>e.selected),edges:e.filter(e=>e.selected)}),r.setState({nodesSelectionActive:!1})}},[o]),(0,u.useEffect)(()=>{r.setState({multiSelectionActive:i})},[i])})({deleteKeyCode:s,multiSelectionKeyCode:x}),u.default.createElement(rL,{onMove:c,onMoveStart:d,onMoveEnd:h,onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:N,zoomOnPinch:S,panOnScroll:F,panOnScrollSpeed:_,panOnScrollMode:j,zoomOnDoubleClick:k,panOnDrag:!L&&H,defaultViewport:C,translateExtent:A,minZoom:z,maxZoom:B,zoomActivationKeyCode:b,preventScrolling:I,noWheelClassName:P,noPanClassName:T},u.default.createElement(rU,{onSelectionStart:p,onSelectionEnd:y,onPaneClick:n,onPaneMouseEnter:r,onPaneMouseMove:a,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:l,panOnDrag:H,isSelecting:!!q,selectionMode:g},t,O&&u.default.createElement(r8,{onSelectionContextMenu:R,noPanClassName:T,disableKeyboardA11y:D})))};ae.displayName="FlowRenderer";var at=(0,u.memo)(ae);function an(e){let t={input:r6(e.input||re),default:r6(e.default||n8),output:r6(e.output||rn),group:r6(e.group||rr)},n=Object.keys(e).filter(e=>!["input","default","output","group"].includes(e)).reduce((t,n)=>(t[n]=r6(e[n]||n8),t),{});return{...t,...n}}let ar=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),aa=e=>{let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,updateNodeDimensions:o,onError:i}=t7(ar,w),s=function(e){return t7((0,u.useCallback)(t=>e?nW(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}(e.onlyRenderVisibleElements),c=(0,u.useRef)(),d=(0,u.useMemo)(()=>{if("undefined"==typeof ResizeObserver)return null;let e=new ResizeObserver(e=>{o(e.map(e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0})))});return c.current=e,e},[]);return(0,u.useEffect)(()=>()=>{var e;null==c||null==(e=c.current)||e.disconnect()},[]),u.default.createElement("div",{className:"react-flow__nodes",style:rI},s.map(o=>{var s,c,h,f,m,g,p,y;let x=o.type||"default";e.nodeTypes[x]||(null==i||i("003",t4.error003(x)),x="default");let v=e.nodeTypes[x]||e.nodeTypes.default,b=!!(o.draggable||t&&void 0===o.draggable),w=!!(o.selectable||a&&void 0===o.selectable),N=!!(o.connectable||n&&void 0===o.connectable),S=!!(o.focusable||r&&void 0===o.focusable),E=e.nodeExtent?no(o.positionAbsolute,e.nodeExtent):o.positionAbsolute,_=null!=(f=null==E?void 0:E.x)?f:0,j=null!=(m=null==E?void 0:E.y)?m:0,k=(e=>{let{x:t,y:n,width:r,height:a,origin:o}=e;return!r||!a||o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:t,y:n}:{x:t-r*o[0],y:n-a*o[1]}})({x:_,y:j,width:null!=(g=o.width)?g:0,height:null!=(p=o.height)?p:0,origin:e.nodeOrigin});return u.default.createElement(v,{key:o.id,id:o.id,className:o.className,style:o.style,type:x,data:o.data,sourcePosition:o.sourcePosition||l.Bottom,targetPosition:o.targetPosition||l.Top,hidden:o.hidden,xPos:_,yPos:j,xPosOrigin:k.x,yPosOrigin:k.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!o.selected,isDraggable:b,isSelectable:w,isConnectable:N,isFocusable:S,resizeObserver:d,dragHandle:o.dragHandle,zIndex:null!=(y=null==(s=o[ng])?void 0:s.z)?y:0,isParent:!!(null==(c=o[ng])?void 0:c.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!o.width&&!!o.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:o.ariaLabel,hasHandleBounds:!!(null==(h=o[ng])?void 0:h.handleBounds)})}))};aa.displayName="NodeRenderer";var ao=(0,u.memo)(aa);let ai="react-flow__edgeupdater",al=e=>{let{position:t,centerX:n,centerY:r,radius:a=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:c}=e;return u.default.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:h([ai,"".concat(ai,"-").concat(c)]),cx:((e,t,n)=>n===l.Left?e-t:n===l.Right?e+t:e)(n,a,t),cy:((e,t,n)=>n===l.Top?e-t:n===l.Bottom?e+t:e)(r,a,t),r:a,stroke:"transparent",fill:"transparent"})},as=()=>!0;var ac=e=>{let t=t=>{let{id:n,className:r,type:a,data:o,onClick:i,onEdgeDoubleClick:l,selected:s,animated:c,label:d,labelStyle:f,labelShowBg:m,labelBgStyle:g,labelBgPadding:p,labelBgBorderRadius:y,style:x,source:v,target:b,sourceX:w,sourceY:N,targetX:S,targetY:E,sourcePosition:_,targetPosition:j,elementsSelectable:k,hidden:M,sourceHandleId:C,targetHandleId:A,onContextMenu:z,onMouseEnter:B,onMouseMove:I,onMouseLeave:R,reconnectRadius:P,onReconnect:T,onReconnectStart:D,onReconnectEnd:O,markerEnd:L,markerStart:V,rfId:H,ariaLabel:F,isFocusable:q,isReconnectable:X,pathOptions:K,interactionWidth:W,disableKeyboardA11y:Y}=t,Z=(0,u.useRef)(null),[U,G]=(0,u.useState)(!1),[$,Q]=(0,u.useState)(!1),J=t8(),ee=(0,u.useMemo)(()=>"url('#".concat(nV(V,H),"')"),[V,H]),et=(0,u.useMemo)(()=>"url('#".concat(nV(L,H),"')"),[L,H]);if(M)return null;let en=nN(n,J.getState,l),er=nN(n,J.getState,z),ea=nN(n,J.getState,B),eo=nN(n,J.getState,I),ei=nN(n,J.getState,R),el=(e,t)=>{if(0!==e.button)return;let{edges:r,isValidConnection:a}=J.getState(),o=t?b:v,i=(t?A:C)||null,l=t?"target":"source",s=r.find(e=>e.id===n);Q(!0),null==D||D(e,s,l),n2({event:e,handleId:i,nodeId:o,onConnect:e=>null==T?void 0:T(s,e),isTarget:t,getState:J.getState,setState:J.setState,isValidConnection:a||as,edgeUpdaterType:l,onReconnectEnd:e=>{Q(!1),null==O||O(e,s,l)}})},es=()=>G(!0),ec=()=>G(!1);return u.default.createElement("g",{className:h(["react-flow__edge","react-flow__edge-".concat(a),r,{selected:s,animated:c,inactive:!k&&!i,updating:U}]),onClick:e=>{let{edges:t,addSelectedEdges:r,unselectNodesAndEdges:a,multiSelectionActive:o}=J.getState(),l=t.find(e=>e.id===n);if(l){if(k)if(J.setState({nodesSelectionActive:!1}),l.selected&&o){var s;a({nodes:[],edges:[l]}),null==(s=Z.current)||s.blur()}else r([n]);i&&i(e,l)}},onDoubleClick:en,onContextMenu:er,onMouseEnter:ea,onMouseMove:eo,onMouseLeave:ei,onKeyDown:q?e=>{if(!Y&&np.includes(e.key)&&k){let{unselectNodesAndEdges:r,addSelectedEdges:a,edges:o}=J.getState();if("Escape"===e.key){var t;null==(t=Z.current)||t.blur(),r({edges:[o.find(e=>e.id===n)]})}else a([n])}}:void 0,tabIndex:q?0:void 0,role:q?"button":"img","data-testid":"rf__edge-".concat(n),"aria-label":null===F?void 0:F||"Edge from ".concat(v," to ").concat(b),"aria-describedby":q?"".concat(ry,"-").concat(H):void 0,ref:Z},!$&&u.default.createElement(e,{id:n,source:v,target:b,selected:s,animated:c,label:d,labelStyle:f,labelShowBg:m,labelBgStyle:g,labelBgPadding:p,labelBgBorderRadius:y,data:o,style:x,sourceX:w,sourceY:N,targetX:S,targetY:E,sourcePosition:_,targetPosition:j,sourceHandleId:C,targetHandleId:A,markerStart:ee,markerEnd:et,pathOptions:K,interactionWidth:W}),X&&u.default.createElement(u.default.Fragment,null,("source"===X||!0===X)&&u.default.createElement(al,{position:_,centerX:w,centerY:N,radius:P,onMouseDown:e=>el(e,!0),onMouseEnter:es,onMouseOut:ec,type:"source"}),("target"===X||!0===X)&&u.default.createElement(al,{position:j,centerX:S,centerY:E,radius:P,onMouseDown:e=>el(e,!1),onMouseEnter:es,onMouseOut:ec,type:"target"})))};return t.displayName="EdgeWrapper",(0,u.memo)(t)};function au(e){let t={default:ac(e.default||nD),straight:ac(e.bezier||nI),step:ac(e.step||nB),smoothstep:ac(e.step||nz),simplebezier:ac(e.simplebezier||nk)},n=Object.keys(e).filter(e=>!["default","bezier"].includes(e)).reduce((t,n)=>(t[n]=ac(e[n]||nD),t),{});return{...t,...n}}function ad(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=((null==n?void 0:n.x)||0)+t.x,a=((null==n?void 0:n.y)||0)+t.y,o=(null==n?void 0:n.width)||t.width,i=(null==n?void 0:n.height)||t.height;switch(e){case l.Top:return{x:r+o/2,y:a};case l.Right:return{x:r+o,y:a+i/2};case l.Bottom:return{x:r+o/2,y:a+i};case l.Left:return{x:r,y:a+i/2}}}function ah(e,t){return e?1!==e.length&&t?t&&e.find(e=>e.id===t)||null:e[0]:null}function af(e){var t,n,r,a,o;let i=(null==e||null==(t=e[ng])?void 0:t.handleBounds)||null,l=i&&(null==e?void 0:e.width)&&(null==e?void 0:e.height)&&void 0!==(null==e||null==(n=e.positionAbsolute)?void 0:n.x)&&void 0!==(null==e||null==(r=e.positionAbsolute)?void 0:r.y);return[{x:(null==e||null==(a=e.positionAbsolute)?void 0:a.x)||0,y:(null==e||null==(o=e.positionAbsolute)?void 0:o.y)||0,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0},i,!!l]}let am=[{level:0,isMaxLevel:!0,edges:[]}],ag={[i.Arrow]:e=>{let{color:t="none",strokeWidth:n=1}=e;return u.default.createElement("polyline",{style:{stroke:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"})},[i.ArrowClosed]:e=>{let{color:t="none",strokeWidth:n=1}=e;return u.default.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:n},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}},ap=e=>{let{id:t,type:n,color:r,width:a=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:l,orient:s="auto-start-reverse"}=e,c=function(e){let t=t8();return(0,u.useMemo)(()=>{if(!Object.prototype.hasOwnProperty.call(ag,e)){var n,r;return null==(n=(r=t.getState()).onError)||n.call(r,"009",t4.error009(e)),null}return ag[e]},[e])}(n);return c?u.default.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:"".concat(a),markerHeight:"".concat(o),viewBox:"-10 -10 20 20",markerUnits:i,orient:s,refX:"0",refY:"0"},u.default.createElement(c,{color:r,strokeWidth:l})):null},ay=e=>{let{defaultColor:t,rfId:n}=e,r=t7((0,u.useCallback)((e=>{let{defaultColor:t,rfId:n}=e;return e=>{let r=[];return e.edges.reduce((e,a)=>([a.markerStart,a.markerEnd].forEach(a=>{if(a&&"object"==typeof a){let o=nV(a,n);r.includes(o)||(e.push({id:o,color:a.color||t,...a}),r.push(o))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}})({defaultColor:t,rfId:n}),[t,n]),(e,t)=>!(e.length!==t.length||e.some((e,n)=>e.id!==t[n].id)));return u.default.createElement("defs",null,r.map(e=>u.default.createElement(ap,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient})))};ay.displayName="MarkerDefinitions";var ax=(0,u.memo)(ay);let av=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ab=e=>{let{defaultMarkerColor:t,onlyRenderVisibleElements:r,elevateEdgesOnSelect:a,rfId:o,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:c,onEdgeMouseEnter:d,onEdgeMouseMove:f,onEdgeMouseLeave:m,onEdgeClick:g,onEdgeDoubleClick:p,onReconnect:y,onReconnectStart:x,onReconnectEnd:v,reconnectRadius:b,children:N,disableKeyboardA11y:S}=e,{edgesFocusable:E,edgesUpdatable:_,elementsSelectable:j,width:k,height:M,connectionMode:C,nodeInternals:A,onError:z}=t7(av,w),B=function(e,t,n){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1,a=Object.entries(e.reduce((e,a)=>{let o=nm(a.zIndex),i=o?a.zIndex:0;if(n){var l,s;let e=t.get(a.target),n=t.get(a.source),r=a.selected||(null==e?void 0:e.selected)||(null==n?void 0:n.selected),c=Math.max((null==n||null==(l=n[ng])?void 0:l.z)||0,(null==e||null==(s=e[ng])?void 0:s.z)||0,1e3);i=(o?a.zIndex:0)+(r?c:0)}return e[i]?e[i].push(a):e[i]=[a],r=i>r?i:r,e},{})).map(e=>{let[t,n]=e,a=+t;return{edges:n,level:a,isMaxLevel:a===r}});return 0===a.length?am:a}(t7((0,u.useCallback)(n=>e?n.edges.filter(e=>{let r=t.get(e.source),a=t.get(e.target);return(null==r?void 0:r.width)&&(null==r?void 0:r.height)&&(null==a?void 0:a.width)&&(null==a?void 0:a.height)&&function(e){let{sourcePos:t,targetPos:n,sourceWidth:r,sourceHeight:a,targetWidth:o,targetHeight:i,width:l,height:s,transform:c}=e,u={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+r,n.x+o),y2:Math.max(t.y+a,n.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);let d=nu({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:l/c[2],height:s/c[2]});return Math.ceil(Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x))*Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y)))>0}({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:a.width,targetHeight:a.height,width:n.width,height:n.height,transform:n.transform})}):n.edges,[e,t])),t,n)}(r,A,a);return k?u.default.createElement(u.default.Fragment,null,B.map(e=>{let{level:r,edges:a,isMaxLevel:w}=e;return u.default.createElement("svg",{key:r,style:{zIndex:r},width:k,height:M,className:"react-flow__edges react-flow__container"},w&&u.default.createElement(ax,{defaultColor:t,rfId:o}),u.default.createElement("g",null,a.map(e=>{var t,r;let[a,w,N]=af(A.get(e.source)),[k,M,B]=af(A.get(e.target));if(!N||!B)return null;let I=e.type||"default";i[I]||(null==z||z("011",t4.error011(I)),I="default");let R=i[I]||i.default,P=C===n.Strict?M.target:(null!=(t=M.target)?t:[]).concat(null!=(r=M.source)?r:[]),T=ah(w.source,e.sourceHandle),D=ah(P,e.targetHandle),O=(null==T?void 0:T.position)||l.Bottom,L=(null==D?void 0:D.position)||l.Top,V=!!(e.focusable||E&&void 0===e.focusable),H=e.reconnectable||e.updatable;if(!T||!D)return null==z||z("008",t4.error008(T,e)),null;let{sourceX:F,sourceY:q,targetX:X,targetY:K}=((e,t,n,r,a,o)=>{let i=ad(n,e,t),l=ad(o,r,a);return{sourceX:i.x,sourceY:i.y,targetX:l.x,targetY:l.y}})(a,T,O,k,D,L);return u.default.createElement(R,{key:e.id,id:e.id,className:h([e.className,s]),type:I,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:F,sourceY:q,targetX:X,targetY:K,sourcePosition:O,targetPosition:L,elementsSelectable:j,onContextMenu:c,onMouseEnter:d,onMouseMove:f,onMouseLeave:m,onClick:g,onEdgeDoubleClick:p,onReconnect:y,onReconnectStart:x,onReconnectEnd:v,reconnectRadius:b,rfId:o,ariaLabel:e.ariaLabel,isFocusable:V,isReconnectable:void 0!==y&&(H||_&&void 0===H),pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:S})})))}),N):null};ab.displayName="EdgeRenderer";var aw=(0,u.memo)(ab);let aN=e=>"translate(".concat(e.transform[0],"px,").concat(e.transform[1],"px) scale(").concat(e.transform[2],")");function aS(e){let{children:t}=e,n=t7(aN);return u.default.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}let aE={[l.Left]:l.Right,[l.Right]:l.Left,[l.Top]:l.Bottom,[l.Bottom]:l.Top},a_=e=>{var t,r,a,i,l,s,c;let{nodeId:d,handleType:h,style:f,type:m=o.Bezier,CustomComponent:g,connectionStatus:p}=e,{fromNode:y,handleId:x,toX:v,toY:b,connectionMode:N}=t7((0,u.useCallback)(e=>({fromNode:e.nodeInternals.get(d),handleId:e.connectionHandleId,toX:(e.connectionPosition.x-e.transform[0])/e.transform[2],toY:(e.connectionPosition.y-e.transform[1])/e.transform[2],connectionMode:e.connectionMode}),[d]),w),S=null==y||null==(t=y[ng])?void 0:t.handleBounds,E=null==S?void 0:S[h];if(N===n.Loose&&(E=E||(null==S?void 0:S["source"===h?"target":"source"])),!y||!E)return null;let _=x?E.find(e=>e.id===x):E[0],j=_?_.x+_.width/2:(null!=(i=y.width)?i:0)/2,k=_?_.y+_.height/2:null!=(l=y.height)?l:0,M=(null!=(s=null==(r=y.positionAbsolute)?void 0:r.x)?s:0)+j,C=(null!=(c=null==(a=y.positionAbsolute)?void 0:a.y)?c:0)+k,A=null==_?void 0:_.position,z=A?aE[A]:null;if(!A||!z)return null;if(g)return u.default.createElement(g,{connectionLineType:m,connectionLineStyle:f,fromNode:y,fromHandle:_,fromX:M,fromY:C,toX:v,toY:b,fromPosition:A,toPosition:z,connectionStatus:p});let B="",I={sourceX:M,sourceY:C,sourcePosition:A,targetX:v,targetY:b,targetPosition:z};return m===o.Bezier?[B]=nT(I):m===o.Step?[B]=nA({...I,borderRadius:0}):m===o.SmoothStep?[B]=nA(I):m===o.SimpleBezier?[B]=nj(I):B="M".concat(M,",").concat(C," ").concat(v,",").concat(b),u.default.createElement("path",{d:B,fill:"none",className:"react-flow__connection-path",style:f})};a_.displayName="ConnectionLine";let aj=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ak(e){let{containerStyle:t,style:n,type:r,component:a}=e,{nodeId:o,handleType:i,nodesConnectable:l,width:s,height:c,connectionStatus:d}=t7(aj,w);return o&&i&&s&&l?u.default.createElement("svg",{style:t,width:s,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},u.default.createElement("g",{className:h(["react-flow__connection",d])},u.default.createElement(a_,{nodeId:o,handleType:i,style:n,type:r,CustomComponent:a,connectionStatus:d}))):null}function aM(e,t){return(0,u.useRef)(null),t8(),(0,u.useMemo)(()=>t(e),[e])}let aC=e=>{let{nodeTypes:t,edgeTypes:n,onMove:r,onMoveStart:a,onMoveEnd:o,onInit:i,onNodeClick:l,onEdgeClick:s,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:g,onSelectionContextMenu:p,onSelectionStart:y,onSelectionEnd:x,connectionLineType:v,connectionLineStyle:b,connectionLineComponent:w,connectionLineContainerStyle:N,selectionKeyCode:S,selectionOnDrag:E,selectionMode:_,multiSelectionKeyCode:j,panActivationKeyCode:k,zoomActivationKeyCode:M,deleteKeyCode:C,onlyRenderVisibleElements:A,elementsSelectable:z,selectNodesOnDrag:B,defaultViewport:I,translateExtent:R,minZoom:P,maxZoom:T,preventScrolling:D,defaultMarkerColor:O,zoomOnScroll:L,zoomOnPinch:V,panOnScroll:H,panOnScrollSpeed:F,panOnScrollMode:q,zoomOnDoubleClick:X,panOnDrag:K,onPaneClick:W,onPaneMouseEnter:Y,onPaneMouseMove:Z,onPaneMouseLeave:U,onPaneScroll:G,onPaneContextMenu:$,onEdgeContextMenu:Q,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,onReconnect:en,onReconnectStart:er,onReconnectEnd:ea,reconnectRadius:eo,noDragClassName:ei,noWheelClassName:el,noPanClassName:es,elevateEdgesOnSelect:ec,disableKeyboardA11y:eu,nodeOrigin:ed,nodeExtent:eh,rfId:ef}=e,em=aM(t,an),eg=aM(n,au);return!function(e){let t=rz(),n=(0,u.useRef)(!1);(0,u.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}(i),u.default.createElement(at,{onPaneClick:W,onPaneMouseEnter:Y,onPaneMouseMove:Z,onPaneMouseLeave:U,onPaneContextMenu:$,onPaneScroll:G,deleteKeyCode:C,selectionKeyCode:S,selectionOnDrag:E,selectionMode:_,onSelectionStart:y,onSelectionEnd:x,multiSelectionKeyCode:j,panActivationKeyCode:k,zoomActivationKeyCode:M,elementsSelectable:z,onMove:r,onMoveStart:a,onMoveEnd:o,zoomOnScroll:L,zoomOnPinch:V,zoomOnDoubleClick:X,panOnScroll:H,panOnScrollSpeed:F,panOnScrollMode:q,panOnDrag:K,defaultViewport:I,translateExtent:R,minZoom:P,maxZoom:T,onSelectionContextMenu:p,preventScrolling:D,noDragClassName:ei,noWheelClassName:el,noPanClassName:es,disableKeyboardA11y:eu},u.default.createElement(aS,null,u.default.createElement(aw,{edgeTypes:eg,onEdgeClick:s,onEdgeDoubleClick:d,onlyRenderVisibleElements:A,onEdgeContextMenu:Q,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,onReconnect:en,onReconnectStart:er,onReconnectEnd:ea,reconnectRadius:eo,defaultMarkerColor:O,noPanClassName:es,elevateEdgesOnSelect:!!ec,disableKeyboardA11y:eu,rfId:ef},u.default.createElement(ak,{style:b,type:v,component:w,containerStyle:N})),u.default.createElement("div",{className:"react-flow__edgelabel-renderer"}),u.default.createElement(ao,{nodeTypes:em,onNodeClick:l,onNodeDoubleClick:c,onNodeMouseEnter:h,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:g,selectNodesOnDrag:B,onlyRenderVisibleElements:A,noPanClassName:es,noDragClassName:ei,disableKeyboardA11y:eu,nodeOrigin:ed,nodeExtent:eh,rfId:ef})))};aC.displayName="GraphView";var aA=(0,u.memo)(aC);let az=[[-1/0,-1/0],[1/0,1/0]],aB={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:az,nodeExtent:az,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:n.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ny,isValidConnection:void 0},aI=e=>{let{children:t}=e,n=(0,u.useRef)(null);return n.current||(n.current=((e,t)=>e?b(e,t):b)((e,t)=>({...aB,setNodes:n=>{let{nodeInternals:r,nodeOrigin:a,elevateNodesOnSelect:o}=t();e({nodeInternals:r_(n,r,a,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{let{defaultEdgeOptions:r={}}=t();e({edges:n.map(e=>({...r,...e}))})},setDefaultNodesAndEdges:(n,r)=>{let a=void 0!==n,o=void 0!==r;e({nodeInternals:a?r_(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map,edges:o?r:[],hasDefaultNodes:a,hasDefaultEdges:o})},updateNodeDimensions:n=>{let{onNodesChange:r,nodeInternals:a,fitViewOnInit:o,fitViewOnInitDone:i,fitViewOnInitOptions:l,domNode:s,nodeOrigin:c}=t(),u=null==s?void 0:s.querySelector(".react-flow__viewport");if(!u)return;let d=window.getComputedStyle(u),{m22:h}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((e,t)=>{let n=a.get(t.id);if(null==n?void 0:n.hidden)a.set(n.id,{...n,[ng]:{...n[ng],handleBounds:void 0}});else if(n){let r=nr(t.nodeElement);r.width&&r.height&&(n.width!==r.width||n.height!==r.height||t.forceUpdate)&&(a.set(n.id,{...n,[ng]:{...n[ng],handleBounds:{source:rJ(".source",t.nodeElement,h,c),target:rJ(".target",t.nodeElement,h,c)}},...r}),e.push({id:n.id,type:"dimensions",dimensions:r}))}return e},[]);rE(a,c);let m=i||o&&!i&&rj(t,{initial:!0,...l});e({nodeInternals:new Map(a),fitViewOnInitDone:m}),(null==f?void 0:f.length)>0&&(null==r||r(f))},updateNodePositions:function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{triggerNodeChanges:a}=t();a(e.map(e=>{let t={id:e.id,type:"position",dragging:r};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t}))},triggerNodeChanges:n=>{let{onNodesChange:r,nodeInternals:a,hasDefaultNodes:o,nodeOrigin:i,getNodes:l,elevateNodesOnSelect:s}=t();(null==n?void 0:n.length)&&(o&&e({nodeInternals:r_(rX(n,l()),a,i,s)}),null==r||r(n))},addSelectedNodes:n=>{let r,{multiSelectionActive:a,edges:o,getNodes:i}=t(),l=null;a?r=n.map(e=>rK(e,!0)):(r=rW(i(),n),l=rW(o,[])),rk({changedNodes:r,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{let r,{multiSelectionActive:a,edges:o,getNodes:i}=t(),l=null;a?r=n.map(e=>rK(e,!0)):(r=rW(o,n),l=rW(i(),[])),rk({changedNodes:l,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:function(){let{nodes:n,edges:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{edges:a,getNodes:o}=t();rk({changedNodes:(n||o()).map(e=>(e.selected=!1,rK(e.id,!1))),changedEdges:(r||a).map(e=>rK(e.id,!1)),get:t,set:e})},setMinZoom:n=>{let{d3Zoom:r,maxZoom:a}=t();null==r||r.scaleExtent([n,a]),e({minZoom:n})},setMaxZoom:n=>{let{d3Zoom:r,minZoom:a}=t();null==r||r.scaleExtent([a,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;null==(r=t().d3Zoom)||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{let{edges:n,getNodes:r}=t();rk({changedNodes:r().filter(e=>e.selected).map(e=>rK(e.id,!1)),changedEdges:n.filter(e=>e.selected).map(e=>rK(e.id,!1)),get:t,set:e})},setNodeExtent:n=>{let{nodeInternals:r}=t();r.forEach(e=>{e.positionAbsolute=no(e.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:e=>{let{transform:n,width:r,height:a,d3Zoom:o,d3Selection:i,translateExtent:l}=t();if(!o||!i||!e.x&&!e.y)return!1;let s=tH.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=null==o?void 0:o.constrain()(s,[[0,0],[r,a]],l);return o.transform(i,c),n[0]!==c.x||n[1]!==c.y||n[2]!==c.k},cancelConnection:()=>e({connectionNodeId:aB.connectionNodeId,connectionHandleId:aB.connectionHandleId,connectionHandleType:aB.connectionHandleType,connectionStatus:aB.connectionStatus,connectionStartHandle:aB.connectionStartHandle,connectionEndHandle:aB.connectionEndHandle}),reset:()=>e({...aB})}),Object.is)),u.default.createElement(t5,{value:n.current},t)};aI.displayName="ReactFlowProvider";let aR=e=>{let{children:t}=e;return(0,u.useContext)(t3)?u.default.createElement(u.default.Fragment,null,t):u.default.createElement(aI,null,t)};aR.displayName="ReactFlowWrapper";let aP={input:re,default:n8,output:rn,group:rr},aT={default:nD,straight:nI,step:nB,smoothstep:nz,simplebezier:nk},aD=[0,0],aO=[15,15],aL={x:0,y:0,zoom:1},aV={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},aH=(0,u.forwardRef)((e,t)=>{let{nodes:i,edges:l,defaultNodes:s,defaultEdges:c,className:d,nodeTypes:f=aP,edgeTypes:m=aT,onNodeClick:g,onEdgeClick:p,onInit:y,onMove:x,onMoveStart:v,onMoveEnd:b,onConnect:w,onConnectStart:N,onConnectEnd:S,onClickConnectStart:E,onClickConnectEnd:_,onNodeMouseEnter:j,onNodeMouseMove:k,onNodeMouseLeave:M,onNodeContextMenu:C,onNodeDoubleClick:A,onNodeDragStart:z,onNodeDrag:B,onNodeDragStop:I,onNodesDelete:R,onEdgesDelete:P,onSelectionChange:T,onSelectionDragStart:D,onSelectionDrag:O,onSelectionDragStop:L,onSelectionContextMenu:V,onSelectionStart:H,onSelectionEnd:F,connectionMode:q=n.Strict,connectionLineType:X=o.Bezier,connectionLineStyle:K,connectionLineComponent:W,connectionLineContainerStyle:Y,deleteKeyCode:Z="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:G=!1,selectionMode:$=a.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:J=nb()?"Meta":"Control",zoomActivationKeyCode:ee=nb()?"Meta":"Control",snapToGrid:et=!1,snapGrid:en=aO,onlyRenderVisibleElements:er=!1,selectNodesOnDrag:ea=!0,nodesDraggable:eo,nodesConnectable:ei,nodesFocusable:el,nodeOrigin:es=aD,edgesFocusable:ec,edgesUpdatable:eu,elementsSelectable:ed,defaultViewport:eh=aL,minZoom:ef=.5,maxZoom:em=2,translateExtent:eg=az,preventScrolling:ep=!0,nodeExtent:ey,defaultMarkerColor:ex="#b1b1b7",zoomOnScroll:ev=!0,zoomOnPinch:eb=!0,panOnScroll:ew=!1,panOnScrollSpeed:eN=.5,panOnScrollMode:eS=r.Free,zoomOnDoubleClick:eE=!0,panOnDrag:e_=!0,onPaneClick:ej,onPaneMouseEnter:ek,onPaneMouseMove:eM,onPaneMouseLeave:eC,onPaneScroll:eA,onPaneContextMenu:ez,children:eB,onEdgeContextMenu:eI,onEdgeDoubleClick:eR,onEdgeMouseEnter:eP,onEdgeMouseMove:eT,onEdgeMouseLeave:eD,onEdgeUpdate:eO,onEdgeUpdateStart:eL,onEdgeUpdateEnd:eV,onReconnect:eH,onReconnectStart:eF,onReconnectEnd:eq,reconnectRadius:eX=10,edgeUpdaterRadius:eK=10,onNodesChange:eW,onEdgesChange:eY,noDragClassName:eZ="nodrag",noWheelClassName:eU="nowheel",noPanClassName:eG="nopan",fitView:e$=!1,fitViewOptions:eQ,connectOnClick:eJ=!0,attributionPosition:e0,proOptions:e1,defaultEdgeOptions:e2,elevateNodesOnSelect:e3=!0,elevateEdgesOnSelect:e5=!1,disableKeyboardA11y:e4=!1,autoPanOnConnect:e6=!0,autoPanOnNodeDrag:e7=!0,connectionRadius:e8=20,isValidConnection:e9,onError:te,style:tt,id:tn,nodeDragThreshold:tr,...ta}=e,to=tn||"1";return u.default.createElement("div",{...ta,style:{...tt,...aV},ref:t,className:h(["react-flow",d]),"data-testid":"rf__wrapper",id:tn},u.default.createElement(aR,null,u.default.createElement(aA,{onInit:y,onMove:x,onMoveStart:v,onMoveEnd:b,onNodeClick:g,onEdgeClick:p,onNodeMouseEnter:j,onNodeMouseMove:k,onNodeMouseLeave:M,onNodeContextMenu:C,onNodeDoubleClick:A,nodeTypes:f,edgeTypes:m,connectionLineType:X,connectionLineStyle:K,connectionLineComponent:W,connectionLineContainerStyle:Y,selectionKeyCode:U,selectionOnDrag:G,selectionMode:$,deleteKeyCode:Z,multiSelectionKeyCode:J,panActivationKeyCode:Q,zoomActivationKeyCode:ee,onlyRenderVisibleElements:er,selectNodesOnDrag:ea,defaultViewport:eh,translateExtent:eg,minZoom:ef,maxZoom:em,preventScrolling:ep,zoomOnScroll:ev,zoomOnPinch:eb,zoomOnDoubleClick:eE,panOnScroll:ew,panOnScrollSpeed:eN,panOnScrollMode:eS,panOnDrag:e_,onPaneClick:ej,onPaneMouseEnter:ek,onPaneMouseMove:eM,onPaneMouseLeave:eC,onPaneScroll:eA,onPaneContextMenu:ez,onSelectionContextMenu:V,onSelectionStart:H,onSelectionEnd:F,onEdgeContextMenu:eI,onEdgeDoubleClick:eR,onEdgeMouseEnter:eP,onEdgeMouseMove:eT,onEdgeMouseLeave:eD,onReconnect:null!=eH?eH:eO,onReconnectStart:null!=eF?eF:eL,onReconnectEnd:null!=eq?eq:eV,reconnectRadius:null!=eX?eX:eK,defaultMarkerColor:ex,noDragClassName:eZ,noWheelClassName:eU,noPanClassName:eG,elevateEdgesOnSelect:e5,rfId:to,disableKeyboardA11y:e4,nodeOrigin:es,nodeExtent:ey}),u.default.createElement(rf,{nodes:i,edges:l,defaultNodes:s,defaultEdges:c,onConnect:w,onConnectStart:N,onConnectEnd:S,onClickConnectStart:E,onClickConnectEnd:_,nodesDraggable:eo,nodesConnectable:ei,nodesFocusable:el,edgesFocusable:ec,edgesUpdatable:eu,elementsSelectable:ed,elevateNodesOnSelect:e3,minZoom:ef,maxZoom:em,nodeExtent:ey,onNodesChange:eW,onEdgesChange:eY,snapToGrid:et,snapGrid:en,connectionMode:q,translateExtent:eg,connectOnClick:eJ,defaultEdgeOptions:e2,fitView:e$,fitViewOptions:eQ,onNodesDelete:R,onEdgesDelete:P,onNodeDragStart:z,onNodeDrag:B,onNodeDragStop:I,onSelectionDrag:O,onSelectionDragStart:D,onSelectionDragStop:L,noPanClassName:eG,nodeOrigin:es,rfId:to,autoPanOnConnect:e6,autoPanOnNodeDrag:e7,onError:te,connectionRadius:e8,isValidConnection:e9,nodeDragThreshold:tr}),u.default.createElement(rc,{onSelectionChange:T}),eB,u.default.createElement(nt,{proOptions:e1,position:e0}),u.default.createElement(rb,{rfId:to,disableKeyboardA11y:e4})))});function aF(e){return t=>{let[n,r]=(0,u.useState)(t),a=(0,u.useCallback)(t=>r(n=>e(t,n)),[]);return[n,r,a]}}aH.displayName="ReactFlow";let aq=aF(rX),aX=aF(function(e,t){return rq(e,t)});function aK(){return u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},u.default.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function aW(){return u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},u.default.createElement("path",{d:"M0 0h32v4.2H0z"}))}function aY(){return u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},u.default.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function aZ(){return u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},u.default.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function aU(){return u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},u.default.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}let aG=e=>{let{children:t,className:n,...r}=e;return u.default.createElement("button",{type:"button",className:h(["react-flow__controls-button",n]),...r},t)};aG.displayName="ControlButton";let a$=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),aQ=e=>{let{style:t,showZoom:n=!0,showFitView:r=!0,showInteractive:a=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:l,onFitView:s,onInteractiveChange:c,className:d,children:f,position:m="bottom-left"}=e,g=t8(),[p,y]=(0,u.useState)(!1),{isInteractive:x,minZoomReached:v,maxZoomReached:b}=t7(a$,w),{zoomIn:N,zoomOut:S,fitView:E}=rz();return((0,u.useEffect)(()=>{y(!0)},[]),p)?u.default.createElement(ne,{className:h(["react-flow__controls",d]),position:m,style:t,"data-testid":"rf__controls"},n&&u.default.createElement(u.default.Fragment,null,u.default.createElement(aG,{onClick:()=>{N(),null==i||i()},className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:b},u.default.createElement(aK,null)),u.default.createElement(aG,{onClick:()=>{S(),null==l||l()},className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v},u.default.createElement(aW,null))),r&&u.default.createElement(aG,{className:"react-flow__controls-fitview",onClick:()=>{E(o),null==s||s()},title:"fit view","aria-label":"fit view"},u.default.createElement(aY,null)),a&&u.default.createElement(aG,{className:"react-flow__controls-interactive",onClick:()=>{g.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),null==c||c(!x)},title:"toggle interactivity","aria-label":"toggle interactivity"},x?u.default.createElement(aU,null):u.default.createElement(aZ,null)),f):null};aQ.displayName="Controls";var aJ=(0,u.memo)(aQ);function a0(e){let{color:t,dimensions:n,lineWidth:r}=e;return u.default.createElement("path",{stroke:t,strokeWidth:r,d:"M".concat(n[0]/2," 0 V").concat(n[1]," M0 ").concat(n[1]/2," H").concat(n[0])})}function a1(e){let{color:t,radius:n}=e;return u.default.createElement("circle",{cx:n,cy:n,r:n,fill:t})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(s||(s={}));let a2={[s.Dots]:"#91919a",[s.Lines]:"#eee",[s.Cross]:"#e2e2e2"},a3={[s.Dots]:1,[s.Lines]:1,[s.Cross]:6},a5=e=>({transform:e.transform,patternId:"pattern-".concat(e.rfId)});function a4(e){let{id:t,variant:n=s.Dots,gap:r=20,size:a,lineWidth:o=1,offset:i=2,color:l,style:c,className:d}=e,f=(0,u.useRef)(null),{transform:m,patternId:g}=t7(a5,w),p=l||a2[n],y=a||a3[n],x=n===s.Dots,v=n===s.Cross,b=Array.isArray(r)?r:[r,r],N=[b[0]*m[2]||1,b[1]*m[2]||1],S=y*m[2],E=v?[S,S]:N,_=x?[S/i,S/i]:[E[0]/i,E[1]/i];return u.default.createElement("svg",{className:h(["react-flow__background",d]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:f,"data-testid":"rf__background"},u.default.createElement("pattern",{id:g+t,x:m[0]%N[0],y:m[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:"translate(-".concat(_[0],",-").concat(_[1],")")},x?u.default.createElement(a1,{color:p,radius:S/i}):u.default.createElement(a0,{dimensions:E,color:p,lineWidth:o})),u.default.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(g+t,")")}))}a4.displayName="Background";var a6=(0,u.memo)(a4);let a7=e=>{let{id:t,x:n,y:r,width:a,height:o,style:i,color:l,strokeColor:s,strokeWidth:c,className:d,borderRadius:f,shapeRendering:m,onClick:g,selected:p}=e,{background:y,backgroundColor:x}=i||{};return u.default.createElement("rect",{className:h(["react-flow__minimap-node",{selected:p},d]),x:n,y:r,rx:f,ry:f,width:a,height:o,fill:l||y||x,stroke:s,strokeWidth:c,shapeRendering:m,onClick:g?e=>g(e,t):void 0})};a7.displayName="MiniMapNode";var a8=(0,u.memo)(a7);let a9=e=>e.nodeOrigin,oe=e=>e.getNodes().filter(e=>!e.hidden&&e.width&&e.height),ot=e=>e instanceof Function?e:()=>e;var on=(0,u.memo)(function(e){let{nodeStrokeColor:t="transparent",nodeColor:n="#e2e2e2",nodeClassName:r="",nodeBorderRadius:a=5,nodeStrokeWidth:o=2,nodeComponent:i=a8,onClick:l}=e,s=t7(oe,w),c=t7(a9),d=ot(n),h=ot(t),f=ot(r),m="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return u.default.createElement(u.default.Fragment,null,s.map(e=>{let{x:t,y:n}=nX(e,c).positionAbsolute;return u.default.createElement(i,{key:e.id,x:t,y:n,width:e.width,height:e.height,style:e.style,selected:e.selected,className:f(e),color:d(e),borderRadius:a,strokeColor:h(e),strokeWidth:o,shapeRendering:m,onClick:l,id:e.id})}))});let or=e=>{let t,n=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:n.length>0?(t=nK(n,e.nodeOrigin),nd(nc(nu(t),nu(r)))):r,rfId:e.rfId}};function oa(e){var t,n;let{style:r,className:a,nodeStrokeColor:o="transparent",nodeColor:i="#e2e2e2",nodeClassName:l="",nodeBorderRadius:s=5,nodeStrokeWidth:c=2,nodeComponent:d,maskColor:f="rgb(240, 240, 240, 0.6)",maskStrokeColor:m="none",maskStrokeWidth:g=1,position:p="bottom-right",onClick:y,onNodeClick:x,pannable:v=!1,zoomable:b=!1,ariaLabel:N="React Flow mini map",inversePan:S=!1,zoomStep:E=10,offsetScale:_=5}=e,j=t8(),k=(0,u.useRef)(null),{boundingRect:M,viewBB:C,rfId:A}=t7(or,w),z=null!=(t=null==r?void 0:r.width)?t:200,B=null!=(n=null==r?void 0:r.height)?n:150,I=Math.max(M.width/z,M.height/B),R=I*z,P=I*B,T=_*I,D=M.x-(R-M.width)/2-T,O=M.y-(P-M.height)/2-T,L=R+2*T,V=P+2*T,H="".concat("react-flow__minimap-desc","-").concat(A),F=(0,u.useRef)(0);F.current=I,(0,u.useEffect)(()=>{if(k.current){let e=ef(k.current),t=tG().on("zoom",v?e=>{let{transform:t,d3Selection:n,d3Zoom:r,translateExtent:a,width:o,height:i}=j.getState();if("mousemove"!==e.sourceEvent.type||!n||!r)return;let l=F.current*Math.max(1,t[2])*(S?-1:1),s={x:t[0]-e.sourceEvent.movementX*l,y:t[1]-e.sourceEvent.movementY*l},c=tH.translate(s.x,s.y).scale(t[2]),u=r.constrain()(c,[[0,0],[o,i]],a);r.transform(n,u)}:null).on("zoom.wheel",b?e=>{let{transform:t,d3Selection:n,d3Zoom:r}=j.getState();if("wheel"!==e.sourceEvent.type||!n||!r)return;let a=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*E,o=t[2]*Math.pow(2,a);r.scaleTo(n,o)}:null);return e.call(t),()=>{e.on("zoom",null)}}},[v,b,S,E]);let q=y?e=>{let t=eN(e);y(e,{x:t[0],y:t[1]})}:void 0,X=x?(e,t)=>{x(e,j.getState().nodeInternals.get(t))}:void 0;return u.default.createElement(ne,{position:p,style:r,className:h(["react-flow__minimap",a]),"data-testid":"rf__minimap"},u.default.createElement("svg",{width:z,height:B,viewBox:"".concat(D," ").concat(O," ").concat(L," ").concat(V),role:"img","aria-labelledby":H,ref:k,onClick:q},N&&u.default.createElement("title",{id:H},N),u.default.createElement(on,{onClick:X,nodeColor:i,nodeStrokeColor:o,nodeBorderRadius:s,nodeClassName:l,nodeStrokeWidth:c,nodeComponent:d}),u.default.createElement("path",{className:"react-flow__minimap-mask",d:"M".concat(D-T,",").concat(O-T,"h").concat(L+2*T,"v").concat(V+2*T,"h").concat(-L-2*T,"z\n        M").concat(C.x,",").concat(C.y,"h").concat(C.width,"v").concat(C.height,"h").concat(-C.width,"z"),fill:f,fillRule:"evenodd",stroke:m,strokeWidth:g,pointerEvents:"none"})))}oa.displayName="MiniMap";var oo=(0,u.memo)(oa),oi=e.i(20523);let ol=(0,u.memo)(e=>{let{data:t,selected:n}=e;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[120px] ".concat(n?"border-blue-500 shadow-blue-200":"border-green-300"),children:[(0,c.jsx)("div",{className:"bg-green-50 px-3 py-2 border-b border-green-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(oi.Play,{className:"h-4 w-4 text-green-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-green-700",children:"Start"})]})}),(0,c.jsx)("div",{className:"p-3",children:(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Bot-Einstiegspunkt"})}),(0,c.jsx)(n6,{type:"source",position:l.Right,className:"w-3 h-3 bg-green-500 border-2 border-white"})]})});var os=e.i(26791);let oc=(0,u.memo)(e=>{let{data:t,selected:n}=e,{message:r,quickReplies:a=[]}=t;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[200px] max-w-[300px] ".concat(n?"border-blue-500 shadow-blue-200":"border-blue-300"),children:[(0,c.jsx)(n6,{type:"target",position:l.Left,className:"w-3 h-3 bg-blue-500 border-2 border-white"}),(0,c.jsx)("div",{className:"bg-blue-50 px-3 py-2 border-b border-blue-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(os.MessageSquare,{className:"h-4 w-4 text-blue-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-blue-700",children:"Nachricht"})]})}),(0,c.jsxs)("div",{className:"p-3 space-y-3",children:[(0,c.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 border",children:(0,c.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:r||"Nachricht eingeben..."})}),a.length>0&&(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Schnellantworten:"}),(0,c.jsx)("div",{className:"flex flex-wrap gap-1",children:a.map((e,t)=>(0,c.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full border",children:e},t))})]})]}),(0,c.jsx)(n6,{type:"source",position:l.Right,className:"w-3 h-3 bg-blue-500 border-2 border-white"})]})});var ou=e.i(22175);let od=(0,ou.default)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]),oh=(0,u.memo)(e=>{let{data:t,selected:n}=e,{conditions:r=[]}=t;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[180px] max-w-[250px] ".concat(n?"border-blue-500 shadow-blue-200":"border-yellow-400"),children:[(0,c.jsx)(n6,{type:"target",position:l.Left,className:"w-3 h-3 bg-yellow-500 border-2 border-white"}),(0,c.jsx)("div",{className:"bg-yellow-50 px-3 py-2 border-b border-yellow-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(od,{className:"h-4 w-4 text-yellow-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-yellow-700",children:"Bedingung"})]})}),(0,c.jsxs)("div",{className:"p-3 space-y-2",children:[(0,c.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"Weiterleitung basierend auf:"}),r.length>0?(0,c.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,c.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,c.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded border",children:e.keyword}),(0,c.jsx)("span",{className:"text-gray-400",children:""})]},t))}):(0,c.jsx)("p",{className:"text-xs text-gray-400 italic",children:"Keine Bedingungen definiert"})]}),r.map((e,t)=>(0,c.jsx)(n6,{type:"source",position:l.Right,id:"output-".concat(t),className:"w-3 h-3 bg-yellow-500 border-2 border-white",style:{top:"".concat(60+25*t,"px"),right:"-6px"}},t)),(0,c.jsx)(n6,{type:"source",position:l.Bottom,id:"default",className:"w-3 h-3 bg-gray-400 border-2 border-white"})]})}),of=(0,ou.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),om=(0,u.memo)(e=>{let{data:t,selected:n}=e,{prompt:r,variable:a,inputType:o,choices:i=[],required:s=!0}=t;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[200px] max-w-[280px] ".concat(n?"border-blue-500 shadow-blue-200":"border-purple-300"),children:[(0,c.jsx)(n6,{type:"target",position:l.Left,className:"w-3 h-3 bg-purple-500 border-2 border-white"}),(0,c.jsx)("div",{className:"bg-purple-50 px-3 py-2 border-b border-purple-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(of,{className:"h-4 w-4 text-purple-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-purple-700",children:"Eingabe sammeln"})]}),s&&(0,c.jsx)("span",{className:"text-xs text-red-500",children:"*"})]})}),(0,c.jsxs)("div",{className:"p-3 space-y-3",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Eingabeaufforderung:"}),(0,c.jsx)("div",{className:"bg-gray-50 rounded p-2 border",children:(0,c.jsx)("p",{className:"text-sm text-gray-800",children:r||"Bitte geben Sie eine Antwort ein:"})})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"text-xs text-gray-600",children:"Typ:"}),(0,c.jsx)("span",{className:"px-2 py-1 text-xs rounded border ".concat({text:"bg-purple-100 text-purple-700 border-purple-200",email:"bg-blue-100 text-blue-700 border-blue-200",phone:"bg-green-100 text-green-700 border-green-200",number:"bg-orange-100 text-orange-700 border-orange-200",choice:"bg-pink-100 text-pink-700 border-pink-200"}[o]||"bg-gray-100 text-gray-700 border-gray-200"),children:(e=>({text:"Text",email:"E-Mail",phone:"Telefon",number:"Zahl",choice:"Auswahl"})[e]||e)(o)})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"text-xs text-gray-600",children:"Variable:"}),(0,c.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded border font-mono",children:a||"variable_name"})]}),"choice"===o&&i.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Auswahlmglichkeiten:"}),(0,c.jsx)("div",{className:"space-y-1",children:i.map((e,t)=>(0,c.jsxs)("div",{className:"flex items-center text-xs",children:[(0,c.jsx)("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mr-2"}),(0,c.jsx)("span",{className:"text-gray-700",children:e})]},t))})]})]}),(0,c.jsx)(n6,{type:"source",position:l.Right,className:"w-3 h-3 bg-purple-500 border-2 border-white"})]})}),og=(0,ou.default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),op=(0,u.memo)(e=>{let{data:t,selected:n}=e,{message:r,department:a}=t;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[200px] max-w-[280px] ".concat(n?"border-blue-500 shadow-blue-200":"border-red-300"),children:[(0,c.jsx)(n6,{type:"target",position:l.Left,className:"w-3 h-3 bg-red-500 border-2 border-white"}),(0,c.jsx)("div",{className:"bg-red-50 px-3 py-2 border-b border-red-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(og,{className:"h-4 w-4 text-red-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-red-700",children:"An Mensch weiterleiten"})]})}),(0,c.jsxs)("div",{className:"p-3 space-y-3",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Nachricht:"}),(0,c.jsx)("div",{className:"bg-gray-50 rounded p-2 border",children:(0,c.jsx)("p",{className:"text-sm text-gray-800",children:r||"Ich verbinde Sie mit einem Mitarbeiter..."})})]}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"text-xs text-gray-600",children:"Abteilung:"}),(0,c.jsx)("span",{className:"px-2 py-1 text-xs rounded border ".concat({general:"bg-gray-100 text-gray-700 border-gray-200","customer-service":"bg-blue-100 text-blue-700 border-blue-200",technical:"bg-orange-100 text-orange-700 border-orange-200",sales:"bg-green-100 text-green-700 border-green-200",billing:"bg-yellow-100 text-yellow-700 border-yellow-200"}[a||"general"]||"bg-gray-100 text-gray-700 border-gray-200"),children:(e=>({general:"Allgemein","customer-service":"Kundenservice",technical:"Technischer Support",sales:"Vertrieb",billing:"Rechnungswesen"})[e]||e)(a||"general")})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(0,c.jsx)("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-pulse"}),(0,c.jsx)("span",{children:"Beendet Bot-Konversation"})]})]})]})}),oy=(0,ou.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),ox={start:ol,message:oc,condition:oh,"collect-input":om,handoff:op,end:(0,u.memo)(e=>{let{data:t,selected:n}=e,{label:r,message:a}=t;return(0,c.jsxs)("div",{className:"relative bg-white border-2 rounded-lg shadow-sm min-w-[120px] max-w-[200px] ".concat(n?"border-blue-500 shadow-blue-200":"border-gray-400"),children:[(0,c.jsx)(n6,{type:"target",position:l.Left,className:"w-3 h-3 bg-gray-500 border-2 border-white"}),(0,c.jsx)("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 rounded-t-lg",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(oy,{className:"h-4 w-4 text-gray-600"}),(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Ende"})]})}),(0,c.jsx)("div",{className:"p-3",children:a?(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("div",{className:"bg-gray-50 rounded p-2 border",children:(0,c.jsx)("p",{className:"text-sm text-gray-800",children:a})}),(0,c.jsx)("p",{className:"text-xs text-gray-500",children:"Konversation beendet"})]}):(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Konversation beendet"})})]})})},ov={style:{strokeWidth:2},type:"smoothstep"};function ob(e){let{nodes:t,edges:n,onNodesChange:r,onEdgesChange:a,onNodeSelect:o}=e,[i,l,s]=aq(t),[d,h,f]=aX(n),m=(0,u.useCallback)(e=>{s(e),r(e.length>0?i.map(t=>{let n=e.find(e=>e.id===t.id);return n?{...t,...n}:t}):i)},[i,r,s]),g=(0,u.useCallback)(e=>{f(e),a(e.length>0?d.map(t=>{let n=e.find(e=>e.id===t.id);return n?{...t,...n}:t}):d)},[d,a,f]),p=(0,u.useCallback)(e=>{let t=nH(e,d);h(t),a(t)},[d,h,a]),y=(0,u.useCallback)((e,t)=>{o(t.id)},[o]),x=(0,u.useCallback)(()=>{o(null)},[o]),v=(0,u.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),b=(0,u.useCallback)(e=>{e.preventDefault();let t=e.dataTransfer.getData("application/reactflow");if(void 0===t||!t)return;let n={x:e.clientX-200,y:e.clientY-40},a=[...i,{id:"".concat(t,"_").concat(Date.now()),type:t,position:n,data:function(e){switch(e){case"start":return{label:"Start"};case"message":return{message:"Neue Nachricht eingeben...",quickReplies:[]};case"condition":return{conditions:[{keyword:"ja",target:null},{keyword:"nein",target:null}]};case"collect-input":return{prompt:"Bitte geben Sie eine Antwort ein:",variable:"user_input",inputType:"text"};case"handoff":return{message:"Ich verbinde Sie mit einem Mitarbeiter...",department:"general"};case"end":return{label:"Ende"};default:return{}}}(t)}];l(a),r(a)},[i,l,r]);return(0,c.jsx)("div",{className:"h-full w-full",children:(0,c.jsxs)(aH,{nodes:i,edges:d,onNodesChange:m,onEdgesChange:g,onConnect:p,onNodeClick:y,onPaneClick:x,onDrop:b,onDragOver:v,nodeTypes:ox,defaultEdgeOptions:ov,connectionLineStyle:{strokeWidth:2},connectionLineType:"smoothstep",fitView:!0,className:"bg-gray-50",children:[(0,c.jsx)(aJ,{className:"bg-white border border-gray-200 rounded-lg shadow-sm"}),(0,c.jsx)(a6,{color:"#e5e7eb",gap:20,size:1,variant:"dots"}),(0,c.jsx)(oo,{nodeColor:e=>{switch(e.type){case"start":return"#10b981";case"message":return"#3b82f6";case"condition":return"#f59e0b";case"collect-input":return"#8b5cf6";case"handoff":return"#ef4444";case"end":return"#6b7280";default:return"#9ca3af"}},nodeStrokeWidth:3,className:"bg-white border border-gray-200 rounded-lg shadow-sm",pannable:!0,zoomable:!0})]})})}function ow(e){return(0,c.jsx)(aI,{children:(0,c.jsx)(ob,{...e})})}var oN=e.i(36633),oS=e.i(14681);let oE=(0,ou.default)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),o_=(0,ou.default)("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),oj=(0,ou.default)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ok=(0,ou.default)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),oM=(0,ou.default)("maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);var oC=e.i(74660);let oA=(0,ou.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),oz=[{type:"message",label:"Nachricht",icon:os.MessageSquare,description:"Sendet eine Textnachricht",color:"bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700"},{type:"condition",label:"Bedingung",icon:od,description:"Verzweigt basierend auf Benutzerantwort",color:"bg-yellow-50 hover:bg-yellow-100 border-yellow-200 text-yellow-700"},{type:"collect-input",label:"Eingabe",icon:of,description:"Sammelt Benutzereingaben",color:"bg-purple-50 hover:bg-purple-100 border-purple-200 text-purple-700"},{type:"handoff",label:"An Mensch",icon:og,description:"Weiterleitung an menschlichen Agent",color:"bg-red-50 hover:bg-red-100 border-red-200 text-red-700"},{type:"end",label:"Ende",icon:oy,description:"Beendet die Konversation",color:"bg-gray-50 hover:bg-gray-100 border-gray-200 text-gray-700"}];function oB(e){let{onAddNode:t}=e,[n,r]=(0,u.useState)(!1),a=(e,t)=>{e.dataTransfer.setData("application/reactflow",t),e.dataTransfer.effectAllowed="move"};return(0,c.jsxs)("div",{className:"border-b border-gray-200 bg-white",children:[(0,c.jsxs)("div",{className:"px-6 py-3",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(oN.Zap,{className:"h-5 w-5 text-blue-600"}),(0,c.jsx)("span",{className:"font-medium text-gray-900",children:"Bot Bausteine"})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[oz.slice(0,n?oz.length:3).map(e=>{let n=e.icon;return(0,c.jsxs)("div",{draggable:!0,onDragStart:t=>a(t,e.type),onClick:()=>t(e.type),className:"flex items-center space-x-2 px-3 py-2 border rounded-lg cursor-pointer transition-colors ".concat(e.color),title:e.description,children:[(0,c.jsx)(n,{className:"h-4 w-4"}),(0,c.jsx)("span",{className:"text-sm font-medium",children:e.label})]},e.type)}),!n&&oz.length>3&&(0,c.jsxs)("button",{onClick:()=>r(!0),className:"flex items-center space-x-1 px-2 py-2 text-gray-500 hover:text-gray-700 transition-colors",children:[(0,c.jsx)(oS.Plus,{className:"h-4 w-4"}),(0,c.jsxs)("span",{className:"text-sm",children:["+",oz.length-3]})]})]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsxs)("div",{className:"flex items-center border rounded-lg",children:[(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors border-r",title:"Rckgngig",children:(0,c.jsx)(oE,{className:"h-4 w-4 text-gray-600"})}),(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors",title:"Wiederholen",children:(0,c.jsx)(o_,{className:"h-4 w-4 text-gray-600"})})]}),(0,c.jsxs)("div",{className:"flex items-center border rounded-lg",children:[(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors border-r",title:"Vergrern",children:(0,c.jsx)(oj,{className:"h-4 w-4 text-gray-600"})}),(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors border-r",title:"Verkleinern",children:(0,c.jsx)(ok,{className:"h-4 w-4 text-gray-600"})}),(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors",title:"An Fenster anpassen",children:(0,c.jsx)(oM,{className:"h-4 w-4 text-gray-600"})})]}),(0,c.jsxs)("div",{className:"flex items-center border rounded-lg",children:[(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors border-r",title:"Flow importieren",children:(0,c.jsx)(oA,{className:"h-4 w-4 text-gray-600"})}),(0,c.jsx)("button",{className:"p-2 hover:bg-gray-50 transition-colors",title:"Flow exportieren",children:(0,c.jsx)(oC.Download,{className:"h-4 w-4 text-gray-600"})})]})]})]}),n&&(0,c.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[(0,c.jsx)("div",{className:"grid grid-cols-5 gap-3",children:oz.map(e=>{let n=e.icon;return(0,c.jsxs)("div",{draggable:!0,onDragStart:t=>a(t,e.type),onClick:()=>t(e.type),className:"flex flex-col items-center space-y-2 p-3 border rounded-lg cursor-pointer transition-colors ".concat(e.color),children:[(0,c.jsx)(n,{className:"h-6 w-6"}),(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,c.jsx)("p",{className:"text-xs opacity-75",children:e.description})]})]},e.type)})}),(0,c.jsx)("button",{onClick:()=>r(!1),className:"mt-3 text-sm text-gray-500 hover:text-gray-700",children:"Weniger anzeigen"})]})]}),(0,c.jsx)("div",{className:"px-6 py-2 bg-blue-50 border-t border-blue-100",children:(0,c.jsxs)("p",{className:"text-sm text-blue-700",children:[" ",(0,c.jsx)("strong",{children:"Tipp:"})," Ziehen Sie Bausteine auf die Leinwand oder klicken Sie, um sie hinzuzufgen. Verbinden Sie Nodes mit den Griffen an den Seiten."]})})]})}var oI=e.i(88978);let oR=(0,ou.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var oP=e.i(46704),oT=e.i(35388);function oD(e){var t;let{selectedNodeId:n,nodes:r,onNodeUpdate:a,onClose:o}=e,[i,l]=(0,u.useState)({}),s=n?r.find(e=>e.id===n):null;if((0,u.useEffect)(()=>{s?l(s.data||{}):l({})},[s]),!s)return(0,c.jsxs)("div",{className:"w-80 bg-white border-l border-gray-200 p-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Eigenschaften"}),(0,c.jsx)(oI.Button,{variant:"outline",size:"sm",onClick:o,children:(0,c.jsx)(oR,{className:"h-4 w-4"})})]}),(0,c.jsxs)("div",{className:"text-center text-gray-500 py-12",children:[(0,c.jsx)(oP.Settings,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,c.jsx)("p",{className:"text-sm",children:"Whlen Sie einen Node aus, um seine Eigenschaften zu bearbeiten."})]})]});let d=(t=s.type,({start:oi.Play,message:os.MessageSquare,condition:od,"collect-input":of,handoff:og,end:oy})[t]||oP.Settings);return(0,c.jsxs)("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col h-full",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(d,{className:"h-5 w-5 text-blue-600"}),(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:{start:"Start Node",message:"Nachricht Node",condition:"Bedingung Node","collect-input":"Eingabe Node",handoff:"Weiterleitung Node",end:"Ende Node"}[s.type]||"Node"})]}),(0,c.jsx)(oI.Button,{variant:"outline",size:"sm",onClick:o,children:(0,c.jsx)(oR,{className:"h-4 w-4"})})]}),(0,c.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Allgemein"}),(0,c.jsx)("div",{className:"space-y-3",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node ID"}),(0,c.jsx)("input",{type:"text",value:s.id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-sm"})]})})]}),"message"===s.type&&(0,c.jsx)(oO,{formData:i,setFormData:l}),"condition"===s.type&&(0,c.jsx)(oL,{formData:i,setFormData:l}),"collect-input"===s.type&&(0,c.jsx)(oV,{formData:i,setFormData:l}),"handoff"===s.type&&(0,c.jsx)(oH,{formData:i,setFormData:l}),"end"===s.type&&(0,c.jsx)(oF,{formData:i,setFormData:l})]}),(0,c.jsx)("div",{className:"border-t border-gray-200 p-4",children:(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)(oI.Button,{onClick:()=>{s&&a(s.id,{data:{...s.data,...i}})},className:"flex-1",children:"nderungen speichern"}),(0,c.jsx)(oI.Button,{variant:"outline",size:"sm",children:(0,c.jsx)(oT.Trash2,{className:"h-4 w-4"})})]})})]})}function oO(e){let{formData:t,setFormData:n}=e,[r,a]=(0,u.useState)(t.quickReplies||[]);return(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Nachricht"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nachrichtentext *"}),(0,c.jsx)("textarea",{value:t.message||"",onChange:e=>n({...t,message:e.target.value}),placeholder:"Ihre Nachricht an den Benutzer...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Schnellantworten (optional)"}),(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:()=>{let e=[...r,""];a(e),n({...t,quickReplies:e})},children:[(0,c.jsx)(oS.Plus,{className:"h-3 w-3 mr-1"}),"Hinzufgen"]})]}),(0,c.jsx)("div",{className:"space-y-2",children:r.map((e,o)=>(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("input",{type:"text",value:e,onChange:e=>((e,o)=>{let i=[...r];i[e]=o,a(i),n({...t,quickReplies:i})})(o,e.target.value),placeholder:"Schnellantwort...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,c.jsx)(oI.Button,{size:"sm",variant:"outline",onClick:()=>(e=>{let o=r.filter((t,n)=>n!==e);a(o),n({...t,quickReplies:o})})(o),children:(0,c.jsx)(oR,{className:"h-3 w-3"})})]},o))})]})]})]})}function oL(e){let{formData:t,setFormData:n}=e,[r,a]=(0,u.useState)(t.conditions||[]);return(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Bedingungen"}),(0,c.jsx)("div",{className:"space-y-4",children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Wenn Benutzer schreibt..."}),(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:()=>{let e=[...r,{keyword:"",target:null}];a(e),n({...t,conditions:e})},children:[(0,c.jsx)(oS.Plus,{className:"h-3 w-3 mr-1"}),"Bedingung"]})]}),(0,c.jsx)("div",{className:"space-y-3",children:r.map((e,o)=>(0,c.jsx)("div",{className:"p-3 border border-gray-200 rounded-lg",children:(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Schlsselwort"}),(0,c.jsx)("input",{type:"text",value:e.keyword,onChange:e=>((e,o,i)=>{let l=[...r];l[e]={...l[e],[o]:i},a(l),n({...t,conditions:l})})(o,"keyword",e.target.value),placeholder:"z.B. ja, nein, hilfe...",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded"})]}),(0,c.jsx)("div",{className:"flex justify-end",children:(0,c.jsx)(oI.Button,{size:"sm",variant:"outline",onClick:()=>(e=>{let o=r.filter((t,n)=>n!==e);a(o),n({...t,conditions:o})})(o),children:(0,c.jsx)(oT.Trash2,{className:"h-3 w-3"})})})]})},o))})]})})]})}function oV(e){let{formData:t,setFormData:n}=e,[r,a]=(0,u.useState)(t.choices||[]);return(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Eingabe sammeln"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eingabeaufforderung *"}),(0,c.jsx)("textarea",{value:t.prompt||"",onChange:e=>n({...t,prompt:e.target.value}),placeholder:"Bitte geben Sie...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Variable Name *"}),(0,c.jsx)("input",{type:"text",value:t.variable||"",onChange:e=>n({...t,variable:e.target.value}),placeholder:"z.B. user_name, email, phone...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Eingabetyp"}),(0,c.jsxs)("select",{value:t.inputType||"text",onChange:e=>n({...t,inputType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,c.jsx)("option",{value:"text",children:"Text"}),(0,c.jsx)("option",{value:"email",children:"E-Mail"}),(0,c.jsx)("option",{value:"phone",children:"Telefon"}),(0,c.jsx)("option",{value:"number",children:"Zahl"}),(0,c.jsx)("option",{value:"choice",children:"Auswahl"})]})]}),"choice"===t.inputType&&(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,c.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Auswahlmglichkeiten"}),(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:()=>{let e=[...r,""];a(e),n({...t,choices:e})},children:[(0,c.jsx)(oS.Plus,{className:"h-3 w-3 mr-1"}),"Option"]})]}),(0,c.jsx)("div",{className:"space-y-2",children:r.map((e,o)=>(0,c.jsx)("input",{type:"text",value:e,onChange:e=>{let i=[...r];i[o]=e.target.value,a(i),n({...t,choices:i})},placeholder:"Option...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"},o))})]})]})]})}function oH(e){let{formData:t,setFormData:n}=e;return(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Weiterleitung"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nachricht an Benutzer"}),(0,c.jsx)("textarea",{value:t.message||"",onChange:e=>n({...t,message:e.target.value}),placeholder:"Ich verbinde Sie mit einem Mitarbeiter...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abteilung"}),(0,c.jsxs)("select",{value:t.department||"general",onChange:e=>n({...t,department:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,c.jsx)("option",{value:"general",children:"Allgemein"}),(0,c.jsx)("option",{value:"customer-service",children:"Kundenservice"}),(0,c.jsx)("option",{value:"technical",children:"Technischer Support"}),(0,c.jsx)("option",{value:"sales",children:"Vertrieb"}),(0,c.jsx)("option",{value:"billing",children:"Rechnungswesen"})]})]})]})]})}function oF(e){let{formData:t,setFormData:n}=e;return(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Konversation beenden"}),(0,c.jsx)("div",{className:"space-y-4",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Abschlussnachricht (optional)"}),(0,c.jsx)("textarea",{value:t.message||"",onChange:e=>n({...t,message:e.target.value}),placeholder:"Vielen Dank fr Ihr Gesprch...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})})]})}let oq=(0,ou.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),oX=(0,ou.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var oK=e.i(99376),oW=e.i(50666),oY=e.i(74518);let oZ=(0,ou.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),oU=(0,ou.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function oG(e){let{nodes:t,edges:n,isOpen:r,onClose:a}=e,[o,i]=(0,u.useState)([]),[l,s]=(0,u.useState)(""),[d,h]=(0,u.useState)(!1),[f,m]=(0,u.useState)(null),[g,p]=(0,u.useState)({}),[y,x]=(0,u.useState)({messagesExchanged:0,flowsTriggered:0,errorsEncountered:0,testDuration:0}),v=(0,u.useRef)(null),b=(0,u.useRef)(null);(0,u.useEffect)(()=>{var e;null==(e=v.current)||e.scrollIntoView({behavior:"smooth"})},[o]);let w=()=>{if(h(!1),m(null),b.current){let e=Math.round((Date.now()-b.current.getTime())/1e3);x(t=>({...t,testDuration:e}))}S("Bot-Test beendet")},N=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"delivered",a={id:"msg_".concat(Date.now()),type:e,content:t,timestamp:new Date,nodeId:n,status:r};i(e=>[...e,a]),"system"!==e&&x(e=>({...e,messagesExchanged:e.messagesExchanged+1})),"error"===r&&x(e=>({...e,errorsEncountered:e.errorsEncountered+1}))},S=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],N("system",e)},E=()=>{l.trim()&&d&&(N("user",l),_(l),s(""))},_=e=>{if(!f)return;let n=t.find(e=>e.id===f);if(n)switch(n.type){case"condition":j(e,n);break;case"collect-input":k(e,n);break;default:R(n)}},j=(e,r)=>{let{conditions:a=[]}=r.data||{},o=e.toLowerCase().trim(),i=a.find(e=>{var t;return o.includes(null==(t=e.keyword)?void 0:t.toLowerCase())});if(i){S('Bedingung erfllt: "'.concat(i.keyword,'"'));let e=n.find(e=>{var t;return e.source===r.id&&(null==(t=e.data)?void 0:t.condition)===i.keyword});if(e){let n=t.find(t=>t.id===e.target);n&&(m(n.id),M(n))}}else{let e=n.find(e=>e.source===r.id&&"default"===e.sourceHandle);if(e){let n=t.find(t=>t.id===e.target);n&&(S("Keine Bedingung erfllt, verwende Standard-Pfad"),m(n.id),M(n))}else S("Eingabe nicht verstanden und kein Standard-Pfad definiert","error")}},k=(e,t)=>{let{variable:n,inputType:r,choices:a=[]}=t.data||{},o=!0,i=e;switch(r){case"email":o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);break;case"phone":o=/^[\+]?[1-9][\d]{0,15}$/.test(e.replace(/\s/g,""));break;case"number":o=!isNaN(Number(e)),i=Number(e).toString();break;case"choice":o=a.some(t=>t.toLowerCase()===e.toLowerCase())}o?(p(e=>({...e,[n]:i})),S('Variable "'.concat(n,'" gesetzt: ').concat(i)),R(t)):N("bot","Ungltige Eingabe fr ".concat(r,". Bitte versuchen Sie es erneut."),t.id,"error")},M=e=>{switch(x(e=>({...e,flowsTriggered:e.flowsTriggered+1})),e.type){case"message":C(e);break;case"condition":A(e);break;case"collect-input":z(e);break;case"handoff":B(e);break;case"end":I(e)}},C=e=>{let{message:t,quickReplies:n=[]}=e.data||{};N("bot",P(t||"",g),e.id),setTimeout(()=>{R(e)},500)},A=e=>{S("Warte auf Benutzereingabe fr Bedingung...")},z=e=>{var t;let{prompt:n,inputType:r,choices:a=[]}=e.data||{},o=P(n||"",g);"choice"===r&&a.length>0&&(o+="\n\nOptionen:\n"+a.map((e,t)=>"".concat(t+1,". ").concat(e)).join("\n")),N("bot",o,e.id),S("Sammle ".concat(r,'-Eingabe fr Variable "').concat(null==(t=e.data)?void 0:t.variable,'"'))},B=e=>{let{message:t,department:n}=e.data||{};N("bot",P(t||"Ich verbinde Sie mit einem Mitarbeiter...",g),e.id),S("Weiterleitung an Abteilung: ".concat(n||"Allgemein")),w()},I=e=>{let{message:t}=e.data||{};t&&N("bot",P(t,g),e.id),S("Bot-Flow beendet"),w()},R=e=>{let r=n.find(t=>t.source===e.id);if(r){let e=t.find(e=>e.id===r.target);e&&(m(e.id),setTimeout(()=>M(e),300))}else S("Kein nchster Node gefunden - Flow beendet","error"),w()},P=(e,t)=>e.replace(/\{\{(\w+)\}\}/g,(e,n)=>void 0!==t[n]?String(t[n]):e);return r?(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl h-5/6 flex flex-col",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,c.jsx)(oK.Bot,{className:"h-6 w-6 text-blue-600"}),(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Bot Test Interface"}),f&&(0,c.jsxs)("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded",children:["Aktueller Node: ",f]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:()=>{i([]),p({}),h(!0),m(null),b.current=new Date;let e=t.find(e=>"start"===e.type);e?(m(e.id),S("Bot-Test gestartet"),M(e)):S("Fehler: Kein Start-Node gefunden","error")},disabled:d,children:[(0,c.jsx)(oi.Play,{className:"h-4 w-4 mr-2"}),"Start"]}),(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:w,disabled:!d,children:[(0,c.jsx)(oy,{className:"h-4 w-4 mr-2"}),"Stop"]}),(0,c.jsxs)(oI.Button,{size:"sm",variant:"outline",onClick:()=>{i([]),p({}),h(!1),m(null),x({messagesExchanged:0,flowsTriggered:0,errorsEncountered:0,testDuration:0}),b.current=null},children:[(0,c.jsx)(oq,{className:"h-4 w-4 mr-2"}),"Reset"]}),(0,c.jsx)(oI.Button,{size:"sm",variant:"outline",onClick:a,children:"Schlieen"})]})]}),(0,c.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,c.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,c.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.map(e=>(0,c.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,c.jsx)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg ".concat("user"===e.type?"bg-blue-600 text-white":"bot"===e.type?"bg-gray-100 text-gray-900":"bg-yellow-50 text-yellow-800 text-sm"),children:(0,c.jsxs)("div",{className:"flex items-start space-x-2",children:["user"===e.type?(0,c.jsx)(oW.User,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}):"bot"===e.type?(0,c.jsx)(oK.Bot,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}):(0,c.jsx)(oU,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("p",{className:"whitespace-pre-wrap",children:e.content}),(0,c.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,c.jsx)("span",{className:"text-xs opacity-75",children:e.timestamp.toLocaleTimeString()}),e.status&&"system"!==e.type&&(0,c.jsxs)("div",{className:"flex items-center space-x-1",children:["delivered"===e.status&&(0,c.jsx)(oY.CheckCircle,{className:"h-3 w-3 text-green-500"}),"error"===e.status&&(0,c.jsx)(oZ,{className:"h-3 w-3 text-red-500"})]})]})]})]})})},e.id)),(0,c.jsx)("div",{ref:v})]}),(0,c.jsx)("div",{className:"border-t border-gray-200 p-4",children:(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)("input",{type:"text",value:l,onChange:e=>s(e.target.value),onKeyPress:e=>"Enter"===e.key&&E(),placeholder:d?"Ihre Nachricht...":"Test starten um zu chatten",disabled:!d,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"}),(0,c.jsx)(oI.Button,{onClick:E,disabled:!d||!l.trim(),children:(0,c.jsx)(oX,{className:"h-4 w-4"})})]})})]}),(0,c.jsxs)("div",{className:"w-80 border-l border-gray-200 p-4 space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Test Statistiken"}),(0,c.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Nachrichten:"}),(0,c.jsx)("span",{className:"font-medium",children:y.messagesExchanged})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Flows ausgefhrt:"}),(0,c.jsx)("span",{className:"font-medium",children:y.flowsTriggered})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Fehler:"}),(0,c.jsx)("span",{className:"font-medium text-red-600",children:y.errorsEncountered})]}),(0,c.jsxs)("div",{className:"flex justify-between",children:[(0,c.jsx)("span",{className:"text-gray-600",children:"Dauer:"}),(0,c.jsxs)("span",{className:"font-medium",children:[y.testDuration,"s"]})]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Variablen"}),Object.keys(g).length>0?(0,c.jsx)("div",{className:"space-y-2",children:Object.entries(g).map(e=>{let[t,n]=e;return(0,c.jsxs)("div",{className:"bg-gray-50 p-2 rounded text-sm",children:[(0,c.jsx)("div",{className:"font-medium text-gray-700",children:t}),(0,c.jsx)("div",{className:"text-gray-600 truncate",children:String(n)})]},t)})}):(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Keine Variablen gesetzt"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Flow Status"}),(0,c.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[d?(0,c.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}):(0,c.jsx)("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),(0,c.jsx)("span",{className:d?"text-green-700":"text-gray-500",children:d?"Luft":"Gestoppt"})]}),f&&(0,c.jsxs)("div",{className:"text-xs text-gray-600",children:["Aktueller Node: ",f]})]})]})]})]})]})}):null}function o$(e,t){let n=[],r=[],a=function(e,t){let n=[],r=[],a=e.filter(e=>"start"===e.type);0===a.length?n.push({id:"no-start-node",type:"error",message:"Flow muss mindestens einen Start-Node haben",severity:"critical"}):a.length>1&&r.push({id:"multiple-start-nodes",type:"warning",message:"".concat(a.length," Start-Nodes gefunden. Nur der erste wird verwendet."),suggestion:"Verwenden Sie nur einen Start-Node pro Flow"}),0===e.length&&n.push({id:"empty-flow",type:"error",message:"Flow ist leer",severity:"critical"});let o=new Set([...t.map(e=>e.source),...t.map(e=>e.target)]);return e.filter(e=>"start"!==e.type&&!o.has(e.id)).forEach(e=>{var t;r.push({id:"isolated-node-".concat(e.id),type:"warning",nodeId:e.id,message:'Node "'.concat((null==(t=e.data)?void 0:t.label)||e.id,'" ist nicht verbunden'),suggestion:"Verbinden Sie den Node mit dem Flow oder entfernen Sie ihn"})}),{isValid:0===n.length,errors:n,warnings:r}}(e,t);n.push(...a.errors),r.push(...a.warnings);let o=function(e){let t=[],n=[];return e.forEach(e=>{let r=function(e){switch(e.type){case"message":var t=e;let n=[],r=[],{message:a,quickReplies:o=[]}=t.data||{};if(a&&""!==a.trim()){a.length>4096&&n.push({id:"message-too-long-".concat(t.id),type:"error",nodeId:t.id,message:"Nachricht zu lang (max. 4096 Zeichen)",severity:"medium"});let e=a.match(/\{\{(\w+)\}\}/g);e&&r.push({id:"message-variables-".concat(t.id),type:"warning",nodeId:t.id,message:"Variablen gefunden: ".concat(e.join(", ")),suggestion:"Stellen Sie sicher, dass diese Variablen definiert werden"})}else n.push({id:"message-empty-".concat(t.id),type:"error",nodeId:t.id,message:"Nachrichtentext ist erforderlich",severity:"high"});return o.length>13&&r.push({id:"too-many-quick-replies-".concat(t.id),type:"warning",nodeId:t.id,message:"Mehr als 13 Schnellantworten (WhatsApp Limit)",suggestion:"Reduzieren Sie auf maximal 13 Schnellantworten"}),o.forEach((e,n)=>{e.length>20&&r.push({id:"quick-reply-too-long-".concat(t.id,"-").concat(n),type:"warning",nodeId:t.id,message:'Schnellantwort "'.concat(e,'" zu lang (max. 20 Zeichen)'),suggestion:"Krzen Sie die Schnellantwort"})}),{isValid:0===n.length,errors:n,warnings:r};case"condition":return function(e){let t=[],n=[],{conditions:r=[]}=e.data||{};0===r.length&&t.push({id:"condition-no-conditions-".concat(e.id),type:"error",nodeId:e.id,message:"Mindestens eine Bedingung erforderlich",severity:"high"}),r.forEach((n,r)=>{n.keyword&&""!==n.keyword.trim()||t.push({id:"condition-empty-keyword-".concat(e.id,"-").concat(r),type:"error",nodeId:e.id,message:"Bedingung ".concat(r+1,": Schlsselwort ist erforderlich"),severity:"medium"})});let a=r.map(e=>{var t;return null==(t=e.keyword)?void 0:t.toLowerCase()}).filter(Boolean),o=a.filter((e,t)=>a.indexOf(e)!==t);return o.length>0&&n.push({id:"condition-duplicate-keywords-".concat(e.id),type:"warning",nodeId:e.id,message:"Doppelte Schlsselwrter: ".concat([...new Set(o)].join(", ")),suggestion:"Verwenden Sie eindeutige Schlsselwrter"}),{isValid:0===t.length,errors:t,warnings:n}}(e);case"collect-input":var i=e;let l=[],s=[],{prompt:c,variable:u,inputType:d,choices:h=[]}=i.data||{};return c&&""!==c.trim()||l.push({id:"input-no-prompt-".concat(i.id),type:"error",nodeId:i.id,message:"Eingabeaufforderung ist erforderlich",severity:"high"}),u&&""!==u.trim()?/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(u)||l.push({id:"input-invalid-variable-".concat(i.id),type:"error",nodeId:i.id,message:"Ungltiger Variablenname (nur Buchstaben, Zahlen und _)",severity:"medium"}):l.push({id:"input-no-variable-".concat(i.id),type:"error",nodeId:i.id,message:"Variablenname ist erforderlich",severity:"high"}),"choice"===d&&(0===h.length?l.push({id:"input-no-choices-".concat(i.id),type:"error",nodeId:i.id,message:"Auswahlmglichkeiten sind fr Auswahltyp erforderlich",severity:"high"}):h.length>10&&s.push({id:"input-too-many-choices-".concat(i.id),type:"warning",nodeId:i.id,message:"Mehr als 10 Auswahlmglichkeiten knnen unbersichtlich sein",suggestion:"Reduzieren Sie auf maximal 10 Optionen"})),{isValid:0===l.length,errors:l,warnings:s};case"handoff":var f=e;let m=[],g=[],{message:p,department:y}=f.data||{};return p&&p.length>1e3&&g.push({id:"handoff-long-message-".concat(f.id),type:"warning",nodeId:f.id,message:"Sehr lange Weiterleitung-Nachricht",suggestion:"Halten Sie die Nachricht kurz und prgnant"}),{isValid:0===m.length,errors:m,warnings:g};default:return{isValid:!0,errors:[],warnings:[]}}}(e);t.push(...r.errors),n.push(...r.warnings)}),{isValid:0===t.length,errors:t,warnings:n}}(e);n.push(...o.errors),r.push(...o.warnings);let i=function(e,t){let n=[],r=[];(function(e,t){let n=[],r=new Set,a=new Set,o=new Map;return e.forEach(e=>o.set(e.id,[])),t.forEach(e=>{let t=o.get(e.source)||[];t.push(e.target),o.set(e.source,t)}),e.filter(e=>"start"===e.type).forEach(e=>{r.has(e.id)||function e(t,i){for(let l of(r.add(t),a.add(t),i.push(t),o.get(t)||[]))if(r.has(l)){if(a.has(l)){let e=i.indexOf(l);n.push(i.slice(e))}}else e(l,i);a.delete(t),i.pop()}(e.id,[])}),n})(e,t).forEach(e=>{r.push({id:"cycle-detected-".concat(e.join("-")),type:"warning",message:"Mgliche Endlosschleife erkannt: ".concat(e.join("  ")),suggestion:"Fgen Sie eine Ausstiegsbedingung hinzu"})});let a=function(e,t){let n=new Set,r=e.filter(e=>"start"===e.type),a=new Map;return e.forEach(e=>a.set(e.id,[])),t.forEach(e=>{let t=a.get(e.source)||[];t.push(e.target),a.set(e.source,t)}),r.forEach(e=>(function e(t){n.has(t)||(n.add(t),(a.get(t)||[]).forEach(t=>e(t)))})(e.id)),n}(e,t);return e.filter(e=>"start"!==e.type&&!a.has(e.id)).forEach(e=>{var t;r.push({id:"unreachable-node-".concat(e.id),type:"warning",nodeId:e.id,message:'Node "'.concat((null==(t=e.data)?void 0:t.label)||e.id,'" ist nicht erreichbar'),suggestion:"Verbinden Sie den Node mit dem Hauptflow"})}),{isValid:0===n.length,errors:n,warnings:r}}(e,t);n.push(...i.errors),r.push(...i.warnings);let l=function(e,t){let n=[],r=[];return e.filter(e=>!t.some(t=>t.source===e.id)&&"end"!==e.type&&"handoff"!==e.type).forEach(e=>{var t;r.push({id:"no-outgoing-".concat(e.id),type:"warning",nodeId:e.id,message:'Node "'.concat((null==(t=e.data)?void 0:t.label)||e.id,'" hat keine Ausgangsverbindung'),suggestion:"Fgen Sie eine Verbindung hinzu oder beenden Sie mit einem End-Node"})}),{isValid:0===n.length,errors:n,warnings:r}}(e,t);return n.push(...l.errors),r.push(...l.warnings),{isValid:0===n.length,errors:n,warnings:r}}var oQ=e.i(78153),oJ=e.i(80606);let o0=(0,ou.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),o1=(0,ou.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),o2=(0,ou.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function o3(){let e=(0,d.useParams)(),t=(0,d.useSearchParams)(),n=(0,d.useRouter)(),r=e.id,a=t.get("template"),{bot:o,loading:i,saveFlow:l}=(0,oQ.useBot)(r),[s,h]=(0,u.useState)(""),[f,m]=(0,u.useState)([]),[g,p]=(0,u.useState)([]),[y,x]=(0,u.useState)(!1),[v,b]=(0,u.useState)(!0),[w,N]=(0,u.useState)(null),[S,E]=(0,u.useState)(!1),[_,j]=(0,u.useState)(null),[k,M]=(0,u.useState)(!1);(0,u.useEffect)(()=>{if(o){if(h(o.name),o.flows&&o.flows.length>0){let e=o.flows[0];m(e.nodes.nodes||[]),p(e.nodes.edges||[])}}else a&&"blank"!==a&&C()},[o,a]);let C=()=>{let e=A(a);m(e.nodes),p(e.edges),h(e.name)};(0,u.useEffect)(()=>{f.length>0&&j(o$(f,g))},[f,g]);let A=e=>({"customer-support":{name:"Kundenservice Bot",nodes:[{id:"start",type:"start",position:{x:100,y:100},data:{label:"Start"}},{id:"welcome",type:"message",position:{x:300,y:100},data:{message:"Hallo! Ich bin Ihr Kundenservice-Assistent. Wie kann ich Ihnen helfen?",quickReplies:["Bestellung verfolgen","Rckgabe","Technischer Support","Mit Mensch sprechen"]}},{id:"menu",type:"condition",position:{x:550,y:100},data:{conditions:[{keyword:"bestellung",target:"track-order"},{keyword:"rckgabe",target:"return-info"},{keyword:"support",target:"tech-support"},{keyword:"mensch",target:"human-handoff"}]}},{id:"track-order",type:"message",position:{x:300,y:300},data:{message:"Gerne helfe ich Ihnen bei der Sendungsverfolgung. Bitte geben Sie Ihre Bestellnummer ein."}},{id:"return-info",type:"message",position:{x:500,y:300},data:{message:"Fr Rckgaben haben Sie 14 Tage Zeit. Weitere Informationen finden Sie hier: [Link zu Rckgaberichtlinien]"}},{id:"tech-support",type:"message",position:{x:700,y:300},data:{message:"Ich verbinde Sie mit unserem technischen Support. Bitte beschreiben Sie kurz Ihr Problem."}},{id:"human-handoff",type:"handoff",position:{x:900,y:300},data:{message:"Ich verbinde Sie mit einem unserer Mitarbeiter. Bitte haben Sie einen Moment Geduld.",department:"customer-service"}}],edges:[{id:"e1",source:"start",target:"welcome"},{id:"e2",source:"welcome",target:"menu"},{id:"e3",source:"menu",target:"track-order",data:{condition:"bestellung"}},{id:"e4",source:"menu",target:"return-info",data:{condition:"rckgabe"}},{id:"e5",source:"menu",target:"tech-support",data:{condition:"support"}},{id:"e6",source:"menu",target:"human-handoff",data:{condition:"mensch"}}]},"lead-generation":{name:"Lead Generation Bot",nodes:[{id:"start",type:"start",position:{x:100,y:100},data:{label:"Start"}},{id:"intro",type:"message",position:{x:300,y:100},data:{message:" Willkommen! Ich helfe Ihnen gerne bei der Auswahl unserer Services. Darf ich fragen, was Sie interessiert?"}},{id:"interest",type:"collect-input",position:{x:550,y:100},data:{prompt:"Wofr interessieren Sie sich?",variable:"interest",inputType:"text"}},{id:"qualify",type:"message",position:{x:300,y:300},data:{message:"Perfekt! {{interest}} ist ein wichtiger Bereich. Sind Sie bereits Geschftsinhaber oder planen Sie zu starten?"}},{id:"business-status",type:"collect-input",position:{x:550,y:300},data:{prompt:"Ihr Geschftsstatus:",variable:"business_status",inputType:"choice",choices:["Bereits im Geschft","Planung/Start","Nur interessiert"]}},{id:"contact-info",type:"collect-input",position:{x:800,y:300},data:{prompt:"Darf ich Ihre E-Mail fr weitere Informationen?",variable:"email",inputType:"email"}},{id:"thank-you",type:"message",position:{x:1050,y:300},data:{message:"Vielen Dank! Ich sende Ihnen passende Informationen zu {{interest}}. Ein Berater wird sich in 24h bei Ihnen melden."}}],edges:[{id:"e1",source:"start",target:"intro"},{id:"e2",source:"intro",target:"interest"},{id:"e3",source:"interest",target:"qualify"},{id:"e4",source:"qualify",target:"business-status"},{id:"e5",source:"business-status",target:"contact-info"},{id:"e6",source:"contact-info",target:"thank-you"}]}})[e]||{name:"Bot",nodes:[],edges:[]},z=async()=>{try{x(!0),await l(f,g),alert("Bot wurde erfolgreich gespeichert!")}catch(e){console.error("Failed to save bot:",e),alert("Fehler beim Speichern des Bots: "+(e instanceof Error?e.message:"Unbekannter Fehler"))}finally{x(!1)}};return i?(0,c.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,c.jsx)("p",{className:"text-gray-600",children:"Lade Bot..."})]})}):(0,c.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 bg-white px-6 py-4",children:[(0,c.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,c.jsxs)(oI.Button,{variant:"outline",size:"sm",onClick:()=>n.push("/dashboard/bots"),children:[(0,c.jsx)(oJ.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Zurck"]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("input",{type:"text",value:s,onChange:e=>h(e.target.value),className:"text-xl font-bold bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Bot Flow Editor"})]})]}),(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[_&&(0,c.jsxs)(oI.Button,{variant:"outline",size:"sm",onClick:()=>{M(!k)},className:"".concat(_.isValid?"text-green-700 border-green-300 hover:bg-green-50":"text-red-700 border-red-300 hover:bg-red-50"),children:[_.isValid?(0,c.jsx)(oY.CheckCircle,{className:"h-4 w-4 mr-2"}):(0,c.jsx)(oZ,{className:"h-4 w-4 mr-2"}),_.errors.length>0?"".concat(_.errors.length," Fehler"):"Validiert",_.warnings.length>0&&", ".concat(_.warnings.length," Warnungen")]}),(0,c.jsxs)(oI.Button,{variant:"outline",size:"sm",onClick:()=>{window.open("/preview/bot/".concat(r),"_blank")},children:[(0,c.jsx)(o1,{className:"h-4 w-4 mr-2"}),"Vorschau"]}),(0,c.jsxs)(oI.Button,{variant:"outline",size:"sm",onClick:()=>{let e=function(e,t){let n=o$(e,t);return{isValid:n.isValid,errorCount:n.errors.length,warningCount:n.warnings.length}}(f,g);if(!e.isValid){alert("Bot kann nicht getestet werden: ".concat(e.errorCount," Fehler gefunden. Bitte beheben Sie die Fehler zuerst.")),M(!0);return}E(!0)},children:[(0,c.jsx)(oi.Play,{className:"h-4 w-4 mr-2"}),"Testen"]}),(0,c.jsxs)(oI.Button,{size:"sm",onClick:z,disabled:y,className:"bg-blue-600 hover:bg-blue-700",children:[(0,c.jsx)(o0,{className:"h-4 w-4 mr-2"}),y?"Speichern...":"Speichern"]}),(0,c.jsx)(oI.Button,{variant:"outline",size:"sm",onClick:()=>b(!v),children:(0,c.jsx)(oP.Settings,{className:"h-4 w-4"})})]})]}),(0,c.jsx)(oB,{onAddNode:e=>{let t={id:"".concat(e,"_").concat(Date.now()),type:e,position:{x:300+200*Math.random(),y:200+200*Math.random()},data:(e=>{switch(e){case"start":return{label:"Start"};case"message":return{message:"Neue Nachricht eingeben...",quickReplies:[]};case"condition":return{conditions:[{keyword:"ja",target:null},{keyword:"nein",target:null}]};case"collect-input":return{prompt:"Bitte geben Sie eine Antwort ein:",variable:"user_input",inputType:"text"};case"handoff":return{message:"Ich verbinde Sie mit einem Mitarbeiter...",department:"general"};case"end":return{label:"Ende"};default:return{}}})(e)};m(e=>[...e,t])}}),(0,c.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,c.jsx)("div",{className:"flex-1",children:(0,c.jsx)(ow,{nodes:f,edges:g,onNodesChange:m,onEdgesChange:p,onNodeSelect:N})}),v&&(0,c.jsx)(oD,{selectedNodeId:w,nodes:f,onNodeUpdate:(e,t)=>{m(n=>n.map(n=>n.id===e?{...n,...t}:n))},onClose:()=>b(!1)})]}),k&&_&&(0,c.jsxs)("div",{className:"fixed bottom-4 right-4 w-96 bg-white border border-gray-200 rounded-lg shadow-lg p-4 max-h-96 overflow-y-auto z-40",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Flow Validation"}),(0,c.jsx)(oI.Button,{size:"sm",variant:"outline",onClick:()=>M(!1),children:""})]}),_.errors.length>0&&(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsxs)("h4",{className:"text-sm font-medium text-red-700 mb-2 flex items-center",children:[(0,c.jsx)(oZ,{className:"h-4 w-4 mr-1"}),"Fehler (",_.errors.length,")"]}),(0,c.jsx)("div",{className:"space-y-2",children:_.errors.map(e=>(0,c.jsxs)("div",{className:"p-2 bg-red-50 border border-red-200 rounded text-sm",children:[(0,c.jsx)("p",{className:"text-red-800",children:e.message}),e.nodeId&&(0,c.jsxs)("p",{className:"text-red-600 text-xs mt-1",children:["Node: ",e.nodeId]})]},e.id))})]}),_.warnings.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsxs)("h4",{className:"text-sm font-medium text-yellow-700 mb-2 flex items-center",children:[(0,c.jsx)(o2,{className:"h-4 w-4 mr-1"}),"Warnungen (",_.warnings.length,")"]}),(0,c.jsx)("div",{className:"space-y-2",children:_.warnings.map(e=>(0,c.jsxs)("div",{className:"p-2 bg-yellow-50 border border-yellow-200 rounded text-sm",children:[(0,c.jsx)("p",{className:"text-yellow-800",children:e.message}),e.suggestion&&(0,c.jsxs)("p",{className:"text-yellow-600 text-xs mt-1",children:[" ",e.suggestion]}),e.nodeId&&(0,c.jsxs)("p",{className:"text-yellow-600 text-xs mt-1",children:["Node: ",e.nodeId]})]},e.id))})]}),_.isValid&&0===_.warnings.length&&(0,c.jsxs)("div",{className:"flex items-center text-green-700",children:[(0,c.jsx)(oY.CheckCircle,{className:"h-5 w-5 mr-2"}),(0,c.jsx)("span",{children:"Flow ist vollstndig validiert!"})]})]}),(0,c.jsx)(oG,{nodes:f,edges:g,isOpen:S,onClose:()=>E(!1)})]})}}]);